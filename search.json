[{"path":"https://rstudio.github.io/shinytest2/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 shinytest2 authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (â€œSoftwareâ€), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED â€œâ€, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"customizing-test-scripts","dir":"Articles","previous_headings":"","what":"Customizing test scripts","title":"Testing in depth","text":"test recorder easiest way create test scripts, way. can create edit test scripts manually. final product look something like: test script basic structure: first, initialization, expectations performed. initialization, script creates new AppDriver object. Next, define interactions application makes expectations via snapshots. customizing script, second portion â€“ interactions expectations â€“ part want modify.","code":"# File: ./tests/testthat/test-shinytest2.R test_that(\"App initialization is consistent\", {   app <- AppDriver$new()    app$expect_values() }) app <- AppDriver$new() app$set_inputs(check_group = c(\"1\", \"2\")) app$set_inputs(check_group = c(\"1\", \"2\", \"3\")) app$click(\"action\") app$expect_values()  app$click(\"action\") app$expect_values()"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"setting-inputs-with-appset_inputs-and-appclick","dir":"Articles","previous_headings":"Customizing test scripts","what":"Setting inputs with app$set_inputs() and app$click()","title":"Testing in depth","text":"app$set_inputs(), provide name one inputs corresponding values set . Consider set directives: Notice set value check_group two times row. recorded test script, started value \"1\", checked \"2\" \"3\" boxes. recorded script set value c(\"1\", \"2\"), c(\"1\", \"2\", \"3\"). c(\"1\", \"2\") value simply intermediate step. possible simplify speed tests dropping intermediate step, leaves us : Multiple calls app$set_inputs() reduced single line unless side effects setting inputs multiple times desired. app$set_inputs() called, normally returns control moves next step server sends response client. reason waits response subsequent call app$snapshot() sure capture updated output values. app$set_inputs() wait update, , output update happen quickly, snapshot might capture state application outputs updated.","code":"app$set_inputs(check_group = c(\"1\", \"2\")) app$set_inputs(check_group = c(\"1\", \"2\", \"3\")) app$click(\"action\") app$set_inputs(check_group = c(\"1\", \"2\", \"3\")) app$click(\"action\")"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"making-expectations","dir":"Articles","previous_headings":"Customizing test scripts","what":"Making expectations","title":"Testing in depth","text":"-depth discussion expectations, see Robust testing vignette. couple standard ways make expectations AppDriver object. app$expect_values(): simplest way make expectation. creates list values compares current values application. also takes debug screenshot stores snapshot. However, snapshot never fail expectation test. extra screenshot file useful manually determining UI changes happened time producing numerous false-positive test failures. app$expect_screenshot(): method takes screenshot application compares reference screenshot. screenshots different, fails test. ways use app$expect_values(). simplest way call arguments: first time called test script, record input, output, export values application, file called 001.json. next call save values 002.json, . time call app$expect_values(), also save debug screenshot web browser, file 001_.png, 002_.png, . screen shots useful debugging tests inspecting â€™re . can tell take screen shots, save space make tests run slightly faster, initialization step, : want disable screenshots single app$expect_values() call, can use: want targeted tests, can snapshot specific items using input, output, export parameters. example, capture value just outputs named \"\" \"b\", call: also capture specific inputs exports: Finally, want snapshot outputs inputs exports, can simply set output TRUE values requested recorded: can used snapshot input /export values. capture output export values, input values:","code":"app$expect_values() app <- AppDriver$new(expect_values_screenshot_args = FALSE) app$expect_values(screenshot_args = FALSE) app$expect_values(output = c(\"a\", \"b\")) app$expect_values(   input = \"n\",   output = c(\"a\", \"b\"),   export = c(\"e1\", \"e2\") ) app$expect_values(output = TRUE) app$expect_values(output = TRUE, export = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"exported-values","dir":"Articles","previous_headings":"Customizing test scripts","what":"Exported values","title":"Testing in depth","text":"cases, â€™s useful snapshot bits internal state application â€“ state â€™s reflected directly inputs outputs. can done exporting values. Consider toy example application internal reactive expression convenient capture.  Notice lines: creates exported values called xy yz. test snapshot taken, evaluates reactive expression inserts values snapshot: Note expression (.e.Â xy() yz()) saved exportTestValues() called, specific values. Generally, keep expressions simple possible test failures yield informative outputs. Note value serializable JSON, â€™s suitable testing complex objects.","code":"shinyApp(   fluidPage(     numericInput(\"x\", \"x\", 4),     numericInput(\"y\", \"y\", 10),     numericInput(\"z\", \"z\", 100),     verbatimTextOutput(\"result\", placeholder = TRUE)   ),   function(input, output, session) {     xy <- reactive(input$x * input$y)     yz <- reactive(input$y + input$z)      output$result <- renderText({       xy() / yz()     })      exportTestValues(       xy = {         xy()       },       yz = {         yz()       }     )   } ) exportTestValues(       xy = {         xy()       },       yz = {         yz()       }     ) {   \"input\": {     \"x\": 4,     \"y\": 10,     \"z\": 100   },   \"output\": {     \"result\": \"0.3636364\"   },   \"export\": {     \"xy\": 40,     \"yz\": 110   } }"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"adding-delays","dir":"Articles","previous_headings":"Customizing test scripts","what":"Adding delays","title":"Testing in depth","text":"cases, may need wait amount time steps (e.g.Â waiting CSS animations). can adding Sys.sleep() script. example: However, waiting Shiny reactives calculated, please read Waiting output (input) value section.","code":"Sys.sleep(0.5)"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"controlling-random-values","dir":"Articles","previous_headings":"Customizing test scripts","what":"Controlling random values","title":"Testing in depth","text":"application uses randomly-generated values (calling functions like rnorm, runif, sample directly indirectly), , normal operation, produce different results run. shinytest2 works comparing current state application previous state, random changes cause test failures. make applications exactly repeatable, can set random seed. can done specifying random seed recorder. seed can integer value.  test script already created, can set random seed editing test script AppDriver$new() call value seed. Moreover, need tests pass multiple versions R different RNGkind() defaults (e.g., 3.5 3.6), may want set fixed RNGkind() across tests (perhaps via RNGversion(\"3.5.0\")). However, using AppDriver$new(variant=) value contains R version can also remedy situation. many cases, instead setting random seed, elegant use output preprocessor.","code":"app <- AppDriver$new(seed = 4323)"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"tabs","dir":"Articles","previous_headings":"Widgets","what":"Tabs","title":"Testing in depth","text":"tabbed views, tabsetPanel() navbarPage(), order shinytest2 keep track tab currently selected, must id. example: ","code":"tabsetPanel(id = \"tabs\", ....) navbarPage(id = \"tabs\", ....)"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"uploading-files","dir":"Articles","previous_headings":"Widgets","what":"Uploading files","title":"Testing in depth","text":"record file upload event fileInput, test script line like : Notice filename \"mtcars.csv\" appears script without full file path. test recorder know file came ; knows name file. run test script, must copy file tests/testthat/ directory. See tests/testthat/ subdirectory app example. copying file directory, run test_app() usual.","code":"app$uploadFile(file1 = \"mtcars.csv\")"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"view-the-headless-browser","dir":"Articles","previous_headings":"Widgets","what":"View the headless browser","title":"Testing in depth","text":"step script, can inspect state application different ways. recommended way call app$view(). open browser window default Chrome browser. Another way take screenshot application. can call app$get_screenshot() take screenshot application. display screenshot plot. (RStudio, show Plots tab.) Using methods, can inspect screenshot see state application.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"getting-input-output-and-export-values","dir":"Articles","previous_headings":"Widgets","what":"Getting input, output, and export values","title":"Testing in depth","text":"can also useful get current input, output, export values. fetch values without incrementing expectation counter, can call app$get_values(). returns list, can inspect str() function. may look something like : values retrieved way can used expectation-based testing. example, retrieve checkbox_out value compare known string:","code":"vals <- app$get_values()  str(vals) #> List of 3 #>  $ input :List of 4 #>   ..$ action    :Classes 'integer', 'shinyActionButtonValue'  int 0 #>   ..$ checkbox  : logi TRUE #>   ..$ check_group: chr \"1\" #>   ..$ text      : chr \"Enter text...\" #>  $ output:List of 12 #>   ..$ action_out    : chr \"[1] 0\\nattr(,\\\"class\\\")\\n[1] \\\"integer\\\"                #> \\\"shinyActionButtonValue\\\"\" #>   ..$ checkbox_out  : chr \"[1] TRUE\" #>   ..$ check_group_out: chr \"[1] \\\"1\\\"\" #>   ..$ text_out      : chr \"[1] \\\"Enter text...\\\"\" #>  $ export: Named list() vals <- app$get_values() expect_identical(vals$output$checkbox_out, \"[1] TRUE\")  # Or in a single line: expect_identical(app$get_value(output = \"checkbox_out\"), \"[1] TRUE\")"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"wait-for-value","dir":"Articles","previous_headings":"Widgets","what":"Waiting for an input (or output) value","title":"Testing in depth","text":"situations, input value set, app$set_inputs() wait 3 seconds (default) next output value sent server. , however, application immediately send value interested , need insert app$wait_for_value() function call. readily useful htmlwidgets anything involves javascript code set input values. method can also used determine input (output) values set initial output values set reactivity done two stages. example, checking checkbox adds dynamic UI, old faithful Shiny example, three round trips browser Shiny server need occur. Checking checkbox Putting slider plot placeholder appâ€™s UI slider recognized browser, send information back Shiny causing plot rendered placed browser use app$set_inputs(\"chkbx\", TRUE) immediately take snapshot, likely miss correct plot value. dig , can look situationâ€™s example code: app.R: Naively, add Sys.sleep() function calls slow shinytest2 testing hope Shiny application stable state. ./tests/testthat/test-use-sleep-bad.R: pattern probably fail executed slower machine. pattern sleeping hoping replaced app$wait_for_idle() app$wait_for_value(). app$wait_for_idle() wait whole application idle 500ms (default). method intuitive, generic, easier code. app$wait_for_value() wait specific input value ignoreed value. method specific requires logic code. ./tests/testthat/test-wait-good.R:","code":"library(shiny)  ui <- fluidPage(   checkboxInput(\"chkbx\", \"Display Graph?\", FALSE),   uiOutput(\"dynamic_output\") )  server <- function(input, output) {   output$dynamic_output <- renderUI({     if(!input$chkbx) {       return(NULL)     }     tagList(       sliderInput(inputId = \"bins\", label = \"Number of bins:\", min = 1, max = 50, value = 30),       plotOutput(outputId = \"dist_plot\")     )   })    # Will not execute until `input$bins` is available   # `input$bins` is not available until `chkbx` is checked   output$dist_plot <- renderPlot({     # artificially slow the plot     Sys.sleep(5)      x    <- faithful$waiting     bins <- seq(min(x), max(x), length.out = input$bins + 1)     hist(x, breaks = bins, col = \"#75AADB\", border = \"white\",          xlab = \"Waiting time to next eruption (in mins)\",          main = \"Histogram of waiting times\")   }) } shinyApp(ui = ui, server = server) test_that(\"Sleeping can work to wait for an app to stabilize\", {   app <- AppDriver$new()    # Check the box to display the slider and plot   app$set_inputs('chkbx' = TRUE)   # Hope that the plot appears within 7 seconds   Sys.sleep(7)    app$snapshot()    app$set_inputs(bins = 40)   # Hope the newer plot appears within 7 seconds   Sys.sleep(7)    app$expect_values() }) test_that(\"Use $wait_for_idle() for app to stabilize\", {   app <- AppDriver$new()    # Check the box to display the slider and plot   app$set_inputs(chkbx = TRUE)    # Wait until Shiny is not busy for 500ms   app$wait_for_idle(500)    # Make expectation   app$expect_values()    # Change slider value to 40   app$set_inputs(bins = 40, wait_ = FALSE)   # Wait until Shiny is not busy for 500ms   app$wait_for_idle(500)    # Make expectation   app$expect_values() })  test_that(\"Use $wait_for_value() for app to stabilize\", {   app <- AppDriver$new()    # Check the box to display the slider and plot   app$set_inputs(chkbx = TRUE)    # Wait until `output$dist_plot` is not `NULL`   # (Store the retrieved plot value for later comparison)   first_plot_value <- app$wait_for_value(output = \"dist_plot\", ignore = list(NULL))    # Make expectation   app$expect_values()    # Change slider value to 40   app$set_inputs(bins = 40, wait_ = FALSE)   # Wait until plot does not equal the plot with 30 bins   app$wait_for_value(output = \"dist_plot\", ignore = list(first_plot_value))    app$expect_values() })"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"dealing-with-dynamic-data","dir":"Articles","previous_headings":"","what":"Dealing with dynamic data","title":"Testing in depth","text":"application uses data source changes time, snapshot taken yesterday may match snapshot taken today, even app hasnâ€™t changed. Dynamic data inherently poses challenge snapshot-based testing. problem can avoided detecting application tested, case use static data set instead. detection, can something like following:","code":"if (isTRUE(getOption(\"shiny.testmode\"))) {   # Load static/dummy data here } else {   # Load normal dynamic data here }"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"using-variant-to-expect-different-snapshots","dir":"Articles","previous_headings":"","what":"Using variant to expect different snapshots","title":"Testing in depth","text":"can variants deal cases snapshot output varies want capture test variations. Common use cases include variations operating system, R version, version key dependency. Variants advanced feature. use , â€™ll need carefully think testing strategy ensure important variants covered automated tests, ensure way get snapshot changes CI system back repo. recommended use AppDriver$new(variant= platform_variant()) capture operating system R version test running. Variants required calling $expect_screenshot(). NULL value may used, recommended testing reproducibility. shinytest2 expectation methods eventually call testthat::expect_snapshot_file() save snapshot files. Snapshot expectations compare variantâ€™s version snapshot file.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"inputs-without-input-bindings","dir":"Articles","previous_headings":"Limitations","what":"Inputs without input bindings","title":"Testing in depth","text":"input components Shiny set values communicating something called input binding. shinytest2 works well input values set via input bindings. However, components set input values without using input binding. include htmlwidgets, DT plotly, well Shinyâ€™s built-plot interactions renderPlot(). set unbound inputs, resulting test script code look something like : test script replayed, headless browser set inputs specified values send server running Shiny R. However, browser able tell input object exact behaviors. example, DT, row selected, mouse click event browser triggers DataTable highlight row browser also set input value Shiny. shinytest2 plays script, can latter part, setting input value. result screenshot taken, highlighted rows. components internal state updated response user interaction, internal state updated test script played. cases, may mean script played, behavior script played user actually interacts application. input component sets multiple input values (without bindings) response single user event, may make sense coalesce single set_inputs call, :","code":"app$set_inputs(table_rows_selected = 1, allow_no_input_binding_ = TRUE) app$set_inputs(table_row_last_clicked = 1, allow_no_input_binding_ = TRUE) app$set_inputs(   table_rows_selected = 1,   table_row_last_clicked = 1,   allow_no_input_binding_ = TRUE )"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"input-components-provided-as-variables","dir":"Articles","previous_headings":"Limitations","what":"Input component(s) provided as variable(s)","title":"Testing in depth","text":"cases might need provide input components using variables (hard-coded). â€™s possible $set_inputs() uses rlang::list2(...) process input values. function supports !!!, splicing operator, one can construct list outside set_inputs() use set input values.","code":"# helper function that wraps `set_inputs`, with  the default value for the 'dataset' component update_dataset <- function(app, value, component_id = \"dataset\") {   checkmate::assert_choice(value, c(\"rock\", \"pressure\", \"cars\"))   ml <- rlang::list2()   ml[[component_id]] <- value   app$set_inputs(!!!ml) }  app_dir <- system.file(\"examples/02_text\", package = \"shiny\") app <- shinytest2::AppDriver$new(app_dir) update_dataset(app, \"rock\")"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"next","dir":"Articles","previous_headings":"","what":"Next","title":"Testing in depth","text":"Learn using shinytest2 continuous integration.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"expectations","dir":"Articles","previous_headings":"","what":"Expectations","title":"Robust testing","text":"Unit tests provide sense security making assertions expected behavior. unit tests pass, can declare object/method valid. ğŸ¦† Letâ€™s look quick example :","code":"add_abs <- function(x, y) {   abs(x + y) }"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"confirm-the-expected-behavior","dir":"Articles","previous_headings":"Expectations","what":"Confirm the expected behavior","title":"Robust testing","text":"test positive numbers, can guess answer using +. However, negative number used, different behavior +. must test situations. Even better, letâ€™s test four positive/negative situations: concept can even expanded vectors values. However, can lead lot code.","code":"x <- 50; y <- 42 testthat::expect_equal(add_abs(x, y), x + y) x <- 50; y <- -42 testthat::expect_equal(add_abs(x, y), x + y) for (info in list(   list(x =  50, y =  42, expected =  92),   list(x = -50, y =  42, expected =  8),   list(x =  50, y = -42, expected =  8),   list(x = -50, y = -42, expected =  92) )) {   testthat::expect_equal(     add_abs(info$x, info$y),     info$expected   ) }"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"assert-as-little-unnecessary-information","dir":"Articles","previous_headings":"Expectations","what":"Assert as little unnecessary information","title":"Robust testing","text":"Tests strive confirm behavior control . example, interested behavior abs, concerned behavior +. can assume + working properly adds two numbers together. necessarily need perform multitude nonsense input testing +, may make sense see abs() handles non-number input values. tests also repeated swapping x y.","code":"testthat::expect_equal(add_abs(1, NA), NA) testthat::expect_equal(add_abs(1, NULL), numeric(0)) testthat::expect_error(add_abs(1, \"string\"))"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"write-clear-direct-tests","dir":"Articles","previous_headings":"Expectations","what":"Write clear, direct tests","title":"Robust testing","text":"writing tests, test can contain many expectations expectation pertain test run. example, two examples included test block: However, â€™s better break two separate tests, descriptive title. testthat great job displaying output user thing go wrong. first test goes wrong, error given like: great error found, also difficult determine assertion failed. Adding labels expectation using label expected.label allows provide context test failed. Another pattern provides context allows tests move -loop around call test_that() give test custom name: isolates test even let earlier expectation stop testing later expectation.","code":"# File: tests/testthat/test-add_abs-bad.R  test_that(\"add_abs() works\", {   for (info in list(     list(x =  50, y =  42, expected =  92),     list(x = -50, y =  42, expected =  8),     list(x =  50, y = -42, expected =  8),     list(x = -50, y = -42, expected =  92)   )) {     expect_equal(       add_abs(info$x, info$y),       info$expected     )   }    expect_equal(add_abs(1, NA), NA)   expect_equal(add_abs(1, NULL), numeric(0))   expect_error(add_abs(1, \"string\")) }) # File: tests/testthat/test-add_abs-better.R  test_that(\"add_abs() adds two numbers\", {   for (info in list(     list(x =  50, y =  42, expected =  92),     list(x = -50, y =  42, expected =  8),     list(x =  50, y = -42, expected =  8),     list(x =  50, y = -42, expected =  -8),     list(x = -50, y = -42, expected =  92)   )) {     expect_equal(       add_abs(info$x, info$y),       info$expected     )   } })  test_that(\"add_abs() handles non-numeric input\", {   expect_equal(add_abs(1, NA), NA)   expect_equal(add_abs(1, NULL), numeric(0))   expect_error(add_abs(1, \"string\")) }) â”€â”€ Failure (Line 9): add_abs() adds two numbers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ add_abs(info$x, info$y) (`actual`) not equal to info$expected (`expected`).    `actual`:  8 `expected`: -8 # File: tests/testthat/test-add_abs-label.R  test_that(\"add_abs() adds two numbers\", {   for (info in list(     list(x =  50, y =  42, expected =  92),     list(x = -50, y =  42, expected =  8),     list(x =  50, y = -42, expected =  8),     list(x =  50, y = -42, expected =  -8), # <- Failing line     list(x = -50, y = -42, expected =  92)   )) {     expect_equal(       add_abs(info$x, info$y),       info$expected,       label = paste0(\"x:\", info$x, \"; y:\", info$y),       expected.label = info$expected     )   } }) #> â”€â”€ Failure (Line 9): add_abs() adds two numbers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #> x:50; y:-42 (`actual`) not equal to info$expected (`expected`). #> #>   `actual`:  8 #> `expected`: -8 # File: tests/testthat/test-add_abs-label.R  for (info in list(   list(x =  50, y =  42, expected =  92),   list(x = -50, y =  42, expected =  8),   list(x =  50, y = -42, expected =  8),   list(x =  50, y = -42, expected =  -8), # <- Failing line   list(x = -50, y = -42, expected =  92) )) {   test_that(paste0(\"add_abs() adds two numbers: [\", info$x, \", \", info$y, \"]\"), {     expect_equal(       add_abs(info$x, info$y),       info$expected     )   }) } #> Test passed ğŸŠ #> Test passed ğŸ‰ #> Test passed ğŸŒˆ #> â”€â”€ Failure (Line 9): add_abs() adds two numbers: [50, -42] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #> add_abs(info$x, info$y) (`actual`) not equal to info$expected (`expected`). #> #>   `actual`:  8 #> `expected`: -8 #> Test passed ğŸ¥‡"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"shinytest2-expectations","dir":"Articles","previous_headings":"","what":"{shinytest2} expectations","title":"Robust testing","text":"shinytest2 handful built expectation methods: AppDriver$expect_unique_names(): Assert input output names unique AppDriver$expect_values(): Expect input, output, export values consistent AppDriver$expect_download(): Expect downloaded file downloadable AppDriver$expect_text(): Expect text content given selector consistent AppDriver$expect_html(): Expect HTML content given selector consistent AppDriver$expect_js(): Expect JavaScript return value consistent AppDriver$expect_screenshot(): Expect screenshot UI consistent","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"inputoutput-names","dir":"Articles","previous_headings":"{shinytest2} expectations","what":"input/output names","title":"Robust testing","text":"Letâ€™s take look AppDriver$expect_unique_names(). method called (default) AppDriver$new(check_names = TRUE) confirms input output HTML names duplicated. duplicate values found, results invalid HTML possible failure within Shiny. One way help keep input output names unique adopt naming behavior adding _out end output, e.g.Â outputs$text_out. use dynamic UI want reassert names still unique, perfectly acceptable call AppDriver$expect_unique_names() setting dynamic UI values.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"shiny-values","dir":"Articles","previous_headings":"{shinytest2} expectations","what":"Shiny values:","title":"Robust testing","text":"AppDriver$expect_values() preferred method testing shinytest2. method tests different input, output, export values provided Shiny application. input corresponds input values provided Shiny application. output corresponds output values provided Shiny application. export corresponds value _export_ed Shiny application. values exported shiny::exportTestValues() within server function. AppDriver$expect_values() called, input, output, export value serialized JSON saved snapshot file (e.g.Â 001.json) followup expectations. addition value snapshot file, debug screenshot saved snapshot directory file name ending _.png (e.g.Â 001_.png). screenshot useful knowing application looked like values captured. However, differences captured screenshot never cause test failures. recommended add _.new.png .gitignore file ignore new debug screenshots accepted. typical app testing, method cover testing needs. (Remember, try test content control .)","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"downloads","dir":"Articles","previous_headings":"{shinytest2} expectations > Shiny values:","what":"Downloads","title":"Robust testing","text":"shiny::downloadButton() shiny::downloadLink() elements clicked, file downloaded. make expectation downloaded file, can use AppDriver$expect_download(). addition file saved, snapshot file name downloaded saved suggested file name used.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"ui-expectations","dir":"Articles","previous_headings":"{shinytest2} expectations","what":"UI expectations","title":"Robust testing","text":"Two methods provided middle ground taking screenshots testing Shiny app values: AppDriver$expect_text() AppDriver$expect_html(). AppDriver$expect_text(selector=) asks Chrome browser current text contents within selected elements. method great test contents input output values. AppDriver$expect_text() able retrieve pseudo elements values text inside <text> <textarea> input elements. AppDriver$expect_html(selector=) asks Chrome browser current DOM structures within selected elements. method perfect app authors constructing DOM structures want verify consistently produced. , AppDriver$expect_html() able retrieve pseudo elements values text inside <text> <textarea> input elements. Finally, methods wrap around AppDriver$expect_js(script=). method executes script return value saved snapshot. AppDriver$expect_text() AppDriver$expect_html() wrappers around AppDriver$expect_js().","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"ui-visual-expectations","dir":"Articles","previous_headings":"{shinytest2} expectations","what":"UI visual expectations","title":"Robust testing","text":"Taking screenshot brittle expectation provided shinytest2. AppDriver$expect_screenshot() used absolutely necessary willing handle many false-positive failures. many ways screenshot expectation can fail unrelated code, including: R version changed operating system changed (e.g.Â Windows vs.Â Linux) system font changed Chrome consistent paints DOM elements CSS transitions finish time package author (e.g.Â Shiny, bslib, htmltools) changed DOM structure App authors use custom CSS JavaScript may find method useful. still strongly recommended test content control avoid false-positive failures. expecting screenshot, AppDriver$new(variant=) must supplied. value may NULL, recommended use shinytest2::platform_variant().","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"exported-values","dir":"Articles","previous_headings":"Suggested approaches","what":"Exported values","title":"Robust testing","text":"recommended enough use shiny::exportTestValues() test Shiny appâ€™s reactive values. make assumption package authors create consistent render methods, can test values provided render methods using shiny::exportTestValues(). Letâ€™s look example Shiny app displays plot first n rows data. recommended make render methods contain minimal logic value rendered can also exported.  dt plot_obj exported.Â means available executing AppDriver$get_values(), AppDriver$get_value(), AppDriver$expect_values(). Plots notoriously hard test consistently time different platforms. Similar AppDriver$expect_screenshot(), many ways outside code plot can produce change fail visual test. include: Default system font changes, different operating systems different fonts Default system font size changes R version changes possible, recommended use {ggplot2} base::plot() ggplot2 getting closer closer cross platform compatible. ggplot2 objects can also inspected compared using {vdiffr} cross platform support.","code":"library(shiny) library(ggplot2) ui <- fluidPage(   numericInput(\"n\", \"Number of rows\", 10, 1, nrow(cars)),   plotOutput(\"plot\") ) server <- function(input, output) {   dt <- reactive({     head(cars, input$n)   })   plot_obj <- reactive({     ggplot(dt(), aes_string(\"speed\", \"dist\")) + geom_point()   })    output$plot <- renderPlot({     plot_obj()   })    exportTestValues(     dt = dt(),     plot_obj = plot_obj()   ) } plot_app <- shinyApp(ui = ui, server = server) plot_app app <- AppDriver$new(plot_app)  values <- app$get_values() str(values) # Output has been truncated for printing #> List of 3 #>  $ input :List of 1 #>   ..$ n: int 10 #>  $ output:List of 1 #>   ..$ plot:List of 5 #>   .. ..$ src     : chr \"data:image/png;base64,iVBORw0\"| __truncated__ #>   .. ..$ width   : int 962 #>   .. ..$ height  : int 400 #>   .. ..$ alt     : chr \"Plot object\" #>   .. ..$ coordmap:List of 2 | __truncated__ #>  $ export:List of 2 #>   ..$ dt      :'data.frame': 10 obs. of  2 variables: #>   .. ..$ speed: num [1:10] 4 4 7 7 8 9 10 10 10 11 #>   .. ..$ dist : num [1:10] 2 10 4 22 16 10 18 26 34 17 #>   ..$ plot_obj:List of 9 #>   .. ..$ data       :'data.frame':   10 obs. of  2 variables: #>   .. .. ..$ speed: num [1:10] 4 4 7 7 8 9 10 10 10 11 #>   .. .. ..$ dist : num [1:10] 2 10 4 22 16 10 18 26 34 17 #>   .. ..$ layers     :List of 1 | __truncated__ #>   .. ..$ scales     :Classes 'ScalesList', 'ggproto', 'gg' <ggproto object: Class | __truncated__ #>   .. ..$ mapping    :List of 2 | __truncated__ #>   .. ..$ theme      : list() | __truncated__ #>   .. ..$ coordinates:Classes 'CoordCartesian', 'Coord', 'ggproto', 'gg' <ggproto  | __truncated__ #>   .. ..$ facet      :Classes 'FacetNull', 'Facet', 'ggproto', 'gg' <ggproto object: Class  | __truncated__ #>   .. ..$ plot_env   :<environment: 0x7fad13bd3d58> #>   .. ..$ labels     :List of 2 #>   .. .. ..$ x: chr \"speed\" #>   .. .. ..$ y: chr \"dist\" #>   .. ..- attr(*, \"class\")= chr [1:2] \"gg\" \"ggplot\""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"snapshots-vs-values","dir":"Articles","previous_headings":"Suggested approaches","what":"Snapshots vs values","title":"Robust testing","text":"Snapshot testing makes test writing minimal quick. However, comes logical risk. Snapshots wonderful determining change occurred. first execution snapshot nothing compare, first value taken truth even correct. allows opportunity invalid values saved truth. time, OK use snapshots beginning testing experience, keeping track snapshot file can tedious testing multiple applications multiple variants. remedy possibility, app values can tested known static values. example, instead testing initial value dt() snapshot, can test head(cars, 10). time manually inspect snapshot files afterwards, using AppDriver snapshot code provides clean, minimal code. snapshot files unwieldy, can use AppDriver retrieve values test known values.","code":"# Snapshot code app$expect_values(export = \"dt\")  # Manual expectation code expect_equal(   app$get_value(export = \"dt\"),   head(cars, 10) )"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"example","dir":"Articles","previous_headings":"Suggested approaches","what":"Example","title":"Robust testing","text":"Letâ€™s look write shinytest2 test make sure plot updated updating numeric input n. Assuming Shiny app code saved app.R, can look tests/testthat/test-export.R . successfully run code , sure vdiffr installed. Since calling AppDriver$expect_screenshot() AppDriver$get_screenshot(), need use AppDriver$new(variant=). second half test performs similar expectations first half test. code can pulled helper function written : noted ggplot2 objects can serialized JSON excluded AppDriver$expect_values() snapshots.","code":"# File: ./tests/testthat/test-export.R # App file: ./app.R library(shinytest2)  test_that(\"`export`ed `plot_obj` is updated by `n`\", {   skip_if_not_installed(\"vdiffr\")    app <- AppDriver$new()    # Verify `dt()` uses first 10 lines of `cars`   n10 <- app$get_value(input = \"n\")   expect_equal(n10, 10)   # Verify `dt10()` data is first 10 lines of `cars`   dt10 <- app$get_value(export = \"dt\")   expect_equal(dt10, head(cars, n10))    # Verify `plot_obj()` data is `dt()`   plot_obj_10 <- app$get_value(export = \"plot_obj\")   expect_equal(plot_obj_10$data, dt10)   # Verify `plot_obj()` is consistent   vdiffr::expect_doppelganger(\"cars-points-10\", plot_obj_10)    ## Update `n` to 20   app$set_inputs(n = 20)    # Verify `n` was updated   n20 <- app$get_value(input = \"n\")   expect_equal(n20, 20)   # Verify `dt()` uses first 20 lines of `cars`   dt20 <- app$get_value(export = \"dt\")   expect_equal(dt20, head(cars, n20))    # Verify `plot_obj()` data is `dt()`   plot_obj_20 <- app$get_value(export = \"plot_obj\")   expect_equal(plot_obj_20$data, dt20)   vdiffr::expect_doppelganger(\"cars-points-20\", plot_obj_20) }) # File: tests/testthat/test-export.R library(shinytest2)  test_that(\"`export`ed `plot_obj` is updated by `n`\", {   skip_if_not_installed(\"vdiffr\")    app <- AppDriver$new(variant = platform_variant())    expect_n_and_plot <- function(n) {     # Verify `n` input equals `n`     n_val <- app$get_value(input = \"n\")     expect_equal(n_val, n, expected.label = n)     # Verify `dt()` data is first `n` lines of `cars`     dt <- app$get_value(export = \"dt\")     expect_equal(dt, head(cars, n), expected.label = paste0(\"head(cars, \", n, \")\"))      # Verify `plot_obj()` data is `dt()`     plot_obj <- app$get_value(export = \"plot_obj\")     expect_equal(plot_obj$data, dt, info = paste0(\"n = \", n))     # Verify `plot_obj()` is consistent     vdiffr::expect_doppelganger(paste0(\"cars-points-\", n), plot_obj)   }    expect_n_and_plot(10)    # Update `n` to 20   app$set_inputs(n = 20)   expect_n_and_plot(20) })"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"retrieving-values","dir":"Articles","previous_headings":"Cliffs Notes","what":"Retrieving values","title":"Robust testing","text":"Best way retrieve values serialized saveRDS() Safest way compare values comparisons (e.g.Â expect_equal()) need explicitly stated beginning Pro: Supports complex objects like ggplot2 plots Con: Causes code verbose","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"expectation-methods","dir":"Articles","previous_headings":"Cliffs Notes","what":"Expectation methods","title":"Robust testing","text":"AppDriver$expect_*() snapshots manually inspected first created ensure contain expected content. Go-expectation method Shiny input, output, export values Automatically recorded shinytest2::record_app() Saves debug screenshot manual inspection Pro: Tests (almost) Shiny values Con: Complex objects containing environments (e.g.Â ggplot2 plots) serialized JSON Get: AppDriver$get_value() AppDriver$get_values() Automatically recorded shinytest2::record_app() Pro: save snapshot requested filename Get: AppDriver$get_download() Safest way retrieve text given selector stable AppDriver$expect_html(), gives freedom UI authors make HTML structure changes Pro: Can test non-Shiny content using selector Con: used test text inputs Get: AppDriver$get_text() Expects HTML consistently shaped given selector stable AppDriver$expect_screenshot(), gives freedom UI authors Pro: Can test non-Shiny content using selector Con: used test text inputs Get: AppDriver$get_html() Makes expectation JavaScript result Building block AppDriver$expect_text() AppDriver$expect_html() Con: Must write JavaScript code test Get: AppDriver$get_js() Saves screenshot selector (defaults \"html\") later comparison Strongly recommended use testing methods possible Pro: picture can worth thousand [tests] Con: Screenshot reproducibility brittle non-Shiny changes Get: AppDriver$get_screenshot()","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"why-test-shiny-applications","dir":"Articles","previous_headings":"","what":"Why test Shiny applications?","title":"Getting started with shinytest2","text":"get Shiny application state works, â€™s often useful automated system checks continues work expected. many possible reasons application stop working. reasons include: upgraded R package different behavior. (include Shiny !) make modifications application. external data source stops working, returns data changed format. One way detect problems manual testing â€“ words, person interact app browser â€“ can time-intensive, inconsistent, imprecise. automated tests can alert kinds problems quickly almost zero effort, tests created.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"how-testing-works-with-shinytest2","dir":"Articles","previous_headings":"","what":"How testing works with shinytest2","title":"Getting started with shinytest2","text":"shinytest2 package provides tools creating running automated tests Shiny applications. shinytest2 uses testthatâ€™s snapshot-based testing strategy. first time runs set tests application, performs scripted interactions app takes one snapshots applicationâ€™s state. snapshots saved disk future runs tests can compare results . create tests, easiest method use record_test() function. launches application web browser records interactions application. interactions saved tests/testthat/test-shinytest2.R run using strategy described .","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"Getting started with shinytest2","text":"Begin installing shinytest2 CRAN:","code":"install.packages(\"shinytest2\")"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"recording-tests","dir":"Articles","previous_headings":"Getting started","what":"Recording tests","title":"Getting started with shinytest2","text":"general procedure recording tests: Run record_test() launch app test recorder. Create tests interacting application telling recorder make expectation state various points. Quit test recorder. , three things happen: test script saved tests/testthat/test-shinytest2.R subdirectory application. running RStudio IDE, automatically open file editor. tests execute record tests, first need app. simple app â€™ve placed simple-app/app.R: test , now load {shinytest2}, call record_test() path app: separate R process, launches Shiny application tested. â€™ll refer target app. also launches special Shiny application current R process displays target app iframe controls outside iframe. â€™ll refer recorder app. see something like :  left target app (case, â€œnameâ€ app), right recorder app sidebar. Note may need make browser window wider recorder sidebar occupies space. sidebar right displays controls test recorder, well set Code expectations actions. interact target app â€“ words, set inputs app â€“ see actions recorded Code output. testing Shiny application, setting inputs one part. â€™s also necessary check application produces correct outputs. accomplished taking expectations applicationâ€™s state. two ways record output values. One way take expectation applicationâ€™s state. record input values, output values, exported values (exported values later). , click Expect Shiny values button recorder app. modifying inputs making expectation, look something like :  also possible take targeted value expectation. snapshot one specified output (instead default, snapshot entire application). , hold Control (Command) button keyboard click output; snapshot just one output. done recording sequence events, click Save test exit button. RStudio IDE, open test script tests/testthat/test-shinytest2.R subdirectory application.","code":"library(shiny) ui <- fluidPage(   textInput(\"name\", \"What is your name?\"),   actionButton(\"greet\", \"Greet\"),   textOutput(\"greeting\") ) server <- function(input, output, session) {   output$greeting <- renderText({     req(input$greet)     paste0(\"Hello \", isolate(input$name), \"!\")   }) } shinyApp(ui, server) library(shinytest2) record_test(\"simple-app/\") # File: tests/testthat/test-shinytest2.R library(shinytest2)  test_that(\"{shinytest2} recording: simple-app\", {   app <- AppDriver$new(name = \"simple-app\", height = 407, width = 348)   app$set_inputs(name = \"Barret\")   app$click(\"greet\")   app$expect_values() })"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"running-tests","dir":"Articles","previous_headings":"Getting started","what":"Running tests","title":"Getting started with shinytest2","text":"quit test recorder, automatically run test script. three separate components involved running tests: First test driver. R process coordinates testing controls web browser. working creating tests interactively, R process use. Next Shiny process, also known server. R process runs target Shiny application. Finally, web browser, also known client, connects server. headless web browser â€“ one renders web page internally, doesnâ€™t display content screen ({chromote}). exit test recorder, (default) automatically run test script print something like : Behind scenes, runs test_app(). can manually run tests : play back interactions record snapshots, specified test script. first time tests run, saved subdirectory app called tests/testthat/_snaps. expected results, future test runs compared . directory contain two types files different expectations. example: .json file JSON representation state application app$expect_values() called. .png file screenshot application app$expect_screenshot(), can use insure visual state application change. _.png file debug screenshot application app$expect_values() called. file tracked using git know application visually changes time. However, difference found new screenshot, difference throw error. JSON file stores state input, output, export values time snapshot: using source control system (like git), check expected results. (ignore _.new.png files.)","code":"â€¢ Saving test runner: tests/testthat.R â€¢ Saving test file: tests/testthat/test-shinytest2.R â€¢ Running recorded test: tests/testthat/test-shinytest2.R âœ” | F W S  OK | Context âœ” |   2     1 | shinytest2 [2.6s] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Warning (test-shinytest2.R:7:3): {shinytest2} recording: simple-app Adding new file snapshot: 'tests/testhat/_snaps/simple-app-001_.png'  Warning (test-shinytest2.R:7:3): {shinytest2} recording: simple-app Adding new file snapshot: 'tests/testhat/_snaps/simple-app-001.json' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•â• Results â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Duration: 2.6 s  [ FAIL 0 | WARN 2 | SKIP 0 | PASS 1 ] test_app(\"simple-app\", filter = \"shinytest2\") 001.json 001_.png 002.png {   \"input\": {     \"greet\": 1,     \"name\": \"Barret\"   },   \"output\": {     \"greeting\": \"Hello Barret!\"   },   \"export\": {    } }"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"subsequent-test-runs","dir":"Articles","previous_headings":"Getting started","what":"Subsequent test runs","title":"Getting started with shinytest2","text":"initial test run, can run tests future check changes applicationâ€™s behavior. changes snapshots, just see something like , additional output: results exactly , test considered successful. differences latest run expected results, â€™ll see output like : view differences, follow prompted code testthat::snapshot_review('shinytest2/') within application directory. (may need run install.packages(\"diffviewer\") testthat::snapshot_review() successfully execute.) look something like :  inspecting changes, can choose update expected results (, replace old expected results new current results), just quit without updating. update results changes expected. skip/quit without updating changes unexpected.","code":"> test_app(\"path/to/app\") âœ” | F W S  OK | Context âœ” |         1 | shinytest2 [2.2s]  â•â• Results â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Duration: 2.2 s  [ FAIL 0 | WARN 0 | SKIP 0 | PASS 1 ] âœ” | F W S  OK | Context âœ– | 1       0 | shinytest2 [2.1s] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Failure (test-shinytest2.R:7:3): {shinytest2} recording: simple-app Snapshot of `file` to 'shinytest2/simple-app-001.json' has changed Run `testthat::snapshot_review('shinytest2/')` to review changes Backtrace: 1. app$expect_values()       at test-shinytest2.R:7:2 2. shinytest2::app_expect_values(...)       at shinytest2.nosync/R/app-driver.R:651:6 3. shinytest2::app__expect_snapshot_file(...)       at shinytest2.nosync/R/app-driver-expect-values.R:211:2 4. testthat::expect_snapshot_file(...)       at shinytest2.nosync/R/expect-snapshot.R:35:2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•â• Results â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Duration: 2.2 s  [ FAIL 1 | WARN 0 | SKIP 0 | PASS 0 ]"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"multiple-test-scripts","dir":"Articles","previous_headings":"Getting started","what":"Multiple test scripts","title":"Getting started with shinytest2","text":"example , single test script, named test-shinytest2.R. want one set tests application, can record new tests, unique name. can enter name recording tests:  saved test can moved different testing file, e.g.Â tests/testthat/test-simple-app.R. run test_app(\"path//app\"), run tests scripts applicationâ€™s tests/testhat directory.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"interactive-r-markdown-documents","dir":"Articles","previous_headings":"","what":"Interactive R Markdown documents","title":"Getting started with shinytest2","text":"shinytest2 can used interactive R Markdown documents use runtime: shiny server: shiny (sometimes also referred Shiny documents). includes use flexdashboard package. Shiny documents differences compared regular Shiny applications, tests slightly different. example interactive Rmd tests, please follow link.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"randomness","dir":"Articles","previous_headings":"Interactive R Markdown documents","what":"Randomness","title":"Getting started with shinytest2","text":"Shiny Rmd application, UI application created dynamically, using randomly generated IDs. make results repeatable, must set random seed; otherwise output slight differences run. See section controlling random values information.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"one--rmd-file-per-directory","dir":"Articles","previous_headings":"Interactive R Markdown documents","what":"One .Rmd file per directory","title":"Getting started with shinytest2","text":"testing Shiny documents, one .Rmd file allowed per directory. way test directory structured. (Note name Shiny document index.Rmd, deployed Shiny Server, URL can use directory name, like \"http://mydomain.com/dirname/\", instead \"http://mydomain.com/dirname/index.Rmd\". deployed RStudio Connect Shinyapps.io, filename automatically used URL.)","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"prerendered-shiny-documents","dir":"Articles","previous_headings":"Interactive R Markdown documents","what":"Prerendered Shiny documents","title":"Getting started with shinytest2","text":"Shiny documents use runtime: shiny_prerendered, helps speed page loading time. Normally, first time applications run, leave behind generated .html file well cache directory named myfile_data/. can remove files adding end test script (assuming name document doc.Rmd): Alternatively, can save generated files, tests run generated files, prerendering step run future tests. example prerendered .Rmd tests, please follow link.","code":"rmarkdown::shiny_prerendered_clean(\"../doc.Rmd\")"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"next","dir":"Articles","previous_headings":"","what":"Next","title":"Getting started with shinytest2","text":"Learn shinytest testing depth article.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-application-audit.html","id":"audit-shiny-apps-with-shinytest2","dir":"Articles","previous_headings":"","what":"Audit Shiny apps with {shinytest2}","title":"Auditing Shiny apps","text":"ever dreamed profiling, load testing Shiny app commit, without manually run script? vignette, â€™ll see one can design automate Shiny apps audit pipelines shinytest2.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-application-audit.html","id":"introduction","dir":"Articles","previous_headings":"Audit Shiny apps with {shinytest2}","what":"Introduction","title":"Auditing Shiny apps","text":"case study consists analyzing particularly non-optimized app, whose code defined . app simulates stiff oscillator, also known Van der Pol model. hood, system (composed 2 differential equations) integrated deSolve package. Stiff systems need much smaller time step classic systems, thereby requiring time solve: first test, can run app calling runApp(system.file(\"vig-apps/non-optimized-app/\", package = \"shinytest2\")) locally notice slow perform one computation. next question , app scale? answer likely â€œdoesnâ€™t!â€, like know exactly bad . load testing comes play.","code":"van_der_pol <- function(t, y, mu) {   d_x <- y[2]   d_y <- mu * (1 - y[1]^2) * y[2] - y[1]   list(c(X = d_x, Y = d_y)) }  server <- function(input, output) {   output$brussels <- renderPlot({     y0 <- c(X = input$X, Y = input$Y)     times <- seq(0, 1000, .01)     out <- ode(y0, times, van_der_pol, input$mu)     par(mfrow = c(1, 1))     plot(out[, 2:3], type = \"l\", xlab = \"X\", ylab = \"Y\", main = \"state diagram\")   }) }  ui <- fluidPage(   headerPanel(\"Van der Pol oscillator\"),   sidebarLayout(     sidebarPanel(       h3(\"Init values\"),       numericInput(\"X\", label = \"X\", min = 0.0, max = 5,  value = 1, step = 0.2),       numericInput(\"Y\", label = \"Y\", min = 0.0, max = 5,  value = 1, step = 0.2),        h3(\"Parameters\"),       numericInput(\"mu\", label = \"mu\", min = 0.0, max = 5,  value = 1, step = 0.1)     ),     mainPanel(       h3(\"Simulation results\"),       plotOutput(\"brussels\")     )   ) )  shinyApp(ui = ui, server = server)"},{"path":"https://rstudio.github.io/shinytest2/articles/use-application-audit.html","id":"load-testing-with-shinytest2","dir":"Articles","previous_headings":"Audit Shiny apps with {shinytest2}","what":"Load testing with {shinytest2}","title":"Auditing Shiny apps","text":"Shiny app load testing aims running multiple identical user sessions parallel measure resulting app response. answers many questions, : time necessary get homepage? much time take perform first computation? session end time? load test composed three phases: Similarly shinytest2, shinyloadtest records user session shinyloadtest::record_session(). session subsequently replayed Java-based tool, shinycannon, able simulate multiple sessions chosen amount time. Sessions analyzed shinyloadtest::load_runs() HTML report generated shinyloadtest::shinyloadtest_report(). general, first step done manually, , play app real business user stop session satisfied. However, shinytest2 headless capabilities, manipulate app shinytest2 helpers set_inputs raw JavaScript code achieve goal. , however, tiny technical obstacle overcome. default, shinytest2 starts app given port headless browser, namely Chrome, connected port. issue shinyloadtest since recorder listen port, 8600. practice, â€™ll : Start Shiny app background process given port. Fire load test recorder port 8600. Connect Chrome recorder port 8600.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-application-audit.html","id":"launch-the-background-app","dir":"Articles","previous_headings":"Audit Shiny apps with {shinytest2} > Load testing with {shinytest2}","what":"Launch the background app","title":"Auditing Shiny apps","text":"may already noticed launching Shiny app, canâ€™t run anything else R console app live. explanation pretty simple: R performs tasks sequentially can perform one calculation time. start app without blocking main R process? leverage callr package, exposes convenient API start R processes background, , without blocking main R process. code shows start Shiny app located path specific port run load test recorder port: can pass start_r_bg() function: r_bg() starts background R process, passing corresponding function parameters. Besides, provide log elements safety guard case app canâ€™t start. launch app recorder can call:","code":"# Main shiny app shiny_bg <- function(path, port) {   options(shiny.port = port)   shiny::runApp(path) }  # Start recorder recorder_bg <- function(port) {   shinyloadtest::record_session(     target_app_url = sprintf(\"http://127.0.0.1:%s\", port),     host = \"127.0.0.1\",     port = 8600,     output_file = \"recording.log\",     open_browser = FALSE   ) } start_r_bg <- function(fun, path = NULL, port = 3515) {    # remove NULL elements   args <- Filter(Negate(is.null), list(path = path, port = port))    process <- callr::r_bg(     func = fun,     args = args,     stderr= \"\",     stdout = \"\"   )    while (any(is.na(pingr::ping_port(\"127.0.0.1\", 3515)))) {     message(\"Waiting for Shiny app to start...\")     Sys.sleep(0.1)   }    attempt::stop_if_not(     process$is_alive(),     msg = \"Unable to launch the subprocess\"   )    process } target <- start_r_bg(shiny_bg, path = system.file(\"vig-apps/non-optimized-app/\", package = \"shinytest2\")) # Listening on 127.0.0.1:3515 recorder <- start_r_bg(recorder_bg) # Listening on 127.0.0.1:8600"},{"path":"https://rstudio.github.io/shinytest2/articles/use-application-audit.html","id":"connect-chrome","dir":"Articles","previous_headings":"Audit Shiny apps with {shinytest2} > Load testing with {shinytest2}","what":"Connect Chrome","title":"Auditing Shiny apps","text":"previous part technical step. Now, start Chrome headless browser port 8600, load test recorder runs. â€™ll notice shinytest2 also supports remote urls. increase value load_timout 15 seconds help us avoid producing annoying shinytest2 warning: running Linux OS, shows list R processes running far background: everything successful, see Client connected message R console. change mu parameter input without forgetting timeout: can inspect logs help chrome$get_log(), check whether everything run smoothly: satisfied, may close headless connection stop recorder:","code":"{shinytest2} R  info 15:25:37.36 Error while initializing AppDriver: Shiny app did not become stable in 10000ms. # Start AppDriver with recorder url chrome <- shinytest2::AppDriver$new(\"http://127.0.0.1:8600\", load_timeout = 15 * 1000) $ netstat -lntp  Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name tcp        0      0 127.0.0.1:8600          0.0.0.0:*               LISTEN      361115/R tcp        0      0 127.0.0.1:3515          0.0.0.0:*               LISTEN      361101/R tcp        0      0 127.0.0.1:44179         0.0.0.0:*               LISTEN      359555/google-chrom app$set_inputs(mu = 4, timeout_ = 15 * 1000) app$get_logs() #> {shinytest2} R  info 14:27:00.80 Start AppDriver initialization #> {shinytest2} R  info 14:27:00.82 Creating new ChromoteSession #> {shinytest2} R  info 14:27:02.20 Navigating to Shiny app #> {shinytest2} R  info 14:27:02.57 Injecting shiny-tracer.js #> {chromote}   JS info 14:27:02.61 shinytest2; jQuery not found #> {chromote}   JS info 14:27:02.63 shinytest2; Loaded #> {shinytest2} R  info 14:27:02.64 Waiting for Shiny to become ready #> {chromote}   JS info 14:27:02.72 shinytest2; jQuery found #> {chromote}   JS info 14:27:02.73 shinytest2; Waiting for shiny session to connect #> {chromote}   JS info 14:27:03.12 shinytest2; Connected #> {shinytest2} R  info 14:27:03.17 Waiting for Shiny to become idle for 200ms within 10000ms #> {chromote}   JS info 14:27:03.18 shinytest2; Waiting for Shiny to be stable #> {chromote}   JS info 14:27:03.27 shinytest2; shiny:busy #> {chromote}   JS info 14:27:06.28 shinytest2; shiny:idle #> {chromote}   JS info 14:27:06.30 shinytest2; shiny:value brussels #> {chromote}   JS info 14:27:06.48 shinytest2; Shiny has been idle for 200ms #> {shinytest2} R  info 14:27:06.48 Shiny app started #> {shinytest2} R  info 14:30:17.79 Setting inputs: 'mu'', ''X'', ''Y' #> {chromote}   JS info 14:30:17.81 shinytest2; inputQueue: adding mu #> {chromote}   JS info 14:30:17.81 shinytest2; inputQueue: adding X #> {chromote}   JS info 14:30:17.81 shinytest2; inputQueue: adding Y #> {chromote}   JS info 14:30:17.82 shinytest2; inputQueue: flushing mu #> {chromote}   JS info 14:30:17.83 shinytest2; inputQueue: flushing X #> {chromote}   JS info 14:30:17.83 shinytest2; inputQueue: flushing Y #> {chromote}   JS info 14:30:17.87 shinytest2; shiny:busy #> {chromote}   JS info 14:30:20.42 shinytest2; shiny:idle #> {chromote}   JS info 14:30:20.46 shinytest2; shiny:value brussels #> {shinytest2} R  info 14:30:20.47 Finished setting inputs. Timedout: FALSE # clean app$stop() # needed to avoid # java.lang.IllegalStateException: last event in log not a # WS_CLOSE (did you close the tab after recording?) Sys.sleep(2)"},{"path":"https://rstudio.github.io/shinytest2/articles/use-application-audit.html","id":"replay-with-shinycannon","dir":"Articles","previous_headings":"Audit Shiny apps with {shinytest2} > Load testing with {shinytest2}","what":"Replay with shinycannon","title":"Auditing Shiny apps","text":"remember, final step consists replaying main session parallel. start shinycannon 5 workers wait: error message shinycannon logs can explained failures shinytest2 driver initialization. error persist, best practice restart R, cleanup everything start .","code":"target_url <- \"http://127.0.0.1:3515\" workers <- 5 system(   sprintf(     \"shinycannon recording.log %s --workers %s --loaded-duration-minutes 2 --output-dir run1\",     target_url, workers   ) )  # shinycannon replay #2022-05-09 14:37:18.549 INFO [thread00] - Detected target application type: R/Shiny #2022-05-09 14:37:18.560 INFO [thread00] - Waiting for warmup to complete #2022-05-09 14:37:18.554 INFO [thread01] - Warming up #2022-05-09 14:37:18.562 INFO [progress] - Running: 0, Failed: 0, Done: 0 #2022-05-09 14:37:23.563 INFO [progress] - Running: 1, Failed: 0, Done: 0"},{"path":"https://rstudio.github.io/shinytest2/articles/use-application-audit.html","id":"report-generation","dir":"Articles","previous_headings":"Audit Shiny apps with {shinytest2} > Load testing with {shinytest2}","what":"Report generation","title":"Auditing Shiny apps","text":"report generation quite straightforward: donâ€™t forget clean target app kill underlying process. Note want deploy report GitHub Pages, name index.html.","code":"# Close the running app target$kill()  # Treat data and generate report df <- shinyloadtest::load_runs(\"run1\") shinyloadtest::shinyloadtest_report(   df,   \"public/index.html\",   self_contained = TRUE,   open_browser = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/articles/use-application-audit.html","id":"automating-with-github-actions","dir":"Articles","previous_headings":"Audit Shiny apps with {shinytest2} > Load testing with {shinytest2}","what":"Automating with GitHub Actions","title":"Auditing Shiny apps","text":"Now, time integrate current pipeline CI/CD workflow. convenience, wrap previous steps single function: necessary GitHub Actions yaml file. Overall, : Run time code pushed GitHub. Run parallel 3 different Ubuntu flavors. Install R, system dependencies, R packages. Install shinycannon tools load-testing. Deploy load test report GitHub Pages. want test end, lines code setup RStudio project link GitHub: test locally within package, may want ignore public, recording.log adding .Rbuildignore file, avoid unnecessary warnings future devtools::check(): example available .  shown report, especially session duration tab, app clearly able handle 5 simultaneous user due large computations performed Shiny server: red area represented sessions, means many users wait significant amount time seeing app. critical issue, users leave app moment. blue area also large, showing time spent computations. Given single-threaded nature R, high chances users might blocked already ongoing computations. also frustrating, people may think app crashed. Even though vignette scope, one quick significant optimization set caching system shiny::bind_cache(). shown following figure, adding cache fast shinycannon able start 1000 sessions 2 minutes.","code":"## File: R/audit-app.R record_loadtest <- function(path, timeout = 15, workers = 5) {   message(\"\\n---- BEGIN LOAD-TEST ---- \\n\")   # start app + recorder   target <- start_r_bg(shiny_bg, path = path)   recorder <- start_r_bg(recorder_bg)    # start headless chrome (points to recorder!).   # AppDriver also support remote urls.   app <- shinytest2::AppDriver$new(     \"http://127.0.0.1:8600\",     load_timeout = timeout * 1000   )    app$set_inputs(mu = 4, timeout_ = timeout * 1000)    # clean   app$stop()   # needed to avoid   # java.lang.IllegalStateException: last event in log not a   # WS_CLOSE (did you close the tab after recording?)   Sys.sleep(2)    # shinycannon (maybe expose other params later ...)   target_url <- \"http://127.0.0.1:3515\"   system(     sprintf(       \"shinycannon recording.log %s --workers %s --loaded-duration-minutes 2 --output-dir run1\",       target_url, workers     )   )    target$kill()    # Treat data and generate report   df <- shinyloadtest::load_runs(\"run1\")   shinyloadtest::shinyloadtest_report(     df,     \"public/index.html\",     self_contained = TRUE,     open_browser = FALSE   ) } on:   push:     branches: [main, master]   pull_request:     branches: [main, master]  name: shiny-loadtest-ci  jobs:   shiny-loadtest-ci:     runs-on: ${{ matrix.config.os }}     permissions:       contents: write      name: ${{ matrix.config.os }} (${{ matrix.config.r }})      strategy:       fail-fast: false       matrix:         config:           - {os: ubuntu-latest,   r: 'devel', http-user-agent: 'release'}           - {os: ubuntu-latest,   r: 'release'}           - {os: ubuntu-latest,   r: 'oldrel-1'}      env:       GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}       R_KEEP_PKG_SOURCE: yes      steps:       - uses: actions/checkout@v2       - uses: r-lib/actions/setup-r@v2       - uses: r-lib/actions/setup-r-dependencies@v2         with:           cache-version: 2           extra-packages: |             any::shinyloadtest             any::lubridate             any::DT             any::callr             any::shinytest2             any::deSolve             any::attempt        - name: Install shinycannon ğŸ’¥         run: |           sudo bash -c 'apt-get update; apt-get install -y default-jre-headless; apt-get clean; rm -rf /var/lib/apt/lists/*'           wget https://github.com/rstudio/shinycannon/releases/download/v1.1.3/shinycannon_1.1.3-dd43f6b_amd64.deb           sudo dpkg -i ./*.deb        - name: Run load test ğŸ¥         shell: Rscript {0}         run: |             source(\"R/audit-app.R\")             record_loadtest(path = \"app.R\");        - name: Deploy to GitHub pages ğŸš€         if: github.event_name != 'pull_request'         uses: JamesIves/github-pages-deploy-action@4.1.4         with:           clean: false           branch: gh-pages           folder: public # Inside the project # Use audit GitHub Actions workflow usethis::use_github_action(url = \"https://raw.githubusercontent.com/rstudio/shinytest2/main/inst/gha/app-audit.yaml\") # Copy audit script dir.create(\"R\", showWarnings = FALSE) file.copy(system.file(\"gha/audit-app.R\", package = \"shinytest2\"), \"R/audit-app.R\") # Create your app.R file file.create(\"app.R\")  message(\"TODO: User - Copy in your app code to `app.R`!\")  # To test it locally source(\"R/audit-app.R\") record_loadtest(\"app.R\")  # Test the audit with GitHub Actions usethis::use_description() usethis::use_git() usethis::use_github() usethis::use_github_pages() usethis::use_build_ignore(c(\"public\", \"recording.log\"))"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Using shinytest2 with continuous integration","text":"overall procedure enabling tests CI platform : First create tests locally (development machine) save expected results. Commit expected results projectâ€™s git repository push GitHub. Create GitHub Actions workflow file run tests GitHub Actions (GHA). set continuous integration, typical development cycle : Modify project, commit, push changes. CI platform automatically action, downloads code runs tests. tests fail, send email alert. develop application, may also appropriate add, remove, modify tests, re-run tests save new expected results.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"a-repository-with-a-single-application","dir":"Articles","previous_headings":"","what":"A repository with a single application","title":"Using shinytest2 with continuous integration","text":"Shiny applications arenâ€™t part R package, two common ways repository set : repository contains one application, application files (like app.R global.R) contained top level repository. repository contains one application files, application contained subdirectory. section explains set GHA test repository single application. directory structure project look something like : files need add described .","code":"/ â”œâ”€â”€ .github â”‚   â””â”€â”€ workflows â”‚       â””â”€â”€ check-app.yaml â”œâ”€â”€ .Rprofile â”œâ”€â”€ README.md â”œâ”€â”€ app.R â”œâ”€â”€ renv/activate.R â”œâ”€â”€ renv.lock â””â”€â”€ tests     â”œâ”€â”€ testthat.R     â””â”€â”€ testthat         â”œâ”€â”€ _snaps         â”‚   â””â”€â”€ shinytest2         â”‚       â”œâ”€â”€ 001.json         â”‚       â”œâ”€â”€ 002.png         â”‚       â”œâ”€â”€ 003.json         â”‚       â””â”€â”€ 004.png         â””â”€â”€ test-shinytest2.R"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"check-app-yaml","dir":"Articles","previous_headings":"A repository with a single application","what":"check-app.yaml","title":"Using shinytest2 with continuous integration","text":"file contains information GitHub Actions build test application. can easily set action repo help usethis package: look similar : change os r version whatever operating system R version used platform application deployed .","code":"usethis::use_github_action(   url = \"https://github.com/rstudio/shinytest2/raw/main/actions/test-app/example-test-app-renv.yaml\",   save_as = \"check-app.yaml\" ) # Workflow derived from https://github.com/rstudio/shinytest2/tree/main/actions/test-app/example-test-app-description.yaml # Need help debugging build failures? Start at https://github.com/r-lib/actions#where-to-find-help on:   push:     branches: [main, master]   pull_request:     branches: [main, master]  name: Test app w/ {renv}  jobs:   test-app:     runs-on: ${{ matrix.config.os }}      name: ${{ matrix.config.os }} (${{ matrix.config.r }})      strategy:       fail-fast: false       matrix:         config:           - {os: ubuntu-latest, r: release}      env:       GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}       R_KEEP_PKG_SOURCE: yes      steps:       - uses: actions/checkout@v2        - uses: r-lib/actions/setup-pandoc@v2        - uses: r-lib/actions/setup-r@v2         with:           r-version: ${{ matrix.config.r }}           use-public-rspm: true        - uses: r-lib/actions/setup-renv@v2        - uses: rstudio/shinytest2/actions/test-app@actions/v1         with:           app-dir: \".\""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"renv-lock-renvactivate-r--rprofile","dir":"Articles","previous_headings":"A repository with a single application","what":"renv.lock, renv/activate.R, .Rprofile","title":"Using shinytest2 with continuous integration","text":"renv project-local dependency management system projects. useful Shiny applications using specific package versions Shiny app dependencies. renv uses mechanism used shinyapps.io RStudio Connect. renv auto-generates three files using isrenv::init() renv::snapshot(). create .Rprofile renv/activate.R, call renv::init() within App project. create / update renv.lock, call renv::snapshot(). Whenever update packages development machine, run renv::snapshot() command make sure packages used GitHub stay sync. learn renv, please see Introduction renv Collaborating renv articles. alternative using renv create DESCRIPTION file. lock package versions; instead, use latest version package CRAN.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"running-the-first-build","dir":"Articles","previous_headings":"A repository with a single application","what":"Running the first build","title":"Using shinytest2 with continuous integration","text":"â€™ve added files, commit push GitHub. trigger build GitHub Actions (GHA). first successful run workflow GHA generally take much longer subsequent runs, needs install R packages first time. successful run, packages cached, builds much faster.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"a-repository-with-multiple-applications","dir":"Articles","previous_headings":"","what":"A repository with multiple applications","title":"Using shinytest2 with continuous integration","text":"Another way run tests using repository multiple applications, subdirectory. directory structure look something like : repository structure, configuration largely repository single app, described . difference check-app.yaml file.","code":"/ â”œâ”€â”€ .github â”‚   â””â”€â”€ workflows â”‚       â””â”€â”€ check-app.yaml â”œâ”€â”€ .Rprofile â”œâ”€â”€ README.md â”œâ”€â”€ renv/activate.R â”œâ”€â”€ renv.lock â”œâ”€â”€ 01_hello â”‚   â”œâ”€â”€ app.R â”‚   â””â”€â”€ tests â”‚       â”œâ”€â”€ testthat.R â”‚       â””â”€â”€ testthat â”‚           â”œâ”€â”€ _snaps â”‚           â”‚   â””â”€â”€ shinytest2 â”‚           â”‚       â”œâ”€â”€ 001.json â”‚           â”‚       â”œâ”€â”€ 002.png â”‚           â”‚       â”œâ”€â”€ 003.json â”‚           â”‚       â””â”€â”€ 004.png â”‚           â””â”€â”€ test-shinytest2.R â””â”€â”€ 06_tabsets     â”œâ”€â”€ app.R     â””â”€â”€ tests         â”œâ”€â”€ testthat.R         â””â”€â”€ testthat             â”œâ”€â”€ _snaps             â”‚   â””â”€â”€ shinytest2             â”‚       â”œâ”€â”€ 001.json             â”‚       â”œâ”€â”€ 002.png             â”‚       â”œâ”€â”€ 003.json             â”‚       â”œâ”€â”€ 004.png             â”‚       â”œâ”€â”€ 005.json             â”‚       â””â”€â”€ 006.png             â””â”€â”€ test-shinytest2.R"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"check-app-yaml-1","dir":"Articles","previous_headings":"A repository with multiple applications","what":"check-app.yaml","title":"Using shinytest2 with continuous integration","text":"check-app.yaml App dir locations supplied app-dir using multiline yaml string syntax.","code":"- uses: rstudio/shinytest2/actions/test-app@actions/v1         with:           app-dir: |             01_hello             06_tabsets"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"testing-applications-in-a-package","dir":"Articles","previous_headings":"","what":"Testing applications in a package","title":"Using shinytest2 with continuous integration","text":"See Using shinytest2 R packages article.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"how-do-i-add-a-status-badge-to-my-project","dir":"Articles","previous_headings":"Frequently asked questions","what":"How do I add a status badge to my project?","title":"Using shinytest2 with continuous integration","text":"See GitHubâ€™s docs adding badge. workflow file named check-app.yaml schloerke/example-app repo, can add status badge GitHub README.md following line: README.md file, can add build status badge, like one , can see status code glance:","code":"![check-app](https://github.com/schloerke/example-app/actions/workflows/check-app.yml/badge.svg)"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"how-do-i-use-a-description-file-instead-of-renv","dir":"Articles","previous_headings":"Frequently asked questions","what":"How do I use a DESCRIPTION file instead of {renv}?","title":"Using shinytest2 with continuous integration","text":"Instead using renv, can use DESCRIPTION file can used tell GHA packages needed test application. Instead locking package specific version like renv, result latest version package downloaded CRAN. may appropriate want make sure application works latest version package, instead frozen set packages. use DESCRIPTION file, need modify check-app.yaml file use r-lib/actions default package installation system instead renv. Replace line template provided : want generate renv.lock, .Rprofile, renv files, run renv commands listed . Next, create DESCRIPTION file looks something like : Imports field must list R packages application directly uses. Normally latest versions listed packages installed CRAN. However, need install development versions packages GitHub, can done adding Remotes section. example: tells GitHub install shiny package main branch https://github.com/rstudio/shiny, shinytest2 package dev branch https://github.com/rstudio/shinytest2. addition branch names like dev, can use commit hashes tags.","code":"- uses: r-lib/actions/setup-renv@v2 - uses: r-lib/actions/setup-r-dependencies@v2 Imports:   shiny,   shinytest2 Remotes:   rstudio/shiny,   rstudio/shinytest2@dev"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"example-workflows","dir":"Articles","previous_headings":"","what":"Example workflows","title":"Using shinytest2 with continuous integration","text":"view example workflows description test-app GitHub Actions step, please see https://github.com/rstudio/shinytest2/tree/main/actions/test-app information examples.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"applications-in-inst","dir":"Articles","previous_headings":"","what":"Applications in inst/","title":"Using shinytest2 with R packages","text":"application live subdirectory inst/, shown : case, can run record_test() test_app() normal. create run tests, tests/ subdirectory application directory stores test scripts results. Since using testthat automated tests, create test driver script tests/testthat/. example, â€™s named test-inst-apps.R contains following: application directory meant public, can also located ./tests/testthat/apps. shinytest2 many application appdir point relative path application.","code":"/ â”œâ”€â”€ DESCRIPTION â”œâ”€â”€ NAMESPACE â”œâ”€â”€ R â”œâ”€â”€ inst â”‚   â””â”€â”€ sample_app â”‚       â”œâ”€â”€ app.R â”‚       â””â”€â”€ tests â”‚           â”œâ”€â”€ testthat â”‚           â”‚   â”œâ”€â”€ _snaps â”‚           â”‚   â”‚   â””â”€â”€ shinytest2 â”‚           â”‚   â”‚       â””â”€â”€ 001.json â”‚           â”‚   â””â”€â”€ test-shinytest2.R â”‚           â””â”€â”€ testthat.R â””â”€â”€ tests     â”œâ”€â”€ testthat     â”‚   â””â”€â”€ test-inst-apps.R     â””â”€â”€ testthat.R # File: tests/testthat/test-inst-apps.R library(shinytest2)  test_that(\"sample_app works\", {   # Don't run these tests on the CRAN build servers   skip_on_cran()    appdir <- system.file(package = \"exPackage\", \"sample_app\")   test_app(appdir) })"},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"application-objects-created-by-functions","dir":"Articles","previous_headings":"","what":"Application objects created by functions","title":"Using shinytest2 with R packages","text":"second way application R package function returns Shiny application object. example, â€™s function hello_world_app(), lives R/hello-world.R: function simply returns object shinyApp(): object, can supplied directly AppDriver$new(). help create tests, can call record_test() shiny application object directly. Unfortunately, test file able saved. Instead, test commands can copied test script manually.","code":"/ â”œâ”€â”€ .Rbuildignore â”œâ”€â”€ DESCRIPTION â”œâ”€â”€ NAMESPACE â”œâ”€â”€ R â”‚   â””â”€â”€ hello-world.R â””â”€â”€ tests     â”œâ”€â”€ testthat     â”‚   â”œâ”€â”€ _snaps     â”‚   â”‚   â””â”€â”€ app-function     â”‚   â”‚       â””â”€â”€ 001.json     â”‚   â””â”€â”€ test-app-function.R     â””â”€â”€ testthat.R # File: R/hello-world.R  hello_world_app <- function() {   utils::data(cars)   shinyApp(     ui = fluidPage(       sliderInput(\"n\", \"n\", 1, nrow(cars), 10),       plotOutput(\"plot\")     ),     server = function(input, output) {       output$plot <- renderPlot({         plot(           head(cars, input$n),           xlim = range(cars[[1]]),           ylim = range(cars[[2]])         )       })     }   ) } # File: tests/testthat/test-app-function.R  test_that(\"hello-world app initial values are consistent\", {   # Don't run these tests on the CRAN build servers   skip_on_cran()    shiny_app <- hello_world_app()   app <- AppDriver$new(shiny_app, name = \"hello\")    app$expect_values() })"},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"other-setup-steps","dir":"Articles","previous_headings":"","what":"Other setup steps","title":"Using shinytest2 with R packages","text":"steps needed types tests. recommended call shinytest2::use_shinytest2() enable different test config set-ups. need add shinytest2 Suggests section DESCRIPTION file. items place, can test package using devtools::install(); testthat::test_local() running R CMD check package. using RStudio IDE, can also run Build -> Test Package Build -> Check Package. shinytest2 requires package installed testing. testthat::test_local() (related wrappers) eventually call pkgload::load_all() temporarily source local R package. can use test_local() test non-shinytest2 tests, need install R package safely execute shinytest2 tests. installed, create confusing situation shinytest2 tests running different version R package (whichever last installed), rest tests (current source).","code":"Suggests:     shinytest2"},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"how-should-i-test-multiple-applications","dir":"Articles","previous_headings":"","what":"How should I test multiple applications?","title":"Using shinytest2 with R packages","text":"can call shinytest2::test_app() multiple times within test script. need wrapped within testthat::test_that() call. shinytest2 tests many internal apps using code similar code :","code":"# ./tests/testthat/test-apps.R  app_dirs <- fs::dir_ls(testthat::test_path(\"apps\")) lapply(app_dirs, function(app_dir) {   shinytest2::test_app(app_dir) })"},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"continuous-integration","dir":"Articles","previous_headings":"","what":"Continuous integration","title":"Using shinytest2 with R packages","text":"like package tested every commit, can set GitHub Actions. Please see Using shinytest2 continuous integration inspiration.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"monkey-headless-testing-with-shinytest2","dir":"Articles","previous_headings":"","what":"Monkey (headless) testing with {shinytest2}","title":"Monkey testing","text":"people use shinytest2 plug play record_test() app, convenient familiar JavaScript. hood, record_test() generates R script composed series directed instructions manipulates app automate testing CI/CD environments. Monkey testing, type testing random inputs used test behavior app, widely used web developers check application robustness, particularly apps large number inputs. goal ultimately try break app triggering unexpected combinations. available libraries JS-based gremlins.js, traditionally combined JS-based global testing libraries like Puppeteer, can work shinytest2 well. vignette â€™ll provide thorough overview AppDriver R6 class (extending concepts covered Testing depth article), allows developer programmatically control app. â€™ll see can seamlessly benefit gremlins.js lines code.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"initialize-the-driver","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2}","what":"Initialize the driver","title":"Monkey testing","text":"consider simple app composed slider plot output: driver may initialized : Note shiny_args slot allowing pass custom options shiny::runApp() port, might useful organization restricts port number. load_timeout defaults 10s 20s locally CI/CD, respectively. Therefore, app takes longer launch, can change value. Keep mind app taking 20s launch generally -optimized require specific care profiling refactoring. AppDriver starts Chrome-based headless browser. need specific flags available default shinytest2, can pass instantiating driver: flags considered default, particularly ---sandbox, applied CI/CD, Chrome wonâ€™t start without . run script locally, may add view = TRUE open Chrome Devtools, significantly ease testing calibration. highly recommend creating test protocol locally moving CI/CD later bugs fixed. figure, application shown left side panel. top-right side panel shows DOM elements (default) bottom-right side panel displays JavaScript console output.","code":"ui <- fluidPage(   sliderInput(\"obs\", \"Number of observations:\",     min = 0, max = 1000, value = 500   ),   plotOutput(\"distPlot\") )  # Server logic server <- function(input, output) {   output$distPlot <- renderPlot({     hist(rnorm(input$obs))   }) }  # Complete app with UI and server components shinyApp(ui, server) headless_app <- AppDriver$new(   app_dir = \"<PATH_TO_APP>\",   name = \"monkey-test\",   shiny_args = list(port = 3515) ) chromote::set_chrome_args(   c(     chromote::default_chrome_args(),     # Custom flags: see https://peter.sh/experiments/chromium-command-line-switches/   ) )"},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"injecting-gremlins-js","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2}","what":"Injecting gremlins.js","title":"Monkey testing","text":"next steps consist injecting gremlins.js dependency DOM can unleash horde.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"easy-way","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Injecting gremlins.js","what":"Easy way","title":"Monkey testing","text":"easiest way inject gremlins.js call: creates <script> tag pointing correct Content Delivery Network (CDN), optimized server store libraries, inserts end body. test whether everything worked well, can dump DOM look scripts. can find gremlins.js calling typeof window.gremlins, returns object: may instead see undefined returned. generally JS code blocked network. case, consider injecting gremlins.js locally, explained next section.","code":"headless_app$run_js(\"   let s = document.createElement('script');   s.src = 'https://unpkg.com/gremlins.js';   document.body.appendChild(s); \") headless_app$get_html(\"script\", outer_html = TRUE) headless_app$get_js(\"typeof window.gremlins\")"},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"local-way","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Injecting gremlins.js","what":"Local way","title":"Monkey testing","text":"can store serve local copy gremlins.js script shiny::addResourcePath(), assuming gremlins.js inst/js/gremlins.min.js. can accomplish adding following code app.R file: can subsequently inject gremlins DOM check whether everything worked expected:","code":"shiny::addResourcePath(\"gremlins\", \"inst/js/gremlins.min.js\") headless_app$run_js(\"   let s = document.createElement('script');   s.src = './gremlins/gremlins.min.js';   document.body.appendChild(s); \") headless_app$get_html(\"script\", outer_html = TRUE) headless_app$get_js(\"typeof window.gremlins\")"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"a-bit-about-gremlins-js","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Unleash the horde","what":"A bit about gremlins.js","title":"Monkey testing","text":"workflow rather simple: create horde gremlins.createHorde(). run monkey test horde.unleash();. createHorde() accepts many species gremlins capable handling various events clicks, touch, form filling, scrolling, typing, , described gremlins.js documentation. donâ€™t recommend using scroller, sometimes crashes Chrome instance. plots rely random elements, rnorm, best practice set seed using set.seed(). default, species attack random order delay 10 ms event. can also control attack strategy fine tune global behavior. want control gremlins species , can define custom species.","code":"const horde = gremlins.createHorde(); horde.unleash();"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"blind-run","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Unleash the horde > Practice","what":"Blind run","title":"Monkey testing","text":"following, run basic monkey test configuration: result shown GIF :","code":"headless_app$run_js(\"gremlins.createHorde().unleash();\")"},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"optimized-testing","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Unleash the horde > Practice","what":"Optimized testing","title":"Monkey testing","text":"really makes sense invoke species given slider? Absolutely ! can use following code test slider input.  best species perform task toucher, able randomly move slider input. documentation specifies many events tap, doubletap, gesture multi-touch. seems relevant apply gesture, consisting dragging slider x-axis (note: gesture also considers y-axis, make sense slider. gremlins.js limitation, wonâ€™t prevent test running). target slider handle class, irs-handle single, ensure donâ€™t touch element. also increase number maximum touches 2 200. Note HTML inspector, allows us seamlessly inspect extract class id. log parameter enables logging JavaScript console: can create custom horde disable FPS Alert mogwais gremlins since relevant case study: unleash promise, can execute function right , order check whether script ran expected. running CI/CD canâ€™t see Chrome Devtools, can still display logs. console.log output captured shinytest2 logs headless_app$get_logs() allowing debug refine monkey testing script.  monkey testing lasts 10s, often want take screenshot ongoing attack:  run multiple attacks, always good practice reset Shiny inputs attacks, even close current headless app restart new session: run CI/CD, donâ€™t forget clean session tests completed, particularly set shiny.port option, canâ€™t 2 apps running port:","code":"const customToucher = gremlins.species.toucher({   // which touch event types will be triggered   touchTypes: ['gesture'],   // Touch only if element has class irs-handle single   canTouch: (element) => element.className === 'irs-handle single',   log: true,   maxTouches: 200 }); const horde = gremlins.createHorde({   species: [customToucher],   mogwais: [gremlins.mogwais.gizmo()] }); horde   .unleash()   .then(() => {     console.log('Gremlins test success') }); headless_app$run_js(\"   const customToucher = gremlins.species.toucher({     // which touch event types will be triggered     touchTypes: ['gesture'],     // Touch only if element has class irs-handle single     canTouch: (element) => element.className === 'irs-handle single',     log: true,     maxTouches: 200   });    gremlins.createHorde({     //randomizer: new gremlins.Chance(1234), // repeatable     species: [customToucher],     mogwais: [gremlins.mogwais.gizmo()]   }).unleash().then(() => {     console.log('Gremlins test success')   }); \")  Sys.sleep(3) headless_app$get_screenshot(\"gremlins.png\") headless_app$set_inputs(obs = 500) headless_app$stop()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"code-structure","dir":"Articles","previous_headings":"","what":"Code structure","title":"Migrating from shinytest","text":"sub sections , ShinyDriver reference shinytest::ShinyDriver R6 object. code block, ShinyDriver object referred old. Similarly, AppDriver reference shinytest2::AppDriver R6 object. shinytest2::AppDriver replaced shinytestâ€™s ShinyDriver object referred new code block.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverclick","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$click()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$click(name, iotype = c(\"auto\", \"input\", \"output\")) parameters separated clearer intended use AppDriver$click(input, output, ..., selector).","code":"## {shinytest} old$click(\"mybutton\") old$click(\"clickcount\", iotype = \"output\") old$click(\"my_id\", iotype = \"auto\")  ## {shinytest2} new$click(\"mybutton\"); new$click(input = \"mybutton\") new$click(output = \"clickcount\") new$click(selector = \"#my_id\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverexecutescript","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$executeScript()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$executeScript(script, ...) ... must now inserted script. can commands like glue::glue() paste(). Extra parameters include file, can contain script content, timeout, throw error timeout (milliseconds) reached script returns. promise last value script resolved value sent back R session.","code":"## {shinytest} life <- 42 old$executeScript(\"1 + 1;\") old$executeScript(\"var life = arguments[0]; life;\", life)  ## {shinytest2} life <- 42 new$get_js(\"1 + 1;\") new$get_js(paste0(\"let life = \", jsonlite::toJSON(life, auto_unbox = TRUE), \"; life;\")) # If a promise is returned, the resolved value will be sent back to the R session new$get_js(   paset0(\"   let life = \", jsonlite::toJSON(life, auto_unbox = TRUE), \";   new Promise((resolve, reject) => resolve(life));   \") )"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverexecutescriptasync","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$executeScriptAsync()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$executeScriptAsync(script, ...) ShinyDriver$executeScriptAsync() magically made callback argument available JavaScript code block R session callback called within script. shinytest2 script need updated use JavaScript Promise. Promiseâ€™s resolve method callback used previously. also provide maximum timeout (milliseconds) willing wait error thrown. example:","code":"## {shinytest} # Wait until a button is clicked old$executeScriptAsync(   '   var selector = arguments[0];   var callback = arguments[1];   $( selector ).one( \"click\", function() {     callback();   });   ',   \"#mybutton\" )  ## {shinytest2} # Wait until a button is clicked new$get_js(   paste0(\"   let selector = \", jsonlite::toJSON(\"#mybutton\", auto_unbox = TRUE), \";   new Promise((resolve, reject) => {     $( selector ).one( \\\"click\\\", function() {       resolve();     });   });   \"),   timeout = 15 * 1000 )"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetallvalues","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$getAllValues()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$getAllValues(input = TRUE, output = TRUE, export = TRUE) method renamed AppDriver$get_values(..., input, output, export, hash_images = TRUE). new method slightly different behavior input, output export arguments provided. input, output export provided, method return values provided input, output export names . input, output export provided, method return values, similar setting ShinyDriver$getAllValues(input = TRUE, output = TRUE, export = TRUE).","code":"## {shinytest} old$getAllValues() # All input values old$getAllValues(input = TRUE, output = FALSE, export = FALSE) # Only `clickcount` output value old$getAllValues(input = FALSE, output = \"clickcount\", export = FALSE)  ## {shinytest2} new$get_values() # All input values new$get_values(input = TRUE) # Only `clickcount` output value new$get_values(output = \"clickcount\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetvalue","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$getValue()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$getValue(name, iotype = c(\"auto\", \"input\", \"output\")) method renamed AppDriver$get_value(..., input, output, export) parameters spread input output, adding support export.","code":"## {shinytest} old$getValue(\"myinput\")  ## {shinytest2} new$get_value(input = \"myinput\") # Equivalent to new$get_values(input = \"myinput\")$input$myinput"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergeturl","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$getUrl()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$getUrl() method renamed AppDriver$get_url().","code":"## {shinytest} old$getUrl()  ## {shinytest2} new$get_url()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriversetinputs","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$setInputs()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$setInputs(..., wait_ = TRUE, values_ = TRUE, timeout_ = 3 * 1000, allowInputNoBinding_ = FALSE, priority_ = c(\"input\", \"event\")) method name renamed AppDriver$get_values() parameters converted snake_case. value_ support removed, functionality can achieved via call AppDriver$get_values() call AppDriver$set_inputs().","code":"## {shinytest} getValuesResult <- old$setInputs(life = 42)  ## {shinytest2} new$set_inputs(life = 42) get_values_result <- new$get_values()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetwindowsize-shinydriversetwindowsize","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$getWindowSize(), ShinyDriver$setWindowSize()","title":"Migrating from shinytest","text":"Signatures: * ShinyDriver$getWindowSize() * ShinyDriver$setWindowSize(width, height) methods renamed AppDriver$get_window_size() AppDriver$set_window_size(width, height) respectively.","code":"## {shinytest} old$getWindowSize() old$setWindowSize(width = 1024, height = 768)  ## {shinytest2} new$get_window_size() new$set_window_size(width = 1024, height = 768)"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivercheckuniquewidgetnames","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$checkUniqueWidgetNames()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$checkUniqueWidgetNames() method checks make sure input output names unique. still run initialization via AppDriver$new(check_names = TRUE), issues found startup, warnings displayed. exported method upgraded expectation version renamed AppDriver$expect_unique_names().","code":"## {shinytest} old$checkUniqueWidgetNames()  ## {shinytest2} new$expect_unique_names()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"snapshots","dir":"Articles","previous_headings":"Code structure","what":"Snapshots","title":"Migrating from shinytest","text":"Snapshots now handled testthat. leverage capability, use AppDriver$expect_*() methods assert value consistent many testing executions.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriversnapshotinit","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$snapshotInit()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$snapshotInit(path, screenshot = TRUE) method moved parameters: AppDriver$new(name = path). Screenshots via testthat snapshots allowed AppDriver$new(variant=) value provided. variant similar suffix value shinytest::testApp(suffix=).","code":"## {shinytest} old$snapshotInit(\"mytest\")  ## {shinytest2} new <- AppDriver$new(name = \"mytest\", variant = NULL) # Suggested new <- AppDriver$new(name = \"mytest\", variant = platform_variant())"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriversnapshot","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$snapshot()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$snapshot(items = NULL, filename = NULL, screenshot = NULL) shinytest method expect screenshot expect values consistent. method longer exists shinytest2, broken two methods must called independently: AppDriver$expect_screenshot() AppDriver$expect_values(). AppDriver$expect_values() (default) take debug screenshot never fail expectation. allows historical record (version control) app looked like constantly battle false-positive screenshot failures. single output value supplied AppDriver$expect_values(), debug screenshot zoomed output value.","code":"## {shinytest} old$snapshot() old$snapshot(items = list(output = \"clickcount\"))  ## {shinytest2} # Must supply `variant=` to be able to call `AppDriver$expect_screenshot()`, even if it is `NULL` new <- AppDriver$new(path_to_app, variant = NULL) new$expect_screenshot(); new$expect_values() new$expect_screenshot(); new$expect_values(output = \"clickcount\")  # Suggested; new <- AppDriver$new(path_to_app) new$expect_values()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivertakescreenshot","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$takeScreenshot()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$takeScreenshot(file = NULL, id = NULL, parent = FALSE) method renamed AppDriver$get_screenshot(file), id parent parameters removed. use selector, set AppDriver$get_screenshot(myfile, selector = \".custom-selector\") screenshot_args directly.","code":"## {shinytest} old$takeScreenshot(\"myfile1.png\") old$takeScreenshot(\"myfile2.png\", id = \"myid\")  ## {shinytest2} new$get_screenshot(\"myfile1.png\") new$get_screenshot(\"myfile2.png\", selector = \"#myid\") new$get_screenshot(\"myfile2.png\", screenshot_args = list(selector = \"#myid\"))"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriversnapshotdownload","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$snapshotDownload()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$snapshotDownload(id, filename) method renamed AppDriver$expect_download(id, filename).","code":"## {shinytest} old$snapshotDownload(\"mylinkid\")  ## {shinytest2} new$expect_download(\"mylinkid\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverstop","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$stop()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$stop() method stayed ! ğŸ¥³ shinytest2, also stop [ChromeSession] instance clean temporary Shiny log files.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriveruploadfile","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$uploadFile()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$uploadFile(..., wait_ = TRUE, values_ = TRUE, timeout_ = 3 * 1000) method renamed AppDriver$upload_file(...), similar AppDriver$set_inputs(), support ShinyDriver$uploadFile(values_ =) removed.","code":"## {shinytest} old$uploadFile(myFileInput = \"myfile.txt\")  ## {shinytest2} new$upload_file(myFileInput = \"myfile.txt\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverwaitfor","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$waitFor()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$waitFor(expr, checkInterval = 100, timeout = 3000) method renamed parameters reordered AppDriver$wait_for_js(script, timeout, interval). Like JavaScript methods shinytest2, script needs explicitly return value.","code":"## {shinytest} old$waitFor(\"$('#myid').length > 0\")  ## {shinytest2} new$wait_for_js(\"$('#myid').length > 0\");"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverwaitforshiny","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$waitForShiny()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$waitForShiny() method upgraded AppDriver$wait_for_idle(duration = 500, timeout = 30 * 1000). ShinyDriver$waitForShiny() method waited single instance time stated Shiny longer busy. new method wait Shiny â€œidleâ€ continuous stretch time. useful wait Shiny idle set duration order avoid situations dynamic UI needs calculate new outputs given new input information.","code":"## {shinytest} old$waitForShiny()  ## {shinytest2} # Equivalent new$wait_for_idle(duration = 0, timeout = 3 * 1000) # Suggested (Shiny must become continuously idle for at least 500ms within 30s new$wait_for_idle()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverwaitforvalue","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$waitForValue()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$waitForValue(name, ignore = list(NULL, \"\"), iotype = c(\"input\", \"output\", \"export\"), timeout = 10000, checkInterval = 400): (underutilized) method name/iotype spread separate input, output, export parameters. one input/output/export value may supplied AppDriver object. timeout increased 15 seconds. methods still poll Shiny application set interval corresponding value something ignored set values.","code":"## {shinytest} old$waitForValue(\"myslider\") old$waitForValue(\"mydynamicplot\", iotype = \"output\")  ## {shinytest2} new$wait_for_value(\"myslider\"); new$wait_for_value(input = \"myslider\") new$wait_for_value(output = \"mydynamicplot\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"elements-widgets","dir":"Articles","previous_headings":"Code structure","what":"Elements / Widgets","title":"Migrating from shinytest","text":"Direct element Widget support shinytest2 drastically reduced. ability execute JavaScript function via $get_js(script) $run_js(script), now possible reproduce many methods provided shinytest.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverfindelement-shinydriverfindelements-shinydriverfindwidget","dir":"Articles","previous_headings":"Code structure > Elements / Widgets","what":"ShinyDriver$findElement(), ShinyDriver$findElements(), ShinyDriver$findWidget()","title":"Migrating from shinytest","text":"Signatures: * ShinyDriver$findElement(css = NULL, linkText = NULL, partialLinkText = NULL, xpath = NULL) * ShinyDriver$findElements(css = NULL, linkText = NULL, partialLinkText = NULL, xpath = NULL) * ShinyDriver$findWidget(name, iotype = c(\"auto\", \"input\", \"output\")) methods removed. suggested use JavaScript code directly use newer helper methods.","code":"## {shinytest} old$findElement(\"#mybutton\")$click() old$findElement(\"#mybutton\")$getText() old$findElement(\"#mybutton\")$getCssValue(\"color\")  ## {shinytest2} new$get_text(selector = \"#mybutton\") new$click(selector = \"#mybutton\") # No direct equivalent method. Using JavaScript instead new$get_js('$(\"#mybutton\").css(\"color\")')"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetsource-shinydrivergettitle","dir":"Articles","previous_headings":"Code structure > Elements / Widgets","what":"ShinyDriver$getSource(), ShinyDriver$getTitle()","title":"Migrating from shinytest","text":"Signatures: * ShinyDriver$getSource() * ShinyDriver$getTitle() methods removed. suggested use JavaScript code directly, use newer helper methods.","code":"## {shinytest} old$getSource() old$getTitle()  ## {shinytest2} new$get_html(\"html\", outer_html = TRUE) new$get_js(\"window.document.title;\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"testing-setup","dir":"Articles","previous_headings":"Code structure","what":"Testing setup","title":"Migrating from shinytest","text":"shinytest2 heavily integrated testthat testing framework. Similar shinytest, snapshots recorded, recorded via testthat snapshots. information robustness different testing approaches, please see Robust testing vignette. ShinyDriver$new(suffix=): Please use AppDriver$new(variant=).","code":"## {shinytest} old <- ShinyDriver$new(path_to_app, suffix = \"macos-4.1\")  ## {shinytest2} new <- AppDriver$new(path_to_app, variant = \"macos-4.1\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetrelativepathtoapp-shinydrivergettestsdir","dir":"Articles","previous_headings":"Code structure > Testing setup","what":"ShinyDriver$getRelativePathToApp(), ShinyDriver$getTestsDir()","title":"Migrating from shinytest","text":"Signatures: * ShinyDriver$getRelativePathToApp() * ShinyDriver$getTestsDir() methods removed longer needed given execution shinytest2 testing always done within testthat testing framework.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetsnapshotdir","dir":"Articles","previous_headings":"Code structure > Testing setup","what":"ShinyDriver$getSnapshotDir()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$getSnapshotDir() method removed testthat uses ./_snaps directory store snapshot outputs.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverexpectupdate","dir":"Articles","previous_headings":"Code structure > Testing setup","what":"ShinyDriver$expectUpdate()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$expectUpdate(output, ..., timeout = 3000, iotype = c(\"auto\", \"input\", \"output\")) method longer supported. knowing output value updated, uncertain new value . possibly useful, robust therefore recommended. testing methods explored. Equivalent code provided legacy support.","code":"## {shinytest} old$expectUpdate(\"myoutput\", myinput = 42)  ## {shinytest2} (equivalent code) myoutput_prior <- new$get_values(output = \"myoutput\") new$set_inputs(myinput = 42) testthat::expect_failure(   testthat::expect_equal(     new$get_values(output = \"myoutput\"),     myoutput_prior   ) )"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"debugging","dir":"Articles","previous_headings":"Code structure","what":"Debugging","title":"Migrating from shinytest","text":"Debugging shinytest2 unified enabled times. shinytest debugging methods removed favor AppDriver$get_logs(), returns similarly shaped tibble ShinyDriver$getDebugLog()â€™s data.frame. columns altered generic, type broken two columns: location level. ShinyDriver$getDebugLog(), ShinyDriver$getEventLog(): Now use AppDriver$get_logs(). ShinyDriver$logEvent(event, ...): Messages can still recorded using AppDriver$log_message(text), ... values longer supported. ShinyDriver$enableDebugLogMessages(enable = TRUE): longer used. messages always recorded. options = list(shiny.trace = TRUE) set initializing AppDriver object, WebSocket traffic recorded.","code":"## {shinytest} old$getDebugLog(); old$getEventLog() old$logEvent(\"Creating report\")  ## {shinytest2} new$get_logs() old$log_message(\"Creating report\") ## {shinytest2} # Record all websocket traffic. Caution!! This is very verbose!! new <- AppDriver$new(path_to_app, options = list(shiny.trace = TRUE)) new$get_logs()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"other-removed-methods","dir":"Articles","previous_headings":"Code structure","what":"Other removed methods","title":"Migrating from shinytest","text":"ShinyDriver$setValue(name, value, iotype): set output value, must performed setting input value render methods set output value. set input value, use AppDriver$set_inputs(). ShinyDriver$listWidgets(): method removed can achieved getting names existing values: AppDriver$get_values(). ShinyDriver$clone(): AppDriver support cloning. (underlying ChromoteSession support cloning, AppDriver support cloning.) ShinyDriver$goBack(), ShinyDriver$refresh(): methods removed, can achieved AppDriver$run_js(script). ShinyDriver$getAppDir(), ShinyDriver$getAppFilename(), ShinyDriver$isRmd(): AppDriver$get_dir() method still supported given AppDriver$new(app_dir=) single directory path. methods removed functionality make sense within shinytest2. ShinyDriver$sendKeys(name, keys): method removed currently easy alternative. familiar key code values, can trigger jQuery AppDriver$run_js(script).","code":"## {shinytest} old$setValue(\"myinput\", 42)  ## {shinytest2} new$set_inputs(myinput = 42) ## {shinytest} old$listWidgets()  ## {shinytest2} lapply(new$get_values(), names) ## {shinytest} old$goBack() old$refresh()  ## {shinytest2} # Go back new$run_js(\"window.history.back();\") # Refresh page new$run_js(\"window.location.reload();\") ## {shinytest} old$isRmd() old$getAppDir() old$getAppFilename()  ## {shinytest2} app_dir <- new$get_dir() rmd_files <- fs::dir_ls(new$get_dir(), regexp = \"\\\\.[Rr]md$\") is_rmd <- length(rmd_files) >= 1 app_filename <- if (has_rmd) fs::path_file(rmd_files[1]) else NULL ## {shinytest} old$sendKeys(\"myinput\", webdriver::keys$enter)  ## {shinytest2} new$run_js(\"$('#myinput').trigger({type: 'keypress', which: 13, keyCode: 13});\")"},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"what-does-it-mean-when-i-run-test_app-and-it-says-server-did-not-update-any-output-values-within-3-seconds","dir":"Articles","previous_headings":"","what":"What does it mean when I run test_app() and it says, â€œServer did not update any output values within 3 secondsâ€?","title":"Frequently Asked Questions","text":"full message : happens setting input value result output changing. shinytest2 normally assumes call app$set_inputs(), setting input also result changed output, test driver process wait output change moving next step test script. outputs change within timeout period (defaults 3 seconds), prints message. , application, expect setting particular input immediately result output changes, call app$set_inputs() wait_=FALSE. hand, expect setting input result output change, time exceeds timeout, can call app$set_inputs() , example, timeout_ = 10 * 1000.","code":"Server did not update any output values within 3 seconds. If this is expected, use `wait_ = FALSE` or increase the value of `timeout_`."},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"some-input-values-are-not-set-right-after-calling-appset_inputs--how-do-i-wait-for-them","dir":"Articles","previous_headings":"","what":"Some input values are not set right after calling app$set_inputs(). How do I wait for them?","title":"Frequently Asked Questions","text":"situations, input value set, shinytest2 wait next value sent server. (See question section Testing depth. However, dealing dynamic UI inputs, htmlwidgets, even selectize inputs, input values set first output change. Use app$wait_for_value(input = NAME, ignore = list(VALUE_1, ...., VALUE_N)) wait particular input (output) value available (non-invalid value).","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"how-can-my-app-detect-if-its-running-in-shinytest2","dir":"Articles","previous_headings":"","what":"How can my app detect if itâ€™s running in {shinytest2}?","title":"Frequently Asked Questions","text":"Sometimes can useful alter behavior application â€™s tested. detect â€™s tested, can use isTRUE(getOption(\"shiny.testmode\")), :","code":"if (isTRUE(getOption(\"shiny.testmode\"))) {    # Do something special here }"},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"how-can-i-get-the-objects-from-files-in-my-the-r-folder-into-the-testing-environment","dir":"Articles","previous_headings":"","what":"How can I get the objects from files in my the R folder into the testing environment?","title":"Frequently Asked Questions","text":"Loading support environment Shiny application requires call shinytest2::load_app_env() ./tests/testthat/setup-shinytest2.R. method load global.R R files testing environment, similar testing package R code. automatically performed may costly load support environment.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"can-i-modify-the-input-and-output-values-that-are-recorded-in-snapshots","dir":"Articles","previous_headings":"","what":"Can I modify the input and output values that are recorded in snapshots?","title":"Frequently Asked Questions","text":"kinds outputs, problematic record raw value directly JSON snapshot. output might large (e.g., image data large table), may contain randomly-generated values specific value unimportant testing (randomly-generated DOM element IDs). situations, can use output preprocessor function. commonly done author component used application, although can also done application author. output preprocessor function passed object representing output value, return value. problem value large, preprocessor function can modify value hashing returning hash. problem value contains random values, preprocessor function can replace random values fixed ones. add output preprocessor, use shiny::snapshotPreprocessOutput() modify output renderer. example, see section renderDataTable() function. takes object returned renderDataTable(), modifies adding output preprocessor removes strings contain random values. outputs (notably htmlwidgets), output value text string containing JSON, want modify JSON, either (1) text processing JSON, (2) convert JSON R object, modify R object, convert R object back JSON. plotly R package uses method renderPlotly(). examples modify output renderer inside output renderer function, done author component. also possible application author modify renderer something like following: output JSON snapshot : (example just illustration purposes. Note example, screenshots still change time test run, better solutions, like setting random seed.) Input values can face issues, can also modified shiny::snapshotPreprocessInput().","code":"shinyApp(   ui = fluidPage(     verbatimTextOutput(\"random\")   ),   server = function(input, output, session) {     output$random <- snapshotPreprocessOutput(       renderText({         paste(\"This is a random number:\", rnorm(1))       }),       function(value) {         sub(\"[0-9.]+$\", \"<a random number>\", value)       }     )   } ) \"output\": {     \"random\": \"This is a random number: <a random number>\"   }"},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"should-i-manually-shut-down-my-appdriver","dir":"Articles","previous_headings":"","what":"Should I manually shut down my AppDriver?","title":"Frequently Asked Questions","text":"code completeness, call app$stop() end tests shut background Shiny process current Chromote Session. R session starting feel sluggish, may want call app$stop() manually. programmatically creating many instances AppDriver, may want call app$stop() specific test complete via withr::defer(app$stop()) right initialization.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"how-can-i-open-the-test-to-see-if-bookmarks-are-working","dir":"Articles","previous_headings":"","what":"How can I open the test to see if bookmarks are working?","title":"Frequently Asked Questions","text":"Testing Shiny bookmarks requires browser loaded specific query parameters. Luckily, can use shinytest2 help achieve running local AppDriver another AppDriver uses url specific query parameters! (Original code, Working example) File: tests/testthat//test-bookmark.R File: tests/testthat/_snaps/bookmark/001.json","code":"test_that(\"Bookmark works\", {   # Start local app in the background in test mode   bg_app <- shinytest2::AppDriver$new(\"path/to/shiny/app\")   # Capture the background app's URL and add appropriate query parameters   bookmark_url <- paste0(bg_app$get_url(), \"?_inputs_&n=10\")   # Open the bookmark URL in a new AppDriver object   app <- shinytest2::AppDriver$new(bookmark_url)    # Run your tests on the bookmarked `app`   app$expect_values() }) {   \"input\": {     \"._bookmark_\": 0,     \"caps\": true,     \"txt\": \"abcd\"   },   \"output\": {     \"out\": \"ABCD\"   },   \"export\": {   } }"},{"path":"https://rstudio.github.io/shinytest2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Barret Schloerke. Maintainer, author. Posit Software, PBC. Copyright holder, funder. Winston Chang. Contributor.           Original author rstudio/shinytest GÃ¡bor CsÃ¡rdi. Contributor.           Original author rstudio/shinytest Hadley Wickham. Contributor.           Original author rstudio/shinytest Mango Solutions. Copyright holder, conceptor.           Original author rstudio/shinytest","code":""},{"path":"https://rstudio.github.io/shinytest2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Schloerke B (2025). shinytest2: Testing Shiny Applications. R package version 0.4.1, https://rstudio.github.io/shinytest2/.","code":"@Manual{,   title = {shinytest2: Testing for Shiny Applications},   author = {Barret Schloerke},   year = {2025},   note = {R package version 0.4.1},   url = {https://rstudio.github.io/shinytest2/}, }"},{"path":"https://rstudio.github.io/shinytest2/index.html","id":"shinytest2-","dir":"","previous_headings":"","what":"Testing for Shiny Applications","title":"Testing for Shiny Applications","text":"Manually testing Shiny applications often laborious, inconsistent, doesnâ€™t scale well. Whether developing new features, fixing bug(s), simply upgrading dependencies serious app mistakes real consequences, critical know regressions introduced. shinytest2 provides streamlined toolkit unit testing Shiny applications seamlessly integrates popular testthat framework unit testing R code. shinytest2 uses chromote render applications headless Chrome browser. chromote allows live preview, better debugging tools, /simply using modern JavaScript/CSS. simply recording actions code extending test particular aspects application, result fewer bugs confidence future Shiny application development.","code":""},{"path":"https://rstudio.github.io/shinytest2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Testing for Shiny Applications","text":"","code":"# Install the released version from CRAN install.packages(\"shinytest2\")  # Or the development version from GitHub: # install.packages(\"devtools\") devtools::install_github(\"rstudio/shinytest2\")"},{"path":"https://rstudio.github.io/shinytest2/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Testing for Shiny Applications","text":"easiest way get started calling shinytest2::record_test() app directory. open Shiny application record actions code. programmatically create test, call shinytest2::use_shinytest2_test(). Call shinytest2::use_shinytest2() create initial value test file set infrastructure may need. Please check Getting Started article example usage.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":null,"dir":"Reference","previous_headings":"","what":"Drive a Shiny application â€” AppDriver","title":"Drive a Shiny application â€” AppDriver","text":"class starts Shiny app new R session, along chromote's headless browser can used simulate user actions. provides full simulation Shiny app can test user interactions live app. Methods described ordered perceived popularity. Expect methods grouped next corresponding get methods.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"vignettes","dir":"Reference","previous_headings":"","what":"Vignettes","title":"Drive a Shiny application â€” AppDriver","text":"Please see Testing depth details different expectation methods. Please see Robust testing details cost / benefits expectation method.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"test-mode","dir":"Reference","previous_headings":"","what":"Test mode","title":"Drive a Shiny application â€” AppDriver","text":"AppDriver retrieve values Shiny app, sure set shiny::runApp(test.mode = TRUE) running Shiny app. deploying Shiny app control call shiny::runApp(), can set options(shiny.testmode = TRUE) .Rprofile file within Shiny app directory.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"start-up-failure","dir":"Reference","previous_headings":"","what":"Start-up failure","title":"Drive a Shiny application â€” AppDriver","text":"app throws error initialization, AppDriver stored rlang::last_error()$app. allows \"failure initialize\" signaled also allowing app retrieved initialization error thrown.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"exporting-reactive-values","dir":"Reference","previous_headings":"","what":"Exporting reactive values","title":"Drive a Shiny application â€” AppDriver","text":"Reactive values within Shiny application can exported using method: shiny::exportTestValues(). underutilized method exposes internal values app without needing create corresponding input value output value. example:   exported test values exposed shiny::runApp(test.mode = TRUE) set.  shinytest2 sets variable running Shiny based app document.","code":"library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  init_vals <- app$get_values() str(init_vals) #> List of 3 #> $ input :List of 2 #> ..$ A: int 3 #> ..$ B: int 4 #> $ output:List of 1 #> ..$ C: chr \"5\" #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"testthat-wrappers","dir":"Reference","previous_headings":"","what":"testthat wrappers","title":"Drive a Shiny application â€” AppDriver","text":"two main expectation methods: $expect_values() $expect_screenshot() eventually wrap testthat::expect_snapshot_file(). underlying logic similar :   update snapshot values, need run variation testthat::snapshot_review().","code":"skip_on_cran() # AppDriver  ## Expect values tmpfile <- tempfile(fileext = \".json\") jsonlite::write_json(app$get_values(), tmpfile) expect_snapshot_file(   tmpfile,   variant = app$get_variant(),   compare = testthat::compare_file_text )   ## Expect screenshot tmpfile <- tempfile(fileext = \".png\") app$get_screenshot(tmpfile) expect_snapshot_file(   tmpfile,   variant = app$get_variant(),   compare = testthat::compare_file_binary )"},{"path":[]},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"Drive a Shiny application â€” AppDriver","text":"AppDriver$new() AppDriver$view() AppDriver$click() AppDriver$set_inputs() AppDriver$upload_file() AppDriver$expect_values() AppDriver$get_value() AppDriver$get_values() AppDriver$expect_download() AppDriver$get_download() AppDriver$expect_text() AppDriver$get_text() AppDriver$expect_html() AppDriver$get_html() AppDriver$expect_js() AppDriver$get_js() AppDriver$run_js() AppDriver$expect_screenshot() AppDriver$get_screenshot() AppDriver$wait_for_idle() AppDriver$wait_for_value() AppDriver$wait_for_js() AppDriver$expect_unique_names() AppDriver$get_dir() AppDriver$get_url() AppDriver$get_window_size() AppDriver$set_window_size() AppDriver$get_chromote_session() AppDriver$get_variant() AppDriver$get_logs() AppDriver$log_message() AppDriver$stop()","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"Drive a Shiny application â€” AppDriver","text":"Initialize AppDriver object","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$new(   app_dir = testthat::test_path(\"../../\"),   ...,   name = NULL,   variant = missing_arg(),   seed = NULL,   load_timeout = missing_arg(),   timeout = missing_arg(),   wait = TRUE,   screenshot_args = missing_arg(),   expect_values_screenshot_args = TRUE,   check_names = TRUE,   view = missing_arg(),   height = NULL,   width = NULL,   clean_logs = TRUE,   shiny_args = list(),   render_args = NULL,   options = list() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"app_dir value can many different things: directory containing Shiny application run-time Shiny R Markdown document. URL pointing shiny application. (forget set testmode = TRUE running application!) Shiny application object inherits \"shiny.appobj\". default, app_dir set test_path(\"../../\") work interactive testing usage. file path provided app_dir, snapshots saved root Shiny application current directory. ... Must empty. Allows parameter expansion. name Prefix value use saving testthat snapshot files. Ex: NAME-001.json. Name must unique saving multiple snapshots within testing file. Otherwise, two different AppDriver objects referencing files. variant -NULL, results saved _snaps/{variant}/{test.md}, variant must single string alphanumeric characters suitable use directory name. can variants deal cases snapshot output varies want capture test variations. Common use cases include variations operating system, R version, version key dependency. example usage, see platform_variant(). seed optional random seed use starting application. apps use R's random number generator, can make behavior repeatable. load_timeout long wait app load, ms. includes time start R. Defaults 15s. load_timeout missing, first numeric value found used: R option options(shinytest2.load_timeout=) System environment variable SHINYTEST2_LOAD_TIMEOUT 15 * 1000 (15 seconds) timeout Default number milliseconds timeout timeout_ parameter AppDriver class. Defaults 4s. timeout missing, first numeric value found used: R option options(shinytest2.timeout=) System environment variable SHINYTEST2_TIMEOUT 4 * 1000 (4 seconds) wait TRUE, $wait_for_idle(duration = 200, timeout = load_timeout) called app connected new session, blocking Shiny app idle 200ms. screenshot_args Default set arguments pass chromote::ChromoteSession's $get_screenshot() method taking screenshots within $expect_screenshot(). disable screenshots default, set FALSE. expect_values_screenshot_args value screenshot_args producing debug screenshot $expect_values(). disable debug screenshots default, set FALSE. check_names Check widget names unique application initially loads? duplicate names found initialization, warning displayed. view Opens chromote::ChromoteSession interactive browser tab attempting navigate Shiny app. height, width Window size use opening chromote::ChromoteSession. height width values must non-null values used. clean_logs Whether remove stdout stderr Shiny app logs AppDriver object garbage collected. shiny_args list options pass shiny::runApp(). Ex: list(port = 8080). render_args Passed rmarkdown::run(render_args=) interactive .Rmds. Ex: list(quiet = TRUE) options list base::options() set Shiny application's child R process. See shiny::shinyOptions() inspiration. shiny.trace = TRUE, WebSocket traffic captured chromote time-stamped logging purposes.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"object class AppDriver many methods described documentation.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ # Create an AppDriver from the Shiny app in the current directory app <- AppDriver()  # Create an AppDriver object from a different Shiny app directory example_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver(example_app)  # Expect consistent inital values app$expect_values() }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-view-","dir":"Reference","previous_headings":"","what":"Method view()","title":"Drive a Shiny application â€” AppDriver","text":"View Shiny application Calls $view() chromote::ChromoteSession object view Shiny application Chrome browser. method helpful debugging writing tests.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$view()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-1","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ # Open app in Chrome app$view() }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-click-","dir":"Reference","previous_headings":"","what":"Method click()","title":"Drive a Shiny application â€” AppDriver","text":"Click element Find Shiny input/output value DOM CSS selector click using DOM method TAG.click(). method can used click input buttons elements need simulate click action.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$click(   input = missing_arg(),   output = missing_arg(),   selector = missing_arg(),   ... )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"input, output, selector name Shiny input/output value DOM CSS selector. one may used. ... input used, extra arguments passed $set_inputs(!!input := \"click\", ...). means AppDriver wait output updated within specified timeout_. clicking content, ... must empty.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-2","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  tmpfile <- write.csv(cars, \"cars.csv\") app$upload_file(file1 = tmpfile) cat(app$get_text(\"#view\")) app$set_inputs(dataset = \"cars\", obs = 6) app$click(\"update\") cat(app$get_text(\"#view\")) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-set-inputs-","dir":"Reference","previous_headings":"","what":"Method set_inputs()","title":"Drive a Shiny application â€” AppDriver","text":"Set input values Set Shiny inputs sending value Chrome browser programmatically updating values. Given wait_ = TRUE, method return output value updated.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$set_inputs(   ...,   wait_ = TRUE,   timeout_ = missing_arg(),   allow_no_input_binding_ = FALSE,   priority_ = c(\"input\", \"event\") )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"... Name-value pairs, component_name_1 = value_1, component_name_2 = value_2 etc. Input name component_name_1 assigned value value_1. wait_ Wait reactive updates completed? timeout_ Amount time wait giving (milliseconds). Defaults resolved timeout value AppDriver initialization. allow_no_input_binding_ setting value input, allow set value input even input input binding. useful replicate behavior like hovering plotly plot. priority_ Sets event priority. expert use : see https://shiny.rstudio.com/articles/communicating--js.html#values-vs-events details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-3","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  cat(app$get_text(\"#view\")) app$set_inputs(dataset = \"cars\", obs = 6) app$click(\"update\") cat(app$get_text(\"#view\")) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-upload-file-","dir":"Reference","previous_headings":"","what":"Method upload_file()","title":"Drive a Shiny application â€” AppDriver","text":"Upload file Uploads file specified file input.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$upload_file(..., wait_ = TRUE, timeout_ = missing_arg())"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"... Name-path pair, e.g. component_name = file_path. file located file_path uploaded file input name component_name. wait_ Wait reactive updates completed? timeout_ Amount time wait giving (milliseconds). Defaults resolved timeout value AppDriver initialization.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-4","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/09_upload\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save example file tmpfile <- tempfile(fileext = \".csv\") write.csv(cars, tmpfile, row.names = FALSE)  # Upload file to input named: file1 app$upload_file(file1 = tmpfile) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-values-","dir":"Reference","previous_headings":"","what":"Method expect_values()","title":"Drive a Shiny application â€” AppDriver","text":"Expect input, output, export values JSON snapshot saved given results underlying call $get_values(). Note, values contain environments values trouble serializing may work well. Instead, objects manually inspected components tested individually. Please see Robust testing details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$expect_values(   ...,   input = missing_arg(),   output = missing_arg(),   export = missing_arg(),   screenshot_args = missing_arg(),   name = NULL,   transform = NULL,   cran = deprecated() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"... Must empty. Allows parameter expansion. input, output, export Depending parameters supplied, different return values can occur: * input, output, export missing, values included snapshot. * least one input, output, export specified, requested values included snapshot. values supplied variable can : * character vector specific names include snapshot. * TRUE request values type included snapshot. * Anything else (e.g. NULL FALSE) result parameter ignored. screenshot_args value passed along $expect_screenshot() resulting snapshot expectation ignored. missing, default value $new(expect_values_screenshot_args=). final value can either : TRUE: screenshot browser's scrollable area taken delay FALSE: screenshot taken named list arguments. arguments passed directly chromote::ChromoteSession's $get_screenshot() method. selector delay default \"html\" 0 respectively. name file name used snapshot. file extension overwritten .json. default, name supplied app initialization counter used (e.g. \"NAME-001.json\"). transform Optionally, function scrub sensitive stochastic text output. take character vector lines input return modified character vector output. cran Deprecated. AppDriver never testing CRAN, parameter longer effect.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"result snapshot expectation","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-5","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  # Snapshot all known values app$expect_values()  # Snapshot only `export` values app$expect_values(export = TRUE)  # Snapshot values `\"A\"` from `input` and `\"C\"` from `output` app$expect_values(input = \"A\", output = \"C\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-value-","dir":"Reference","previous_headings":"","what":"Method get_value()","title":"Drive a Shiny application â€” AppDriver","text":"Get single input, output, export value helper function around $get_values() retrieve single input, output, export value. single input, output, export value can used. Note, values contain environments values trouble serializing RDS may work well.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_value(   ...,   input = missing_arg(),   output = missing_arg(),   export = missing_arg(),   hash_images = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"... Must empty. Allows parameter expansion. input, output, export One variable contain single string value. one value specified values specified, error thrown. hash_images TRUE, images hashed returned. Otherwise, images return full data64 encoded value.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"requested input, output, export value.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-6","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/04_mpg\", package = \"shiny\") app <- AppDriver$new(app_path)  # Retrieve a single value app$get_value(output = \"caption\") #> [1] \"mpg ~ cyl\" # Equivalent code using `$get_values()` app$get_values(output = \"caption\")$output$caption #> [1] \"mpg ~ cyl\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-values-","dir":"Reference","previous_headings":"","what":"Method get_values()","title":"Drive a Shiny application â€” AppDriver","text":"Get input, output, export values Retrieves list known input, output, export values. method core method inspecting Shiny app. Note, values contain environments values trouble serializing may work well.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_values(   ...,   input = missing_arg(),   output = missing_arg(),   export = missing_arg(),   hash_images = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"... Must empty. Allows parameter expansion. input, output, export Depending parameters supplied, different return values can occur: * input, output, export missing, values included snapshot. * least one input, output, export specified, requested values included snapshot. values supplied variable can : * character vector specific names include snapshot. * TRUE request values type included snapshot. * Anything else (e.g. NULL FALSE) result parameter ignored. hash_images TRUE, images hashed returned. Otherwise, images return full data64 encoded value.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"named list inputs, outputs, export values.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-7","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  # Show all known values str(app$get_values()) #> List of 3 #> $ input :List of 2 #> ..$ A: int 3 #> ..$ B: int 4 #> $ output:List of 1 #> ..$ C: chr \"5\" #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25  # Get only `export` values str(app$get_values(export = TRUE)) #> List of 1 #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25  # Get values `\"A\"` from `input` and `\"C\"` from `output` str(app$get_values(input = \"A\", output = \"C\")) #> List of 2 #> $ input :List of 1 #> ..$ A: int 3 #> $ output:List of 1 #> ..$ C: chr \"5\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-download-","dir":"Reference","previous_headings":"","what":"Method expect_download()","title":"Drive a Shiny application â€” AppDriver","text":"Expect downloadable file Given shiny::downloadButton()/shiny::downloadLink() output ID, corresponding file downloaded saved snapshot file.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$expect_download(   output,   ...,   compare = NULL,   name = NULL,   transform = NULL,   cran = deprecated() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"output output ID shiny::downloadButton()/shiny::downloadLink() ... Must empty. Allows parameter expansion. compare value passed testthat::expect_snapshot_file(). default set NULL default testthat::compare_file_text name extension .r, .R, .Rmd, .md, .txt, otherwise uses testthat::compare_file_binary. name File name save file (including file name extension). default, NULL, generates ascending sequence names: 001.download, 002.download, etc. transform Optionally, function scrub sensitive stochastic text output. take character vector lines input return modified character vector output. cran Deprecated. AppDriver never testing CRAN, parameter longer effect.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-8","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/10_download\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save snapshot of rock.csv as 001.download # Save snapshot value of `rock.csv` to capture default file name app$expect_download(\"downloadData\", compare = testthat::compare_file_text) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-download-","dir":"Reference","previous_headings":"","what":"Method get_download()","title":"Drive a Shiny application â€” AppDriver","text":"Get downloadable file Given shiny::downloadButton()/shiny::downloadLink() output ID, corresponding file downloaded saved file.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_download(output, filename = NULL)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"output output ID shiny::downloadButton()/shiny::downloadLink() filename File path save downloaded file .","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"$get_download() return final save location file. location can change depending value filename response headers. Location logic: filename NULL, filename returned. content-disposition filename provided, temp file containing filename returned. Otherwise, temp file ending .download returned.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-9","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/10_download\", package = \"shiny\") app <- AppDriver$new(app_path)  # Get rock.csv as a tempfile app$get_download(\"downloadData\") #> [1] \"/TEMP/PATH/rock.csv\"  # Get rock.csv as a \"./myfile.csv\" app$get_download(\"downloadData\", filename = \"./myfile.csv\") #> [1] \"./myfile.csv\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-text-","dir":"Reference","previous_headings":"","what":"Method expect_text()","title":"Drive a Shiny application â€” AppDriver","text":"Expect snapshot UI text $expect_text() extract text value matching elements via TAG.textContent store snapshot file. method robust internal package change text values maintained. Note, method retrieve <input /> value's text content, e.g. text inputs text areas, input values stored live HTML. possible, use $expect_text() $expect_html() allow package authors room alter HTML structures. resulting array TAG.textContent values found stored snapshot file. Please see Robust testing details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$expect_text(selector, ..., cran = deprecated())"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"selector DOM CSS selector passed document.querySelectorAll() ... Must empty. Allows parameter expansion. cran Deprecated. AppDriver never testing CRAN, parameter longer effect.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-10","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ hello_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(hello_app)  # Make a snapshot of `\"Hello Shiny!\"` app$expect_text(\"h2\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-text-","dir":"Reference","previous_headings":"","what":"Method get_text()","title":"Drive a Shiny application â€” AppDriver","text":"Get UI text $get_text() extract text value matching elements via TAG.textContent. Note, method retrieve <input /> value's text content, e.g. text inputs text areas, input values stored live HTML.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_text(selector)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-10","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"selector DOM CSS selector passed document.querySelectorAll()","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"vector character values","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-11","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ hello_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(hello_app)  app$get_text(\"h2\") #> [1] \"Hello Shiny!\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-html-","dir":"Reference","previous_headings":"","what":"Method expect_html()","title":"Drive a Shiny application â€” AppDriver","text":"Expect snapshot UI HTML $expect_html() extract full DOM structures matching element store snapshot file. method captures internal DOM structure may brittle changes external authors dependencies. Note, method retrieve <input /> value's text content, e.g. text inputs text areas, input values stored live HTML. possible, use $expect_text() $expect_html() allow package authors room alter HTML structures. resulting array TAG.textContent values found stored snapshot file. Please see Robust testing details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$expect_html(selector, ..., outer_html = TRUE, cran = deprecated())"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-11","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"selector DOM selector passed document.querySelectorAll() ... Must empty. Allows parameter expansion. outer_html TRUE (default), full DOM structure returned (TAG.outerHTML). FALSE, full DOM structure child elements returned (TAG.innerHTML). cran Deprecated. AppDriver never testing CRAN, parameter longer effect.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-12","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/04_mpg\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save a snapshot of the `caption` output app$expect_html(\"#caption\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-html-","dir":"Reference","previous_headings":"","what":"Method get_html()","title":"Drive a Shiny application â€” AppDriver","text":"Get UI HTML $get() extract full DOM structures matching element. method captures internal DOM structure may brittle changes external authors dependencies. Note, method retrieve <input /> value's text content, e.g. text inputs text areas, input values stored live HTML. Please see Robust testing details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_html(selector, ..., outer_html = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-12","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"selector DOM selector passed document.querySelectorAll() ... Must empty. Allows parameter expansion. outer_html TRUE, full DOM structure returned (TAG.outerHTML). FALSE, full DOM structure child elements returned (TAG.innerHTML).","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-13","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/03_reactivity\", package = \"shiny\") app <- AppDriver$new(app_path, check_names = FALSE)  app$set_inputs(caption = \"Custom value!\") cat(app$get_html(\".shiny-input-container\")[1]) #> <div class=\"form-group shiny-input-container\"> #>   <label class=\"control-label\" id=\"caption-label\" for=\"caption\">Caption:<\/label> #>   <input id=\"caption\" type=\"text\" class=\"form-control shiny-bound-input\" value=\"Data Summary\"> #> <\/div> ## ^^ No update to the DOM of `caption` }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-js-","dir":"Reference","previous_headings":"","what":"Method expect_js()","title":"Drive a Shiny application â€” AppDriver","text":"Expect snapshot JavaScript script output building block function may called functions. example, $expect_text() $expect_html() thin wrappers around function. script executed, JSON result saved snapshot file.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-14","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$expect_js(   script = missing_arg(),   ...,   file = missing_arg(),   timeout = missing_arg(),   pre_snapshot = NULL,   cran = deprecated() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-13","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"script string containing JavaScript script executed. ... Must empty. Allows parameter expansion. file file containing JavaScript code read used script. one script file can specified. timeout Amount time wait giving (milliseconds). Defaults resolved timeout value AppDriver initialization. pre_snapshot function called result script taking snapshot. $expect_html() $expect_text() use unlist(). cran Deprecated. AppDriver never testing CRAN, parameter longer effect.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-14","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  # Track how many clicks are given to `#update` button app$run_js(\"   window.test_counter = 0;   $('#update').click(() => window.test_counter++); \") app$set_inputs(obs = 20) # Click the update button, incrementing the counter app$click(\"update\") # Save a snapshot of number of clicks (1) app$expect_js(\"window.test_counter;\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-js-","dir":"Reference","previous_headings":"","what":"Method get_js()","title":"Drive a Shiny application â€” AppDriver","text":"Execute JavaScript code browser return result function block local R session code finished executing tick browser. Promise returned script, $get_js() wait promise resolve. JavaScript code execute asynchronously, wrap code Promise object script return atomic value. Arguments inserted script access arguments. can done commands like paste(). using glue::glue(), sure use uncommon .open .close values avoid double { }.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-15","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_js(   script = missing_arg(),   ...,   file = missing_arg(),   timeout = missing_arg() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-14","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"script JavaScript execute. JavaScript Promise returned, R session block promise resolved return value. ... Must empty. Allows parameter expansion. file (local) file containing JavaScript code read used script. one script file can specified. timeout Amount time wait giving (milliseconds). Defaults resolved timeout value AppDriver initialization.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"Result script (file contents)","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-15","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Execute JavaScript code in the app's browser app$get_js(\"1 + 1;\") #> [1] 2  # Execute a JavaScript Promise. Return the resolved value. app$get_js(\"   new Promise((resolve) => {     setTimeout(() => resolve(1 + 1), 1000)   }).   then((value) => value + 1); \") #> [1] 3  # With escaped arguments loc_field <- \"hostname\" js_txt <- paste0(\"window.location[\", jsonlite::toJSON(loc_field, auto_unbox = TRUE), \"]\") app$get_js(js_txt) #> [1] \"127.0.0.1\"  # With `glue::glue()` js_txt <- glue::glue_data(   lapply(     list(x = 40, y = 2),     jsonlite::toJSON,     auto_unbox = TRUE   ),   .open = \"<\", .close = \">\",   \"let answer = function(a, b) {\\n\",   \"  return a + b;\\n\",   \"};\\n\",   \"answer(<x>, <y>);\\n\" ) app$get_js(js_txt) #> [1] 42 }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-run-js-","dir":"Reference","previous_headings":"","what":"Method run_js()","title":"Drive a Shiny application â€” AppDriver","text":"Execute JavaScript code browser function block local R session code finished executing tick browser. final result code ignored returned R session.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-16","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$run_js(   script = missing_arg(),   ...,   file = missing_arg(),   timeout = missing_arg() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-15","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"script JavaScript execute. ... Must empty. Allows parameter expansion. file (local) file containing JavaScript code read used script. one script file can specified. timeout Amount time wait giving (milliseconds). Defaults resolved timeout value AppDriver initialization.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-16","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Get JavaScript answer from the app's browser app$get_js(\"1 + 1\") #> [1] 2 # Execute JavaScript code in the app's browser app$run_js(\"1 + 1\") # (Returns `app` invisibly)  # With escaped arguments loc_field <- \"hostname\" js_txt <- paste0(\"window.location[\", jsonlite::toJSON(loc_field, auto_unbox = TRUE), \"]\") app$run_js(js_txt) app$get_js(js_txt) #> [1] \"127.0.0.1\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-screenshot-","dir":"Reference","previous_headings":"","what":"Method expect_screenshot()","title":"Drive a Shiny application â€” AppDriver","text":"Expect screenshot Shiny application method takes screenshot application (selector area) compares image expected image. Please aware method brittle changes outside Shiny application. changes can include: running different R version running different operating system using different default system font using different package versions differences explicitly clear working plots. Unless absolutely necessary application consistency, strongly recommended use expectation methods.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-17","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$expect_screenshot(   ...,   threshold = getOption(\"shinytest2.compare_screenshot.threshold\", NULL),   kernel_size = getOption(\"shinytest2.compare_screenshot.kernel_size\", 5),   screenshot_args = missing_arg(),   delay = missing_arg(),   selector = missing_arg(),   compare = missing_arg(),   quiet = FALSE,   name = NULL,   cran = deprecated() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-16","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"... Must empty. Allows parameter expansion. threshold Parameter supplied compare_screenshot_threshold() using default compare method. default value can set globally shinytest2.compare_screenshot.threshold option. value threshold NULL, compare_screenshot_threshold() act like testthat::compare_file_binary. However, threshold positive number, compared largest convolution value found two images fail testthat::compare_file_binary comparison. value use? Threshold values values 5 help deter false-positive screenshot comparisons (inconsistent rounded corners). Larger values 10s 100s help find real changes. However, values one size fits need play threshold fits needs. kernel_size Parameter supplied compare_screenshot_threshold() using default compare method. kernel_size represents height width convolution kernel applied pixel differences. integer-like value relatively small. default value can set globally shinytest2.compare_screenshot.kernel_size option. screenshot_args named list arguments passed along chromote::ChromoteSession's $get_screenshot() method. missing, value default $new(screenshot_args=). screenshot_args : TRUE: screenshot browser's scrollable area taken delay named list arguments: Arguments passed directly chromote::ChromoteSession's $get_screenshot() method. delay argument default 0 seconds. selector argument can take two special values addition CSS DOM selector. \"scrollable_area\" (default): entire scrollable area captured. Typically browser's viewport size, can larger page scrollable. value works well Apps contain elements whose calculated dimensions may different presented size. \"viewport\": value capture browser's viewport current viewing location, height, width. capture currently seen $view(). v0.3.0, default selector value changed HTML DOM selector (\"html\") entire scrollable area (\"scrollable_area\"). delay number seconds wait taking screenshot. value can supplied delay screenshot_args$delay, delay parameter preference. selector selector CSS selector used select portion page captured. value can supplied selector screenshot_args$selector, selector parameter preference. v0.3.0, two special selector values added: \"scrollable_area\" (default): entire scrollable area captured. Typically browser's viewport size, can larger page scrollable. value works well Apps contain elements whose calculated dimensions may different presented size. \"viewport\": value capture browser's viewport current viewing location, height, width. capture currently seen $view(). v0.3.0, default selector value changed HTML DOM selector (\"html\") entire scrollable area (\"scrollable_area\"). compare function used compare screenshot snapshot files. function take two inputs, paths old new snapshot, return either TRUE FALSE. compare defaults function wraps around compare_screenshot_threshold(old, new, threshold = threshold, kernel_size = kernel_size, quiet = quiet). Note: threshold NULL (default), compare behave testthat::compare_file_binary() provided, comparing two images byte--byte. quiet Parameter supplied compare_screenshot_threshold() using default compare method. FALSE, diagnostic information presented computed value larger non-NULL threshold value. name file name used snapshot. file extension overwritten .png. default, name supplied app initialization counter used (e.g. \"NAME-001.png\"). cran Deprecated. AppDriver never testing CRAN, parameter longer effect.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-17","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ # These example lines should be performed in a `./tests/testthat` # test file so that snapshot files can be properly saved  app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path, variant = platform_variant())  # Expect a full size screenshot to be pixel perfect app$expect_screenshot()  # Images are brittle when containing plots app$expect_screenshot(selector = \"#distPlot\")  # Test with more threshold in pixel value differences # Helps with rounded corners app$expect_screenshot(threshold = 10)  # Equivalent expectations app$expect_screenshot() # default app$expect_screenshot(threshold = NULL) app$expect_screenshot(compare = testthat::compare_file_binary) expect_snapshot_file(   app$get_screenshot(),   variant = app$get_variant(),   compare = testthat::compare_file_binary )  # Equivalent expectations app$expect_screenshot(threshold = 3, kernel_size = 5) app$expect_screenshot(compare = function(old, new) {   compare_screenshot_threshold(     old, new,     threshold = 3,     kernel_size = 5   ) }) expect_screenshot_file(   app$get_screenshot(),   variant = app$get_variant(),   compare = function(old, new) {     compare_screenshot_threshold(       old, new,       threshold = 3,       kernel_size = 5     )   } )  # Take a screenshot of the entire scrollable area app$expect_screenshot() app$expect_screenshot(selector = \"scrollable_area\")  ## Take a screenshot of the current viewport # Shrink the window to be smaller than the app app$set_window_size(400, 500) # Scroll the viewport just a bit app$run_js(\"window.scroll(30, 70)\") # Take screenshot of browser viewport app$expect_screenshot(selector = \"viewport\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-screenshot-","dir":"Reference","previous_headings":"","what":"Method get_screenshot()","title":"Drive a Shiny application â€” AppDriver","text":"Take screenshot Take screenshot Shiny application.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-18","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_screenshot(   file = NULL,   ...,   screenshot_args = missing_arg(),   delay = missing_arg(),   selector = missing_arg() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-17","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"file NULL, image displayed current Graphics Device. file path, screenshot saved file. ... Must empty. Allows parameter expansion. screenshot_args named list arguments passed along chromote::ChromoteSession's $get_screenshot() method. missing, value default $new(screenshot_args=). screenshot_args : TRUE: screenshot browser's scrollable area taken delay named list arguments: Arguments passed directly chromote::ChromoteSession's $get_screenshot() method. delay argument default 0 seconds. selector argument can take two special values addition CSS DOM selector. \"scrollable_area\" (default): entire scrollable area captured. Typically browser's viewport size, can larger page scrollable. value works well Apps contain elements whose calculated dimensions may different presented size. \"viewport\": value capture browser's viewport current viewing location, height, width. capture currently seen $view(). v0.3.0, default selector value changed HTML DOM selector (\"html\") entire scrollable area (\"scrollable_area\"). screenshot_args=FALSE provided, parameter ignored screenshot taken default behavior. delay number seconds wait taking screenshot. value can supplied delay screenshot_args$delay, delay parameter preference. selector selector CSS selector used select portion page captured. value can supplied selector screenshot_args$selector, selector parameter preference. v0.3.0, two special selector values added: \"scrollable_area\" (default): entire scrollable area captured. Typically browser's viewport size, can larger page scrollable. value works well Apps contain elements whose calculated dimensions may different presented size. \"viewport\": value capture browser's viewport current viewing location, height, width. capture currently seen $view(). v0.3.0, default selector value changed HTML DOM selector (\"html\") entire scrollable area (\"scrollable_area\").","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-18","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  # Display in graphics device app$get_screenshot()  # Update bins then display `\"disPlot\"` in graphics device app$set_inputs(bins = 10) app$get_screenshot(selector = \"#distPlot\")  # Save screenshot to file and view it tmpfile <- tempfile(fileext = \".png\") app$get_screenshot(tmpfile) showimage::show_image(tmpfile) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-wait-for-idle-","dir":"Reference","previous_headings":"","what":"Method wait_for_idle()","title":"Drive a Shiny application â€” AppDriver","text":"Wait Shiny busy (idle) set amount time Waits Shiny busy set duration time, e.g. reactivity updating occurred. useful, example, waiting application initialize resized window $set_window_size() want make sure plot redrawing complete take screenshot. default, $new(wait = TRUE) waits Shiny busy initializing application $set_window_size(wait = TRUE) waits Shiny busy resizing window.)","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-19","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$wait_for_idle(duration = 500, timeout = missing_arg())"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-18","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"duration long Shiny must idle (ms) unblocking R session. timeout Amount time wait giving (milliseconds). Defaults resolved timeout value AppDriver initialization.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-7","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"invisible(self) Shiny stabilizes within timeout. Otherwise error thrown","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-19","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  pre_value <- app$get_value(output = \"distPlot\") # Update bins value app$set_inputs(bins = 10, wait_ = FALSE) middle_value <- app$get_value(output = \"distPlot\") app$wait_for_idle() post_value <- app$get_value(output = \"distPlot\")  # No guarantee that these values are different identical(pre_value, middle_value) # Will not be equal identical(pre_value, post_value)  # --------------------- ## Change the screen size to trigger a plot update pre_value <- app$get_value(output = \"distPlot\") app$set_window_size(height = 1080, width = 1920, wait = FALSE) middle_value <- app$get_value(output = \"distPlot\") app$wait_for_idle() post_value <- app$get_value(output = \"distPlot\")  # No guarantee that these values are different identical(pre_value, middle_value) # Will not be equal identical(pre_value, post_value) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-wait-for-value-","dir":"Reference","previous_headings":"","what":"Method wait_for_value()","title":"Drive a Shiny application â€” AppDriver","text":"Wait new Shiny value Waits input, output, export Shiny value one ignored values, timeout reached. single input, output, export value may used. function can useful helping determine application finished processing complex reactive situation.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-20","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$wait_for_value(   ...,   input = missing_arg(),   output = missing_arg(),   export = missing_arg(),   ignore = list(NULL, \"\"),   timeout = missing_arg(),   interval = 400 )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-19","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"... Must empty. Allows parameter expansion. input, output, export name input, output, export value. one parameters may used. ignore List possible values ignore checking updates. timeout Amount time wait giving (milliseconds). Defaults resolved timeout value AppDriver initialization. interval often check condition, ms. timeout_ Amount time wait new output value giving (milliseconds). Defaults resolved timeout value AppDriver initialization.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-8","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"Newly found value","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-20","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Dynamic output\"),     actionButton(\"display\", \"Display UI\"),     uiOutput(\"dym1\"),   ),   function(input, output) {     output$dym1 <- renderUI({       req(input$display)       Sys.sleep(runif(1, max = 2)) # Artificial calculations       tagList(         sliderInput(\"slider1\", \"Slider #1\", 0, 100, 25),         uiOutput(\"dym2\")       )     })     output$dym2 <- renderUI({       Sys.sleep(runif(1, max = 2)) # Artificial calculations       tagList(         sliderInput(\"slider2\", \"Slider #2\", 0, 100, 50),         \"Total:\", verbatimTextOutput(\"total\")       )     })     output$total <- renderText({       req(input$slider1, input$slider2)       input$slider1 + input$slider2     })   } )  app <- AppDriver$new(shiny_app)  # Create UI / output values app$click(\"display\") # Wait for total to be calculated (or have a non-NULL value) new_total_value <- app$wait_for_value(output = \"total\") #> [1] \"75\" app$get_value(output = \"total\") #> [1] \"75\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-wait-for-js-","dir":"Reference","previous_headings":"","what":"Method wait_for_js()","title":"Drive a Shiny application â€” AppDriver","text":"Wait JavaScript expression true Waits JavaScript expression evaluates true timeout exceeded.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-21","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$wait_for_js(script, timeout = missing_arg(), interval = 100)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-20","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"script string containing JavaScript code. code must eventually return truethy value timeout error thrown. timeout long script return truethy value (milliseconds). Defaults resolved timeout value AppDriver initialization. interval often check condition (milliseconds).","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-9","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"invisible(self) expression evaluates true without error within timeout. Otherwise error thrown","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-21","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Contrived example: # Wait until `Date.now()` returns a number that ends in a 5. (0 - 10 seconds) system.time(   app$wait_for_js(\"Math.floor((Date.now() / 1000) % 10) == 5;\") )  ## A second example where we run the contents of a JavaScript file ## and use the result to wait for a condition app$run_js(file = \"complicated_file.js\") app$wait_for_js(\"complicated_condition();\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-unique-names-","dir":"Reference","previous_headings":"","what":"Method expect_unique_names()","title":"Drive a Shiny application â€” AppDriver","text":"Expect unique input output names. HTML duplicate input output elements matching id values, function throw error. similar AppDriver$new(check_names = TRUE), asserts warnings displayed. method throw single input single output name.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-22","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$expect_unique_names()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-22","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ shiny_app <- shinyApp(   ui = fluidPage(     # Duplicate input IDs: `\"text\"`     textInput(\"text\", \"Text 1\"),     textInput(\"text\", \"Text 2\")   ),   server = function(input, output) {     # empty   } ) # Initial checking for unique names (default behavior) app <- AppDriver$new(shiny_app, check_names = TRUE) #> Warning: #> ! Shiny inputs should have unique HTML id values. #> i The following HTML id values are not unique: #> â€¢ text app$stop()  # Manually assert that all names are unique app <- AppDriver$new(shiny_app, check_names = FALSE) app$expect_unique_names() #> Error: `app_check_unique_names(self, private)` threw an unexpected warning. #> Message: ! Shiny inputs should have unique HTML id values. #> i The following HTML id values are not unique: #>   â€¢ text #> Class:   rlang_warning/warning/condition app$stop() }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-dir-","dir":"Reference","previous_headings":"","what":"Method get_dir()","title":"Drive a Shiny application â€” AppDriver","text":"Retrieve Shiny app path","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-23","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_dir()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-10","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"directory containing Shiny application Shiny runtime document. URL provided app_dir initialization, current directory returned.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-23","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  identical(app$get_dir(), app_path) #> [1] TRUE }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-url-","dir":"Reference","previous_headings":"","what":"Method get_url()","title":"Drive a Shiny application â€” AppDriver","text":"Retrieve Shiny app URL","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-24","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_url()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-11","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"URL Shiny app hosted","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-24","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  browseURL(app$get_url()) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-window-size-","dir":"Reference","previous_headings":"","what":"Method get_window_size()","title":"Drive a Shiny application â€” AppDriver","text":"Get window size Get current size browser window, list numeric scalars named width height.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-25","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_window_size()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-25","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  app$get_window_size() #> $width #> [1] 992 #> #> $height #> [1] 1323 }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-set-window-size-","dir":"Reference","previous_headings":"","what":"Method set_window_size()","title":"Drive a Shiny application â€” AppDriver","text":"Sets size browser window.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-26","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$set_window_size(width, height, wait = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-21","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"width, height Height width browser, pixels. wait TRUE, $wait_for_idle() called setting window size. block width specific items (plots) need re-rendered.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-26","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") # Set init window size app <- AppDriver$new(app_path, height = 1400, width = 1000)  app$get_window_size() #> $width #> [1] 1000 #> #> $height #> [1] 1400  # Manually set the window size app$set_window_size(height = 1080, width = 1920) app$get_window_size() #> $width #> [1] 1920 #> #> $height #> [1] 1080 }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-chromote-session-","dir":"Reference","previous_headings":"","what":"Method get_chromote_session()","title":"Drive a Shiny application â€” AppDriver","text":"Get Chromote Session Get chromote::ChromoteSession object chromote package.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-27","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_chromote_session()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-12","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"chromote::ChromoteSession R6 object","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-27","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  b <- app$get_chromote_session() b$Runtime$evaluate(\"1 + 1\") #> $result #> $result$type #> [1] \"number\" #> #> $result$value #> [1] 2 #> #> $result$description #> [1] \"2\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-variant-","dir":"Reference","previous_headings":"","what":"Method get_variant()","title":"Drive a Shiny application â€” AppDriver","text":"Get variant Get variant supplied initialization","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-28","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_variant()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-13","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"variant value supplied initialization NULL value supplied.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-28","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\")  app <- AppDriver$new(app_path)  app$get_variant() #> NULL  app <- AppDriver$new(app_path, variant = platform_variant()) app$get_variant() #> [1] \"mac-4.1\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-logs-","dir":"Reference","previous_headings":"","what":"Method get_logs()","title":"Drive a Shiny application â€” AppDriver","text":"Get logs Retrieve debug logs recorded.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-29","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$get_logs()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-14","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"data.frame following columns: workerid: shiny worker ID found within browser timestamp: POSIXct timestamp message location: location message found. One three values: \"shinytest2\": Occurs $log_message() called \"shiny\": stdin stdout messages Shiny server. Note message() output sent stdout. \"chromote\": Captured chromote event handlers. See console API, exception thrown, websocket sent, websocket received details level: given location, different types log levels. \"shinytest2\": \"log\"; log messages captured. \"shiny\": \"stdout\" \"stderr\"; Note, message() output sent stderr. \"chromote\": Correspond level JavaScript console.LEVEL() function call. Typically, \"log\"\"error\"can include\"info\", \"debug\", \"warn\". options(shiny.trace = TRUE), level recorded \"websocket\"`.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-29","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app1 <- AppDriver$new(system.file(\"examples/01_hello\", package = \"shiny\"))  app1$get_logs() #> {shinytest2} R  info   10:00:28.86 Start AppDriver initialization #> {shinytest2} R  info   10:00:28.86 Starting Shiny app #> {shinytest2} R  info   10:00:29.76 Creating new ChromoteSession #> {shinytest2} R  info   10:00:30.56 Navigating to Shiny app #> {shinytest2} R  info   10:00:30.70 Injecting shiny-tracer.js #> {chromote}   JS info   10:00:30.75 shinytest2; jQuery found #> {chromote}   JS info   10:00:30.77 shinytest2; Waiting for shiny session to connect #> {chromote}   JS info   10:00:30.77 shinytest2; Loaded #> {shinytest2} R  info   10:00:30.77 Waiting for Shiny to become ready #> {chromote}   JS info   10:00:30.90 shinytest2; Connected #> {chromote}   JS info   10:00:30.95 shinytest2; shiny:busy #> {shinytest2} R  info   10:00:30.98 Waiting for Shiny to become idle for 200ms within 15000ms #> {chromote}   JS info   10:00:30.98 shinytest2; Waiting for Shiny to be stable #> {chromote}   JS info   10:00:31.37 shinytest2; shiny:idle #> {chromote}   JS info   10:00:31.38 shinytest2; shiny:value distPlot #> {chromote}   JS info   10:00:31.57 shinytest2; Shiny has been idle for 200ms #> {shinytest2} R  info   10:00:31.57 Shiny app started #> {shiny}      R  stderr ----------- Loading required package: shiny #> {shiny}      R  stderr ----------- Running application in test mode. #> {shiny}      R  stderr ----------- #> {shiny}      R  stderr ----------- Listening on http://127.0.0.1:4679   # To capture all websocket traffic, set `options = list(shiny.trace = TRUE)` app2 <- AppDriver$new(   system.file(\"examples/01_hello\", package = \"shiny\"),   options = list(shiny.trace = TRUE) )  app2$get_logs() ## (All WebSocket messages have been replaced with `WEBSOCKET_MSG` in example below) #> {shinytest2} R  info      10:01:57.49 Start AppDriver initialization #> {shinytest2} R  info      10:01:57.50 Starting Shiny app #> {shinytest2} R  info      10:01:58.20 Creating new ChromoteSession #> {shinytest2} R  info      10:01:58.35 Navigating to Shiny app #> {shinytest2} R  info      10:01:58.47 Injecting shiny-tracer.js #> {chromote}   JS info      10:01:58.49 shinytest2; jQuery not found #> {chromote}   JS info      10:01:58.49 shinytest2; Loaded #> {shinytest2} R  info      10:01:58.50 Waiting for Shiny to become ready #> {chromote}   JS info      10:01:58.55 shinytest2; jQuery found #> {chromote}   JS info      10:01:58.55 shinytest2; Waiting for shiny session to connect #> {chromote}   JS websocket 10:01:58.64 send WEBSOCKET_MSG #> {chromote}   JS websocket 10:01:58.67 recv WEBSOCKET_MSG #> {chromote}   JS info      10:01:58.67 shinytest2; Connected #> {chromote}   JS websocket 10:01:58.71 recv WEBSOCKET_MSG #> {chromote}   JS websocket 10:01:58.72 recv WEBSOCKET_MSG #> {chromote}   JS info      10:01:58.72 shinytest2; shiny:busy #> {chromote}   JS websocket 10:01:58.73 recv WEBSOCKET_MSG #> {chromote}   JS websocket 10:01:58.73 recv WEBSOCKET_MSG #> {shinytest2} R  info      10:01:58.75 Waiting for Shiny to become idle for 200ms within 15000ms #> {chromote}   JS info      10:01:58.75 shinytest2; Waiting for Shiny to be stable #> {chromote}   JS websocket 10:01:58.81 recv WEBSOCKET_MSG #> {chromote}   JS websocket 10:01:58.81 recv WEBSOCKET_MSG #> {chromote}   JS info      10:01:58.81 shinytest2; shiny:idle #> {chromote}   JS websocket 10:01:58.82 recv WEBSOCKET_MSG #> {chromote}   JS info      10:01:58.82 shinytest2; shiny:value distPlot #> {chromote}   JS info      10:01:59.01 shinytest2; Shiny has been idle for 200ms #> {shinytest2} R  info      10:01:59.01 Shiny app started #> {shiny}      R  stderr    ----------- Loading required package: shiny #> {shiny}      R  stderr    ----------- Running application in test mode. #> {shiny}      R  stderr    ----------- #> {shiny}      R  stderr    ----------- Listening on http://127.0.0.1:4560 #> {shiny}      R  stderr    ----------- SEND {\"config\":{\"workerId\":\"\",\"sessionId\"|truncated #> {shiny}      R  stderr    ----------- RECV {\"method\":\"init\",\"data\":{\"bins\":30,|truncated #> {shiny}      R  stderr    ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\":|truncated #> {shiny}      R  stderr    ----------- SEND {\"busy\":\"busy\"} #> {shiny}      R  stderr    ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\":|truncated #> {shiny}      R  stderr    ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated #> {shiny}      R  stderr    ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated #> {shiny}      R  stderr    ----------- SEND {\"busy\":\"idle\"} #> {shiny}      R  stderr    ----------- SEND {\"errors\":{},\"values\":{\"distPlot\":|truncated  # The log that is returned is a `data.frame()`. log <- app2$get_logs() tibble::glimpse(log) #> Rows: 43 #> Columns: 5 #> $ workerid  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦ #> $ timestamp <dttm> 2022-09-19 10:01:57, 2022-09-19 10:01:57, 2022-09-19 10:01:58, 2022â€¦ #> $ location  <chr> \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shinytest2\"â€¦ #> $ level     <chr> \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"infâ€¦ #> $ message   <chr> \"Start AppDriver initialization\", \"Starting Shiny app\", \"Creating neâ€¦ #> $ workerid  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦ #> $ timestamp <dttm> 2022-03-16 11:09:57, 2022-03-16 11:09:57, 2022-03-16 11:09:â€¦ #> $ location  <chr> \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shiâ€¦ #> $ level     <chr> \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"infâ€¦ #> $ message   <chr> \"Start AppDriver initialization\", \"Starting Shiny app\", \"Creâ€¦  # It may be filtered to find desired logs subset(log, level == \"websocket\") ## (All WebSocket messages have been replaced with `WEBSOCKET_MSG` in example below) #> {chromote} JS websocket 10:01:58.64 send WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.67 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.71 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.72 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.73 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.73 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.81 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.81 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.82 recv WEBSOCKET_MSG }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-log-message-","dir":"Reference","previous_headings":"","what":"Method log_message()","title":"Drive a Shiny application â€” AppDriver","text":"Add message shinytest2 log.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-30","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$log_message(message)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-22","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"message Single message store log","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-30","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  app$log_message(\"Setting bins to smaller value\") app$set_inputs(bins = 10) app$get_logs() }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-stop-","dir":"Reference","previous_headings":"","what":"Method stop()","title":"Drive a Shiny application â€” AppDriver","text":"Stop Shiny application driver method stops known processes: Shiny application background R process, background R process hosting Shiny application, Chromote Session instance. stop shiny application return value $stop(), see shiny::stopApp(). useful testing return context information. Typically, can paired button clicked call shiny::stopApp(info) return info test app back main R session.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-31","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application â€” AppDriver","text":"","code":"AppDriver$stop(signal_timeout = missing_arg())"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-23","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application â€” AppDriver","text":"signal_timeout Milliseconds wait sending SIGINT, SIGTERM, SIGKILL Shiny process. Defaults 500ms utilize resolved value AppDriver$new(timeout=). However, covr currently executing, timeout set 20,000ms allow coverage report generated.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-15","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application â€” AppDriver","text":"result background process Shiny application already terminated.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-31","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"\\dontrun{ rlang::check_installed(\"reactlog\")  library(shiny) shiny_app <- shinyApp(   ui = fluidPage(     actionButton(\"button\", \"Stop app and return Reactlog\"),     \"Click count:\", textOutput(\"count\")   ),   server = function(input, output) {     output$count <- renderText({ input$button })     observe({       req(input$button)       stopApp(shiny::reactlog())     })   } )  app <- AppDriver$new(   shiny_app,   # Enable reactlog in background R session   options = list(shiny.reactlog = TRUE) )  app$click(\"button\") rlog <- app$stop() str(head(rlog, 2)) #> List of 2 #> $ :List of 7 #> ..$ action : chr \"define\" #> ..$ reactId: chr \"r3\" #> ..$ label  : chr \"Theme Counter\" #> ..$ type   : chr \"reactiveVal\" #> ..$ value  : chr \" num 0\" #> ..$ session: chr \"bdc7417f2fc8c84fc05c9518e36fdc44\" #> ..$ time   : num 1.65e+09 #> $ :List of 7 #> ..$ action : chr \"define\" #> ..$ reactId: chr \"r4\" #> ..$ label  : chr \"output$count\" #> .. ..- attr(*, \"srcref\")= int [1:6] 7 32 7 45 32 45 #> .. ..- attr(*, \"srcfile\")= chr \"\" #> ..$ type   : chr \"observer\" #> ..$ value  : chr \" NULL\" #> ..$ session: chr \"bdc7417f2fc8c84fc05c9518e36fdc44\" #> ..$ time   : num 1.65e+09 }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application â€” AppDriver","text":"","code":"## ------------------------------------------------ ## Method `AppDriver$new` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ # Create an AppDriver from the Shiny app in the current directory app <- AppDriver()  # Create an AppDriver object from a different Shiny app directory example_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver(example_app)  # Expect consistent inital values app$expect_values() } # }  ## ------------------------------------------------ ## Method `AppDriver$view` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ # Open app in Chrome app$view() } # }  ## ------------------------------------------------ ## Method `AppDriver$click` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  tmpfile <- write.csv(cars, \"cars.csv\") app$upload_file(file1 = tmpfile) cat(app$get_text(\"#view\")) app$set_inputs(dataset = \"cars\", obs = 6) app$click(\"update\") cat(app$get_text(\"#view\")) } # }  ## ------------------------------------------------ ## Method `AppDriver$set_inputs` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  cat(app$get_text(\"#view\")) app$set_inputs(dataset = \"cars\", obs = 6) app$click(\"update\") cat(app$get_text(\"#view\")) } # }  ## ------------------------------------------------ ## Method `AppDriver$upload_file` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/09_upload\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save example file tmpfile <- tempfile(fileext = \".csv\") write.csv(cars, tmpfile, row.names = FALSE)  # Upload file to input named: file1 app$upload_file(file1 = tmpfile) } # }  ## ------------------------------------------------ ## Method `AppDriver$expect_values` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  # Snapshot all known values app$expect_values()  # Snapshot only `export` values app$expect_values(export = TRUE)  # Snapshot values `\"A\"` from `input` and `\"C\"` from `output` app$expect_values(input = \"A\", output = \"C\") } # }  ## ------------------------------------------------ ## Method `AppDriver$get_value` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/04_mpg\", package = \"shiny\") app <- AppDriver$new(app_path)  # Retrieve a single value app$get_value(output = \"caption\") #> [1] \"mpg ~ cyl\" # Equivalent code using `$get_values()` app$get_values(output = \"caption\")$output$caption #> [1] \"mpg ~ cyl\" } # }  ## ------------------------------------------------ ## Method `AppDriver$get_values` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  # Show all known values str(app$get_values()) #> List of 3 #> $ input :List of 2 #> ..$ A: int 3 #> ..$ B: int 4 #> $ output:List of 1 #> ..$ C: chr \"5\" #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25  # Get only `export` values str(app$get_values(export = TRUE)) #> List of 1 #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25  # Get values `\"A\"` from `input` and `\"C\"` from `output` str(app$get_values(input = \"A\", output = \"C\")) #> List of 2 #> $ input :List of 1 #> ..$ A: int 3 #> $ output:List of 1 #> ..$ C: chr \"5\" } # }  ## ------------------------------------------------ ## Method `AppDriver$expect_download` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/10_download\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save snapshot of rock.csv as 001.download # Save snapshot value of `rock.csv` to capture default file name app$expect_download(\"downloadData\", compare = testthat::compare_file_text) } # }  ## ------------------------------------------------ ## Method `AppDriver$get_download` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/10_download\", package = \"shiny\") app <- AppDriver$new(app_path)  # Get rock.csv as a tempfile app$get_download(\"downloadData\") #> [1] \"/TEMP/PATH/rock.csv\"  # Get rock.csv as a \"./myfile.csv\" app$get_download(\"downloadData\", filename = \"./myfile.csv\") #> [1] \"./myfile.csv\" } # }  ## ------------------------------------------------ ## Method `AppDriver$expect_text` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ hello_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(hello_app)  # Make a snapshot of `\"Hello Shiny!\"` app$expect_text(\"h2\") } # }  ## ------------------------------------------------ ## Method `AppDriver$get_text` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ hello_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(hello_app)  app$get_text(\"h2\") #> [1] \"Hello Shiny!\" } # }  ## ------------------------------------------------ ## Method `AppDriver$expect_html` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/04_mpg\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save a snapshot of the `caption` output app$expect_html(\"#caption\") } # }  ## ------------------------------------------------ ## Method `AppDriver$get_html` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/03_reactivity\", package = \"shiny\") app <- AppDriver$new(app_path, check_names = FALSE)  app$set_inputs(caption = \"Custom value!\") cat(app$get_html(\".shiny-input-container\")[1]) #> <div class=\"form-group shiny-input-container\"> #>   <label class=\"control-label\" id=\"caption-label\" for=\"caption\">Caption:<\/label> #>   <input id=\"caption\" type=\"text\" class=\"form-control shiny-bound-input\" value=\"Data Summary\"> #> <\/div> ## ^^ No update to the DOM of `caption` } # }  ## ------------------------------------------------ ## Method `AppDriver$expect_js` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  # Track how many clicks are given to `#update` button app$run_js(\"   window.test_counter = 0;   $('#update').click(() => window.test_counter++); \") app$set_inputs(obs = 20) # Click the update button, incrementing the counter app$click(\"update\") # Save a snapshot of number of clicks (1) app$expect_js(\"window.test_counter;\") } # }  ## ------------------------------------------------ ## Method `AppDriver$get_js` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ library(shiny) shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Execute JavaScript code in the app's browser app$get_js(\"1 + 1;\") #> [1] 2  # Execute a JavaScript Promise. Return the resolved value. app$get_js(\"   new Promise((resolve) => {     setTimeout(() => resolve(1 + 1), 1000)   }).   then((value) => value + 1); \") #> [1] 3  # With escaped arguments loc_field <- \"hostname\" js_txt <- paste0(\"window.location[\", jsonlite::toJSON(loc_field, auto_unbox = TRUE), \"]\") app$get_js(js_txt) #> [1] \"127.0.0.1\"  # With `glue::glue()` js_txt <- glue::glue_data(   lapply(     list(x = 40, y = 2),     jsonlite::toJSON,     auto_unbox = TRUE   ),   .open = \"<\", .close = \">\",   \"let answer = function(a, b) {\\n\",   \"  return a + b;\\n\",   \"};\\n\",   \"answer(<x>, <y>);\\n\" ) app$get_js(js_txt) #> [1] 42 } # }  ## ------------------------------------------------ ## Method `AppDriver$run_js` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ library(shiny) shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Get JavaScript answer from the app's browser app$get_js(\"1 + 1\") #> [1] 2 # Execute JavaScript code in the app's browser app$run_js(\"1 + 1\") # (Returns `app` invisibly)  # With escaped arguments loc_field <- \"hostname\" js_txt <- paste0(\"window.location[\", jsonlite::toJSON(loc_field, auto_unbox = TRUE), \"]\") app$run_js(js_txt) app$get_js(js_txt) #> [1] \"127.0.0.1\" } # }  ## ------------------------------------------------ ## Method `AppDriver$expect_screenshot` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ # These example lines should be performed in a `./tests/testthat` # test file so that snapshot files can be properly saved  app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path, variant = platform_variant())  # Expect a full size screenshot to be pixel perfect app$expect_screenshot()  # Images are brittle when containing plots app$expect_screenshot(selector = \"#distPlot\")  # Test with more threshold in pixel value differences # Helps with rounded corners app$expect_screenshot(threshold = 10)  # Equivalent expectations app$expect_screenshot() # default app$expect_screenshot(threshold = NULL) app$expect_screenshot(compare = testthat::compare_file_binary) expect_snapshot_file(   app$get_screenshot(),   variant = app$get_variant(),   compare = testthat::compare_file_binary )  # Equivalent expectations app$expect_screenshot(threshold = 3, kernel_size = 5) app$expect_screenshot(compare = function(old, new) {   compare_screenshot_threshold(     old, new,     threshold = 3,     kernel_size = 5   ) }) expect_screenshot_file(   app$get_screenshot(),   variant = app$get_variant(),   compare = function(old, new) {     compare_screenshot_threshold(       old, new,       threshold = 3,       kernel_size = 5     )   } )  # Take a screenshot of the entire scrollable area app$expect_screenshot() app$expect_screenshot(selector = \"scrollable_area\")  ## Take a screenshot of the current viewport # Shrink the window to be smaller than the app app$set_window_size(400, 500) # Scroll the viewport just a bit app$run_js(\"window.scroll(30, 70)\") # Take screenshot of browser viewport app$expect_screenshot(selector = \"viewport\") } # }  ## ------------------------------------------------ ## Method `AppDriver$get_screenshot` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  # Display in graphics device app$get_screenshot()  # Update bins then display `\"disPlot\"` in graphics device app$set_inputs(bins = 10) app$get_screenshot(selector = \"#distPlot\")  # Save screenshot to file and view it tmpfile <- tempfile(fileext = \".png\") app$get_screenshot(tmpfile) showimage::show_image(tmpfile) } # }  ## ------------------------------------------------ ## Method `AppDriver$wait_for_idle` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  pre_value <- app$get_value(output = \"distPlot\") # Update bins value app$set_inputs(bins = 10, wait_ = FALSE) middle_value <- app$get_value(output = \"distPlot\") app$wait_for_idle() post_value <- app$get_value(output = \"distPlot\")  # No guarantee that these values are different identical(pre_value, middle_value) # Will not be equal identical(pre_value, post_value)  # --------------------- ## Change the screen size to trigger a plot update pre_value <- app$get_value(output = \"distPlot\") app$set_window_size(height = 1080, width = 1920, wait = FALSE) middle_value <- app$get_value(output = \"distPlot\") app$wait_for_idle() post_value <- app$get_value(output = \"distPlot\")  # No guarantee that these values are different identical(pre_value, middle_value) # Will not be equal identical(pre_value, post_value) } # }  ## ------------------------------------------------ ## Method `AppDriver$wait_for_value` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Dynamic output\"),     actionButton(\"display\", \"Display UI\"),     uiOutput(\"dym1\"),   ),   function(input, output) {     output$dym1 <- renderUI({       req(input$display)       Sys.sleep(runif(1, max = 2)) # Artificial calculations       tagList(         sliderInput(\"slider1\", \"Slider #1\", 0, 100, 25),         uiOutput(\"dym2\")       )     })     output$dym2 <- renderUI({       Sys.sleep(runif(1, max = 2)) # Artificial calculations       tagList(         sliderInput(\"slider2\", \"Slider #2\", 0, 100, 50),         \"Total:\", verbatimTextOutput(\"total\")       )     })     output$total <- renderText({       req(input$slider1, input$slider2)       input$slider1 + input$slider2     })   } )  app <- AppDriver$new(shiny_app)  # Create UI / output values app$click(\"display\") # Wait for total to be calculated (or have a non-NULL value) new_total_value <- app$wait_for_value(output = \"total\") #> [1] \"75\" app$get_value(output = \"total\") #> [1] \"75\" } # }  ## ------------------------------------------------ ## Method `AppDriver$wait_for_js` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Contrived example: # Wait until `Date.now()` returns a number that ends in a 5. (0 - 10 seconds) system.time(   app$wait_for_js(\"Math.floor((Date.now() / 1000) % 10) == 5;\") )  ## A second example where we run the contents of a JavaScript file ## and use the result to wait for a condition app$run_js(file = \"complicated_file.js\") app$wait_for_js(\"complicated_condition();\") } # }  ## ------------------------------------------------ ## Method `AppDriver$expect_unique_names` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ shiny_app <- shinyApp(   ui = fluidPage(     # Duplicate input IDs: `\"text\"`     textInput(\"text\", \"Text 1\"),     textInput(\"text\", \"Text 2\")   ),   server = function(input, output) {     # empty   } ) # Initial checking for unique names (default behavior) app <- AppDriver$new(shiny_app, check_names = TRUE) #> Warning: #> ! Shiny inputs should have unique HTML id values. #> i The following HTML id values are not unique: #> â€¢ text app$stop()  # Manually assert that all names are unique app <- AppDriver$new(shiny_app, check_names = FALSE) app$expect_unique_names() #> Error: `app_check_unique_names(self, private)` threw an unexpected warning. #> Message: ! Shiny inputs should have unique HTML id values. #> i The following HTML id values are not unique: #>   â€¢ text #> Class:   rlang_warning/warning/condition app$stop() } # }  ## ------------------------------------------------ ## Method `AppDriver$get_dir` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  identical(app$get_dir(), app_path) #> [1] TRUE } # }  ## ------------------------------------------------ ## Method `AppDriver$get_url` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  browseURL(app$get_url()) } # }  ## ------------------------------------------------ ## Method `AppDriver$get_window_size` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  app$get_window_size() #> $width #> [1] 992 #> #> $height #> [1] 1323 } # }  ## ------------------------------------------------ ## Method `AppDriver$set_window_size` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") # Set init window size app <- AppDriver$new(app_path, height = 1400, width = 1000)  app$get_window_size() #> $width #> [1] 1000 #> #> $height #> [1] 1400  # Manually set the window size app$set_window_size(height = 1080, width = 1920) app$get_window_size() #> $width #> [1] 1920 #> #> $height #> [1] 1080 } # }  ## ------------------------------------------------ ## Method `AppDriver$get_chromote_session` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  b <- app$get_chromote_session() b$Runtime$evaluate(\"1 + 1\") #> $result #> $result$type #> [1] \"number\" #> #> $result$value #> [1] 2 #> #> $result$description #> [1] \"2\" } # }  ## ------------------------------------------------ ## Method `AppDriver$get_variant` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\")  app <- AppDriver$new(app_path)  app$get_variant() #> NULL  app <- AppDriver$new(app_path, variant = platform_variant()) app$get_variant() #> [1] \"mac-4.1\" } # }  ## ------------------------------------------------ ## Method `AppDriver$get_logs` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app1 <- AppDriver$new(system.file(\"examples/01_hello\", package = \"shiny\"))  app1$get_logs() #> {shinytest2} R  info   10:00:28.86 Start AppDriver initialization #> {shinytest2} R  info   10:00:28.86 Starting Shiny app #> {shinytest2} R  info   10:00:29.76 Creating new ChromoteSession #> {shinytest2} R  info   10:00:30.56 Navigating to Shiny app #> {shinytest2} R  info   10:00:30.70 Injecting shiny-tracer.js #> {chromote}   JS info   10:00:30.75 shinytest2; jQuery found #> {chromote}   JS info   10:00:30.77 shinytest2; Waiting for shiny session to connect #> {chromote}   JS info   10:00:30.77 shinytest2; Loaded #> {shinytest2} R  info   10:00:30.77 Waiting for Shiny to become ready #> {chromote}   JS info   10:00:30.90 shinytest2; Connected #> {chromote}   JS info   10:00:30.95 shinytest2; shiny:busy #> {shinytest2} R  info   10:00:30.98 Waiting for Shiny to become idle for 200ms within 15000ms #> {chromote}   JS info   10:00:30.98 shinytest2; Waiting for Shiny to be stable #> {chromote}   JS info   10:00:31.37 shinytest2; shiny:idle #> {chromote}   JS info   10:00:31.38 shinytest2; shiny:value distPlot #> {chromote}   JS info   10:00:31.57 shinytest2; Shiny has been idle for 200ms #> {shinytest2} R  info   10:00:31.57 Shiny app started #> {shiny}      R  stderr ----------- Loading required package: shiny #> {shiny}      R  stderr ----------- Running application in test mode. #> {shiny}      R  stderr ----------- #> {shiny}      R  stderr ----------- Listening on http://127.0.0.1:4679   # To capture all websocket traffic, set `options = list(shiny.trace = TRUE)` app2 <- AppDriver$new(   system.file(\"examples/01_hello\", package = \"shiny\"),   options = list(shiny.trace = TRUE) )  app2$get_logs() ## (All WebSocket messages have been replaced with `WEBSOCKET_MSG` in example below) #> {shinytest2} R  info      10:01:57.49 Start AppDriver initialization #> {shinytest2} R  info      10:01:57.50 Starting Shiny app #> {shinytest2} R  info      10:01:58.20 Creating new ChromoteSession #> {shinytest2} R  info      10:01:58.35 Navigating to Shiny app #> {shinytest2} R  info      10:01:58.47 Injecting shiny-tracer.js #> {chromote}   JS info      10:01:58.49 shinytest2; jQuery not found #> {chromote}   JS info      10:01:58.49 shinytest2; Loaded #> {shinytest2} R  info      10:01:58.50 Waiting for Shiny to become ready #> {chromote}   JS info      10:01:58.55 shinytest2; jQuery found #> {chromote}   JS info      10:01:58.55 shinytest2; Waiting for shiny session to connect #> {chromote}   JS websocket 10:01:58.64 send WEBSOCKET_MSG #> {chromote}   JS websocket 10:01:58.67 recv WEBSOCKET_MSG #> {chromote}   JS info      10:01:58.67 shinytest2; Connected #> {chromote}   JS websocket 10:01:58.71 recv WEBSOCKET_MSG #> {chromote}   JS websocket 10:01:58.72 recv WEBSOCKET_MSG #> {chromote}   JS info      10:01:58.72 shinytest2; shiny:busy #> {chromote}   JS websocket 10:01:58.73 recv WEBSOCKET_MSG #> {chromote}   JS websocket 10:01:58.73 recv WEBSOCKET_MSG #> {shinytest2} R  info      10:01:58.75 Waiting for Shiny to become idle for 200ms within 15000ms #> {chromote}   JS info      10:01:58.75 shinytest2; Waiting for Shiny to be stable #> {chromote}   JS websocket 10:01:58.81 recv WEBSOCKET_MSG #> {chromote}   JS websocket 10:01:58.81 recv WEBSOCKET_MSG #> {chromote}   JS info      10:01:58.81 shinytest2; shiny:idle #> {chromote}   JS websocket 10:01:58.82 recv WEBSOCKET_MSG #> {chromote}   JS info      10:01:58.82 shinytest2; shiny:value distPlot #> {chromote}   JS info      10:01:59.01 shinytest2; Shiny has been idle for 200ms #> {shinytest2} R  info      10:01:59.01 Shiny app started #> {shiny}      R  stderr    ----------- Loading required package: shiny #> {shiny}      R  stderr    ----------- Running application in test mode. #> {shiny}      R  stderr    ----------- #> {shiny}      R  stderr    ----------- Listening on http://127.0.0.1:4560 #> {shiny}      R  stderr    ----------- SEND {\"config\":{\"workerId\":\"\",\"sessionId\"|truncated #> {shiny}      R  stderr    ----------- RECV {\"method\":\"init\",\"data\":{\"bins\":30,|truncated #> {shiny}      R  stderr    ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\":|truncated #> {shiny}      R  stderr    ----------- SEND {\"busy\":\"busy\"} #> {shiny}      R  stderr    ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\":|truncated #> {shiny}      R  stderr    ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated #> {shiny}      R  stderr    ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated #> {shiny}      R  stderr    ----------- SEND {\"busy\":\"idle\"} #> {shiny}      R  stderr    ----------- SEND {\"errors\":{},\"values\":{\"distPlot\":|truncated  # The log that is returned is a `data.frame()`. log <- app2$get_logs() tibble::glimpse(log) #> Rows: 43 #> Columns: 5 #> $ workerid  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦ #> $ timestamp <dttm> 2022-09-19 10:01:57, 2022-09-19 10:01:57, 2022-09-19 10:01:58, 2022â€¦ #> $ location  <chr> \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shinytest2\"â€¦ #> $ level     <chr> \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"infâ€¦ #> $ message   <chr> \"Start AppDriver initialization\", \"Starting Shiny app\", \"Creating neâ€¦ #> $ workerid  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦ #> $ timestamp <dttm> 2022-03-16 11:09:57, 2022-03-16 11:09:57, 2022-03-16 11:09:â€¦ #> $ location  <chr> \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shiâ€¦ #> $ level     <chr> \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"infâ€¦ #> $ message   <chr> \"Start AppDriver initialization\", \"Starting Shiny app\", \"Creâ€¦  # It may be filtered to find desired logs subset(log, level == \"websocket\") ## (All WebSocket messages have been replaced with `WEBSOCKET_MSG` in example below) #> {chromote} JS websocket 10:01:58.64 send WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.67 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.71 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.72 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.73 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.73 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.81 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.81 recv WEBSOCKET_MSG #> {chromote} JS websocket 10:01:58.82 recv WEBSOCKET_MSG } # }  ## ------------------------------------------------ ## Method `AppDriver$log_message` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  app$log_message(\"Setting bins to smaller value\") app$set_inputs(bins = 10) app$get_logs() } # }  ## ------------------------------------------------ ## Method `AppDriver$stop` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ rlang::check_installed(\"reactlog\")  library(shiny) shiny_app <- shinyApp(   ui = fluidPage(     actionButton(\"button\", \"Stop app and return Reactlog\"),     \"Click count:\", textOutput(\"count\")   ),   server = function(input, output) {     output$count <- renderText({ input$button })     observe({       req(input$button)       stopApp(shiny::reactlog())     })   } )  app <- AppDriver$new(   shiny_app,   # Enable reactlog in background R session   options = list(shiny.reactlog = TRUE) )  app$click(\"button\") rlog <- app$stop() str(head(rlog, 2)) #> List of 2 #> $ :List of 7 #> ..$ action : chr \"define\" #> ..$ reactId: chr \"r3\" #> ..$ label  : chr \"Theme Counter\" #> ..$ type   : chr \"reactiveVal\" #> ..$ value  : chr \" num 0\" #> ..$ session: chr \"bdc7417f2fc8c84fc05c9518e36fdc44\" #> ..$ time   : num 1.65e+09 #> $ :List of 7 #> ..$ action : chr \"define\" #> ..$ reactId: chr \"r4\" #> ..$ label  : chr \"output$count\" #> .. ..- attr(*, \"srcref\")= int [1:6] 7 32 7 45 32 45 #> .. ..- attr(*, \"srcfile\")= chr \"\" #> ..$ type   : chr \"observer\" #> ..$ value  : chr \" NULL\" #> ..$ session: chr \"bdc7417f2fc8c84fc05c9518e36fdc44\" #> ..$ time   : num 1.65e+09 } # }"},{"path":"https://rstudio.github.io/shinytest2/reference/compare_screenshot_threshold.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare screenshots given threshold value â€” compare_screenshot_threshold","title":"Compare screenshots given threshold value â€” compare_screenshot_threshold","text":"chromote can sometimes produce screenshot images non-deterministic (yet close) color values. can happen locations rounded corners divs textareas.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/compare_screenshot_threshold.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare screenshots given threshold value â€” compare_screenshot_threshold","text":"","code":"compare_screenshot_threshold(   old,   new,   ...,   threshold = getOption(\"shinytest2.compare_screenshot.threshold\", NULL),   kernel_size = getOption(\"shinytest2.compare_screenshot.kernel_size\", 5),   quiet = FALSE )  screenshot_max_difference(   old,   new = missing_arg(),   ...,   kernel_size = getOption(\"shinytest2.compare_screenshot.kernel_size\", 5) )"},{"path":"https://rstudio.github.io/shinytest2/reference/compare_screenshot_threshold.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare screenshots given threshold value â€” compare_screenshot_threshold","text":"old Current screenshot file path new New screenshot file path ... Must empty. Allows parameter expansion. threshold threshold maximum allowed image difference (see details). default NULL can set globally via shinytest2.compare_screenshot.threshold option. value threshold NULL, compare_screenshot_threshold() act like testthat::compare_file_binary. However, threshold positive number, compared largest convolution value found two images fail testthat::compare_file_binary comparison. max value can found 4 * kernel_size ^ 2. Threshold values values 5 help deter false-positive screenshot comparisons (inconsistent rounded corners). Larger values 10s 100s help find real changes. However, values one size fits need play threshold fits needs. find current difference two images, use screenshot_max_difference(). kernel_size kernel_size represents height width convolution kernel applied matrix pixel differences. integer-like value relatively small, 5. default value can set via shinytest2.compare_screenshot.kernel_size option. quiet FALSE value larger threshold, message printed console. helpful getting failing image informed different new image old image.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/compare_screenshot_threshold.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compare screenshots given threshold value â€” compare_screenshot_threshold","text":"differences make comparing screenshots impractical using traditional expectation methods false-positives produced often time. mitigate , can use fuzzy matching algorithm can tolerate small regional differences throughout image. local changes found larger threshold, images determined different. screenshot difference threshold size kernel (kernel_size) can set tune false positive rate.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/compare_screenshot_threshold.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Compare screenshots given threshold value â€” compare_screenshot_threshold","text":"compare_screenshot_threshold(): Compares two images allows threshold difference many units RGBA color channel. suggested use method AppDriver$expect_screenshot(threshold=, kernel_size=) make expectations screenshots given particular threshold kernel_size values. screenshot_max_difference(): Finds difference two screenshots. value can used compare_screenshot_threshold(threshold=). recommended value used compare_screenshot_threshold(threshold=) larger immediate max difference found. allows random fluctuations rounding sub pixels. new missing, use file value old (FILE.png) default FILE.new.png","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/compare_screenshot_threshold.html","id":"algorithm-for-the-difference-between-two-screenshots","dir":"Reference","previous_headings":"","what":"Algorithm for the difference between two screenshots","title":"Compare screenshots given threshold value â€” compare_screenshot_threshold","text":"First two images compared using testthat::compare_file_binary(). files identical, return TRUE screenshot images . threshold NULL, return FALSE convolution occur. Prepare screenshot difference matrix reading RGBA channels image find respective absolute differences Sum screenshot difference matrix channels pixel location Perform convolution using small square kernel matrix kernel_size big filled 1s. Find largest value resulting convolution matrix. max convolution value larger threshold, return FALSE, images different. Otherwise, return TRUE, images .","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/compare_screenshot_threshold.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare screenshots given threshold value â€” compare_screenshot_threshold","text":"","code":"img_folder <- system.file(\"example/imgs/\", package = \"shinytest2\") slider_old <- fs::path(img_folder, \"slider-old.png\") slider_new <- fs::path(img_folder, \"slider-new.png\")  # Can you see the differences between these two images? showimage::show_image(slider_old)  showimage::show_image(slider_new)   # You might have caught the difference between the two images! slider_diff <- fs::path(img_folder, \"slider-diff.png\") showimage::show_image(slider_diff)   # Let's find the difference between the two images screenshot_max_difference(slider_old, slider_new) #> [1] 28.11765 # ~ 28  # Using different threshold values... compare_screenshot_threshold(slider_old, slider_new, threshold = NULL) #> [1] FALSE #> FALSE # Images are not identical compare_screenshot_threshold(slider_old, slider_new, threshold = 25) #> ! Maximum screenshot convolution value `28.1176470588235` > `25` (threshold). #> â€¢ `old`:/home/runner/work/_temp/Library/shinytest2/example/imgs/slider-old.png #> â€¢ `new`:/home/runner/work/_temp/Library/shinytest2/example/imgs/slider-new.png #> â„¹ (To remove this message, increase `threshold`, or set `quiet = TRUE`) #> [1] FALSE #> FALSE # Images are more different than 25 units compare_screenshot_threshold(slider_old, slider_new, threshold = 30) #> [1] TRUE #> TRUE # Images are not as different as 30 units  #########################  # Now let's look at two fairly similar images bookmark_old <- fs::path(img_folder, \"bookmark-old.png\") bookmark_new <- fs::path(img_folder, \"bookmark-new.png\")  # Can you see the difference between these two images? # (Hint: Focused corners) showimage::show_image(bookmark_old)  showimage::show_image(bookmark_new)   # Can you find the red pixels showing the differences? # Hint: Look in the corners of the focused text bookmark_diff <- fs::path(img_folder, \"bookmark-diff.png\") showimage::show_image(bookmark_diff)   # Let's find the difference between the two images screenshot_max_difference(bookmark_old, bookmark_new) #> [1] 0.2705882 # ~ 0.25  # Using different threshold values... compare_screenshot_threshold(bookmark_old, bookmark_new, threshold = NULL) #> [1] FALSE #> FALSE # Images are not identical compare_screenshot_threshold(bookmark_old, bookmark_new, threshold = 5) #> [1] TRUE #> TRUE # Images are not as different than 5 units"},{"path":"https://rstudio.github.io/shinytest2/reference/load_app_env.html","id":null,"dir":"Reference","previous_headings":"","what":"Load the Shiny application's support environment â€” load_app_env","title":"Load the Shiny application's support environment â€” load_app_env","text":"Executes ./R files global.R current environment. useful wanting access functions values created ./R folder testing purposes.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/load_app_env.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load the Shiny application's support environment â€” load_app_env","text":"","code":"load_app_env(   app_dir = \"../../\",   renv = rlang::caller_env(),   globalrenv = rlang::caller_env() )"},{"path":"https://rstudio.github.io/shinytest2/reference/load_app_env.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load the Shiny application's support environment â€” load_app_env","text":"app_dir base directory Shiny application. renv environment files `R/â€œ directory evaluated. globalrenv environment global.R evaluated. NULL, global.R evaluated .","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/load_app_env.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load the Shiny application's support environment â€” load_app_env","text":"Loading files automatically performed test_app() must called ./tests/testthat/setup-shinytest2.R access support file objects desired.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":null,"dir":"Reference","previous_headings":"","what":"Migrate shinytest tests â€” migrate_from_shinytest","title":"Migrate shinytest tests â€” migrate_from_shinytest","text":"function migrate standard shinytest test files new shinytest2 + testthat ed 3 snapshot format.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Migrate shinytest tests â€” migrate_from_shinytest","text":"","code":"migrate_from_shinytest(   app_dir,   ...,   clean = TRUE,   include_expect_screenshot = missing_arg(),   quiet = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Migrate shinytest tests â€” migrate_from_shinytest","text":"app_dir Directory containing Shiny application Shiny Rmd file ... Must empty. Allows parameter expansion. clean TRUE, shinytest test directory runner deleted migration use shinytest2. include_expect_screenshot TRUE, ShinyDriver$snapshot() turn AppDriver$expect_values() AppDriver$expect_screenshot(). FALSE, ShinyDriver$snapshot() turn AppDriver$expect_values(). missing, include_expect_screenshot behave FALSE shinytest::testApp(compareImages = FALSE) ShinyDriver$snapshotInit(screenshot = FALSE) called. quiet Logical determines migration information steps printed console.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Migrate shinytest tests â€” migrate_from_shinytest","text":"Invisible TRUE","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Migrate shinytest tests â€” migrate_from_shinytest","text":"shinytest file contents traversed converted new shinytest2 format. shinytest code can directly seen code, converted.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/platform_variant.html","id":null,"dir":"Reference","previous_headings":"","what":"Platform specific variant â€” platform_variant","title":"Platform specific variant â€” platform_variant","text":"Returns string used within testthat's' snapshot testing. Currently, Operating System R Version (major, minor, patch version) returned.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/platform_variant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Platform specific variant â€” platform_variant","text":"","code":"platform_variant(..., os_name = TRUE, r_version = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/reference/platform_variant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Platform specific variant â€” platform_variant","text":"... Must empty. Allows parameter expansion. os_name TRUE, include OS name output r_version TRUE, include major minor version R version, patch version","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/platform_variant.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Platform specific variant â€” platform_variant","text":"information needed future distinguish standard testing environments, function updated accordingly.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Launch test event recorder for a Shiny app â€” record_test","title":"Launch test event recorder for a Shiny app â€” record_test","text":"recording completed, create append new shinytest2 test testthat test_file.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Launch test event recorder for a Shiny app â€” record_test","text":"","code":"record_test(   app = \".\",   ...,   name = NULL,   seed = NULL,   load_timeout = NULL,   shiny_args = list(),   test_file = \"test-shinytest2.R\",   open_test_file = rlang::is_interactive(),   allow_no_input_binding = NULL,   record_screen_size = TRUE,   run_test = TRUE )"},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Launch test event recorder for a Shiny app â€” record_test","text":"app AppDriver object, path Shiny application. ... Must empty. Allows parameter expansion. name Name provided AppDriver. value unique tests within test file. unique, different expect methods may overwrite . seed random seed set running app. seed also used test script. load_timeout Maximum time wait Shiny application load, milliseconds. value provided, saved test script. shiny_args list options pass runApp(). value provided, saved test script. test_file Base file name testthat test file. open_test_file TRUE, test file opened editor via file.edit() executing. allow_no_input_binding value controls events without input bindings recorded. TRUE, events without input bindings recorded. FALSE, events without input bindings recorded. NULL (default), updated input corresponding input, modal dialog shown asking unbound input events recorded. See AppDriver$set_inputs() information. record_screen_size TRUE, screen size recorded initialized changed. run_test TRUE, test_file executed saving recording.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":"uploading-files","dir":"Reference","previous_headings":"","what":"Uploading files","title":"Launch test event recorder for a Shiny app â€” record_test","text":"Files uploaded Shiny app must located somewhere within tests/testthat subdirectory available via system.file(). Files uploaded recording valid path warning inserted code. Please fix file path moving file tests/testthat subdirectory using system.file(). fixing path, remove line warning code.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Launch test event recorder for a Shiny app â€” record_test","text":"","code":"if (FALSE) { # \\dontrun{ record_test(\"path/to/app\") } # }"},{"path":"https://rstudio.github.io/shinytest2/reference/register_input_processor.html","id":null,"dir":"Reference","previous_headings":"","what":"Register an input processor for the test recorder â€” register_input_processor","title":"Register an input processor for the test recorder â€” register_input_processor","text":"register_input_processor() registers input processor used test recorder. input processor function take one parameter, value, return string R code returns desired value. get_input_processors() returns named list registered input processor functions.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/register_input_processor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Register an input processor for the test recorder â€” register_input_processor","text":"","code":"register_input_processor(input_type, processor)  get_input_processors()"},{"path":"https://rstudio.github.io/shinytest2/reference/register_input_processor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Register an input processor for the test recorder â€” register_input_processor","text":"input_type name input type, example, \"mypkg.numberinput\". processor input processor function.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":null,"dir":"Reference","previous_headings":"","what":"Test Shiny applications with testthat â€” test_app","title":"Test Shiny applications with testthat â€” test_app","text":"helper method wraps around testthat::test_dir() test Shiny application Shiny runtime document.  similar testthat::test_check() tests R package app.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test Shiny applications with testthat â€” test_app","text":"","code":"test_app(   app_dir = missing_arg(),   ...,   name = missing_arg(),   check_setup = TRUE,   reporter = testthat::get_reporter(),   stop_on_failure = missing_arg() )"},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test Shiny applications with testthat â€” test_app","text":"app_dir base directory Shiny application. app_dir missing test_app() called within ./tests/testthat.R file, parent directory (\"../\") used. Otherwise, default path \".\" used. ... Parameters passed testthat::test_dir() name Name display middle test name. value used calling test_app() inside testhat test. final testing context format \"{test_context} - {name} - {app_test_context}\". check_setup TRUE, app checked presence ./tests/testthat/setup-shinytest2.R. file must contain call load_app_env(). reporter Reporter pass testthat::test_dir(). stop_on_failure missing, default value TRUE used. However, missing currently testing, FALSE used seamlessly integrate app reporter reporter.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test Shiny applications with testthat â€” test_app","text":"Example usage:","code":"## Interactive usage # Test Shiny app in current working directory shinytest2::test_app()  # Test Shiny app in another directory path_to_app <- \"path/to/app\" shinytest2::test_app(path_to_app)  ## File: ./tests/testthat.R # Will find Shiny app in \"../\" shinytest2::test_app()  ## File: ./tests/testthat/test-shinytest2.R # Test a shiny application within your own {testthat} code test_that(\"Testing a Shiny app in a package\", {   shinytest2::test_app(path_to_app) })"},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"uploading-files","dir":"Reference","previous_headings":"","what":"Uploading files","title":"Test Shiny applications with testthat â€” test_app","text":"testing application, non-temp files uploaded located ./tests/testthat directory. allows tests portable self contained. recording test record_test(), every uploaded file located outside ./tests/testthat, warning thrown. file path fixed, may remove warning statement.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"different-ways-to-test","dir":"Reference","previous_headings":"","what":"Different ways to test","title":"Test Shiny applications with testthat â€” test_app","text":"test_app() opinionated testing function execute testthat tests ./tests/testthat folder. (rare reason) non-testthat tests execute, can call shiny::runTests(). method generically run test runners associated tests.","code":"# Execute a single Shiny app's {testthat} file such as `./tests/testthat/test-shinytest2.R` test_app(filter = \"shinytest2\")  # Execute all {testthat} tests test_app()  # Execute all tests for all test runners shiny::runTests()"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":null,"dir":"Reference","previous_headings":"","what":"Use shinytest2 with your Shiny application â€” use_shinytest2","title":"Use shinytest2 with your Shiny application â€” use_shinytest2","text":"Use shinytest2 Shiny application","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use shinytest2 with your Shiny application â€” use_shinytest2","text":"","code":"use_shinytest2(   app_dir = \".\",   runner = missing_arg(),   setup = missing_arg(),   ignore = missing_arg(),   package = missing_arg(),   ...,   quiet = FALSE,   overwrite = FALSE )  use_shinytest2_test(   app_dir = \".\",   open = rlang::is_interactive(),   quiet = FALSE,   overwrite = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use shinytest2 with your Shiny application â€” use_shinytest2","text":"app_dir base directory Shiny application runner TRUE, creates shinytest2 test runner ./tests/testthat.R setup TRUE, creates setup file called ./tests/testthat/setup-shinytest2.R containing call load_app_env() ignore TRUE, adds entries .Rbuildignore .gitignore ignore new debug screenshots. (*_.new.png) package TRUE, adds shinytest2 Suggests DESCRIPTION file. ... Must empty. Allows parameter expansion. quiet TRUE, console output suppressed. overwrite TRUE, test file test runner overwritten. open TRUE, test file opened editor via file.edit() saving.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Use shinytest2 with your Shiny application â€” use_shinytest2","text":"use_shinytest2(): usethis-style method initializes many different useful features using shinytest2: runner: Creates shinytest2 test runner ./tests/testthat.R. file contain call test_app(). setup: Creates ./tests/testthat/setup-shinytest2.R add Shiny ./R objects functions testing environment. file run testing begins. ignore: Add entry ./Rbuildignore (exists) .gitignore ignore new debug screenshots. (*_.new.png) package: Adds shinytest Suggests packages DESCRIPTION file (exists). values missing, remaining missing values set FALSE. allows use_shinytest2() add flags future versions without opting changes inadvertently. use_shinytest2_test(): Creates test file called ./tests/testthat/test-shinytest2.R. default, file's template test initialize Shiny application expect initial values. method also set test runner exist.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use shinytest2 with your Shiny application â€” use_shinytest2","text":"","code":"# Set up shinytest2 testing configs if (FALSE) use_shinytest2() # \\dontrun{} # Set up a shinytest2 test if (FALSE) use_shinytest2_test() # \\dontrun{}"},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-041","dir":"Changelog","previous_headings":"","what":"shinytest2 0.4.1","title":"shinytest2 0.4.1","text":"CRAN release: 2025-04-11","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"bug-0-4-1","dir":"Changelog","previous_headings":"","what":"Bug","title":"shinytest2 0.4.1","text":"Fixed bug AppDriver$expect_values(transform=) default value caused error thrown. (#413)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-040","dir":"Changelog","previous_headings":"","what":"shinytest2 0.4.0","title":"shinytest2 0.4.0","text":"CRAN release: 2025-04-10","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"breaking-changes-0-4-0","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"shinytest2 0.4.0","text":"shinytest2 skip test CRAN AppDriver initialized. request CRAN, using {chromote} CRAN package testing avoided can create failing tests time due application changes within testing machine, changes package code. Since AppDriver directly depends chromote test Shiny applications, creating AppDriver always skip current test CRAN package testing. decision made achieve consistent testing behavior time (rather silently skipping tests expected run due Chrome update). escape behavior, can set system environment variable SHINYTEST2_APP_DRIVER_TEST_ON_CRAN=1. Following chromoteâ€™s recommendation, test R package CI environment, ideally weekly monthly schedule test Shiny app latest R package versions. (#407)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"bug--improvements-0-4-0","dir":"Changelog","previous_headings":"","what":"Bug / Improvements","title":"shinytest2 0.4.0","text":"Add support $click()ing bslibâ€™s input_task_button() (#389). Improved error message app takes long start (@LouisLeNezet, #394). threshold kernel_size default values AppDriver$expect_screenshot() method now configurable via two new global options: shinytest2.compare_screenshot.threshold shinytest2.compare_screenshot.kernel_size (#401) shinytest2 now imports cli longer imports crayon (@olivroy, #399). Added {testthat}â€™s snapshot file transform= parameter support AppDriver$expect_download() AppDriver$expect_values(). allows text transformations snapshot files compared. (#403)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-032","dir":"Changelog","previous_headings":"","what":"shinytest2 0.3.2","title":"shinytest2 0.3.2","text":"CRAN release: 2024-04-28","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"bug--improvements-0-3-2","dir":"Changelog","previous_headings":"","what":"Bug / Improvements","title":"shinytest2 0.3.2","text":"shinytest2 now uses rlang longer depends ellipsis (@olivroy, #382). shinytest2 now warns rather erroring potentially non-existent global variable found server function, column names passed dplyr::select() (thanks @matt-sd-watson @MichalLauer, #385).","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-031","dir":"Changelog","previous_headings":"","what":"shinytest2 0.3.1","title":"shinytest2 0.3.1","text":"CRAN release: 2023-08-26","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"breaking-changes-0-3-1","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"shinytest2 0.3.1","text":"AppDriver$get_screenshot()/AppDriver$expect_screenshot() now default underlying deviceScaleFactor option 0 instead 1. ensures image sizes consistent across devices. revert prior behavior, provide screenshot_args = list(scale = 1) get_screenshot()/expect_screenshot() (#350).","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"bug--improvements-0-3-1","dir":"Changelog","previous_headings":"","what":"Bug / Improvements","title":"shinytest2 0.3.1","text":"shinytest2 longer checks computer running tests connected internet determining shinytest2 can connect server hosting Shiny app tested. (@Riraro #364)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-030","dir":"Changelog","previous_headings":"","what":"shinytest2 0.3.0","title":"shinytest2 0.3.0","text":"CRAN release: 2023-08-15","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"breaking-changes-0-3-0","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"shinytest2 0.3.0","text":"AppDriver$get_screenshot(selector=), AppDriver$expect_screenshot(selector=)â€™s default selector value changed HTML DOM selector \"html\" \"scrollable_area\". \"scrollable_area\" custom shinytest2 selector take screenshot entire scrollable area. breaking change, new default value intuitive robust non-standard CSS height width values fail \"html\". (#325)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"new-features-0-3-0","dir":"Changelog","previous_headings":"","what":"New features","title":"shinytest2 0.3.0","text":"AppDriver$get_screenshot(selector=), AppDriver$expect_screenshot(selector=), corresponding selector values inside screenshot_args=, gained two custom shinytest2 values: \"scrollable_area\" \"viewport\". \"scrollable_area\" new default value takes screenshot entire scrollable area. intuitive previous value HTML DOM selector \"html\" may result surprising height width. \"viewport\" take screenshot current browser viewport. means take screenshot whatever $view() currently looking . (#325) GitHub Action rstudio/shinytest2/actions/test-app added support multiple directories app-dir. can supplied using multiline string yaml syntax. See use-ci vignette details. (#332) GitHub Action rstudio/shinytest2/actions/test-app changed default value upload-snapshots false true. preparation automated snapshot handling. (#332)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"bug--improvements-0-3-0","dir":"Changelog","previous_headings":"","what":"Bug / Improvements","title":"shinytest2 0.3.0","text":"Set directory Shiny App directory starting background R process. allows local .Rprofile .Renviron files found naturally. (#275)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-021","dir":"Changelog","previous_headings":"","what":"shinytest2 0.2.1","title":"shinytest2 0.2.1","text":"CRAN release: 2023-02-21 Fixed request CRAN correct C++11 problems web checks (#326) Fixed bug compare_screenshot_threshold() safe guard errors thrown screenshot_max_difference() (#276) Fixed bug preview overflow length 1 (@cpsievert #291) Better support saving global variables Shiny server function (#307) Better error message app.R server.R found (#284) Force JS code character glue support (#288)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-020","dir":"Changelog","previous_headings":"","what":"shinytest2 0.2.0","title":"shinytest2 0.2.0","text":"CRAN release: 2022-09-26","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shiny-log-levels-0-2-0","dir":"Changelog","previous_headings":"Breaking changes","what":"Shiny log levels","title":"shinytest2 0.2.0","text":"AppDriver$get_logs() changed level values location equals \"shiny\". levels \"error\" \"info\" renamed \"stderr\" \"stdout\". (#265)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"download-snapshot-files-0-2-0","dir":"Changelog","previous_headings":"Breaking changes","what":"Download snapshot files","title":"shinytest2 0.2.0","text":"downloaded snapshots contain counter prefix (e.g.Â 003- 003-my_custom_name.txt) avoid two files point snapshot file location. Sharing snapshot file dangerous last file written stored truth, overwriting knowledge original file. (#261) content-disposition header provided AppDriver$expect_download(name = NULL) (default), snapshot file try saved using content-disposition header value. paired compare = NULL (default), testthat choose proper compare method compare_file_text() compare_file_binary(). See ?testthat::expect_snapshot_file details. (#261) AppDriver$expect_download() now download snapshot files using sanitized file name, e.g.Â AppDriver$expect_download(name = \"/custom/name.txt\") stored file tests/testthat/_snaps/003-my_custom_name.txt. (#261)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"timeout-values-0-2-0","dir":"Changelog","previous_headings":"Breaking changes","what":"Timeout values","title":"shinytest2 0.2.0","text":"default timeout values many AppDriver methods altered shown table . (#263) AppDriver$new(load_timeout=) initialized using first numeric value found: 1. Supplied directly: AppDriver$new(load_timeout=) 2. Locally defined option: options(shinytest2.load_timeout=) 3. System environment variable: SHINYTEST2_LOAD_TIMEOUT 4. 15 * 1000 (15s) AppDriver$new(timeout=) initialized using first numeric value found: 1. Supplied directly: AppDriver$new(timeout=) 2. Locally defined option: options(shinytest2.timeout=) 3. System environment variable: SHINYTEST2_TIMEOUT 4. 4 * 1000 (4s) AppDriver$stop(signal_timeout=) initialized using first numeric value found: 1. Supplied directly: AppDriver$stop(signal_timeout=) 2. Locally defined option: options(shinytest2.signal_timeout=) 3. System environment variable: SHINYTEST2_SIGNAL_TIMEOUT 4. system environment variable R_COVR=true: 20 * 1000 (20s) 5. 500 (0.5s) remaining AppDriver methods default timeout timeout_ parameters initialized AppDriver$new(timeout=) value. example, app <- AppDriver$new(timeout = 500) app$get_js(timeout=) default 500 milliseconds.","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"new-features-0-2-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"shinytest2 0.2.0","text":"compare_screenshot_threshold() new method compare screenshots allow small differences two screenshots. method checks every subset matrix pixel differences two images. total difference larger threshold value, two images considered different. subset matrix size can increased setting kernel_size. (#231) Support supplying compare method AppDriver$expect_screenshot(compare=) added. default, AppDriver$expect_screenshot(compare=) set compare_screenshot_threshold(threshold = NULL) equivalent testthat::compare_file_binary(). default screenshot expectation behavior changed. (#231) test_app() now inherits existing test reporter testing multiple apps within package test file. allows seamless, single reporter output instead nested reporters displayed. (#192) recording browser window now closed either â€œSave test exitâ€ â€œExitâ€ buttons clicked. (@daattali, #202) testing chromote can started, test skipped. testing windows CI, chromote get extra attempt started (#225) Make globals Imports package, instead Suggests package (#223) Add support recording screen size recording test (#223)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"bug--improvements-0-2-0","dir":"Changelog","previous_headings":"","what":"Bug / Improvements","title":"shinytest2 0.2.0","text":"Fix set bugs found @daattali including test files opened IDE recording test replace missing images website (#199) Provide example workflows use rstudio/shinytest2/actions/test-app GHA action (#217) setting date time slider value, can now handle array inputs properly. recording date time slider value, numeric values recorded milliseconds instead seconds since epoch. (#223) creating test setup file shinytest2, use file path tests/testthat/setup-shinytest2.R instead tests/testthat/setup.R provide quick context within file name (#224) Remove trailing comma causing render bug recorder app (@mehrnoushmalek, #239) Update {lintr} lints v3 (#240) Fixed GHA links rstudio/shinytest2/actions/test-app@v1 (#249) Fix documentation AppDriverâ€™s delay parameter seconds, milliseconds (#255) Escape JS text supplied AppDriver$wait_for_js(script=) (#258) Added support AppDriver$stop(signal_timeout=). default timeout sending SIGINT, SIGTERM, SIGKILL signals shiny process now 500ms. However, covr running, default timeout 20,000 ms allow time report generate. (#259, #263) Add example FAQ entry test bookmarking (#262) Added DOI badge README.md (#267)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-011","dir":"Changelog","previous_headings":"","what":"shinytest2 0.1.1","title":"shinytest2 0.1.1","text":"CRAN release: 2022-09-06 Update docs CRAN (#253)","code":""},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-010","dir":"Changelog","previous_headings":"","what":"shinytest2 0.1.0","title":"shinytest2 0.1.0","text":"CRAN release: 2022-04-27 Initial release package","code":""}]
