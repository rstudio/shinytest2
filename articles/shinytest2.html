<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with shinytest2 • shinytest2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with shinytest2">
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinytest2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/shinytest2.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/in-depth.html">Testing in depth</a></li>
    <li><a class="dropdown-item" href="../articles/robust.html">Robust testing</a></li>
    <li><a class="dropdown-item" href="../articles/use-application-audit.html">Auditing Shiny apps</a></li>
    <li><a class="dropdown-item" href="../articles/use-ci.html">Using shinytest2 with continuous integration</a></li>
    <li><a class="dropdown-item" href="../articles/use-package.html">Using shinytest2 with R packages</a></li>
    <li><a class="dropdown-item" href="../articles/using-monkey-testing.html">Monkey testing</a></li>
    <li><a class="dropdown-item" href="../articles/z-migration.html">Migrating from shinytest</a></li>
    <li><a class="dropdown-item" href="../articles/zzz-faq.html">Frequently Asked Questions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/shinytest2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Getting started with shinytest2</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/shinytest2/blob/rc-0.4.1/vignettes/shinytest2.Rmd" class="external-link"><code>vignettes/shinytest2.Rmd</code></a></small>
      <div class="d-none name"><code>shinytest2.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="why-test-shiny-applications">Why test Shiny applications?<a class="anchor" aria-label="anchor" href="#why-test-shiny-applications"></a>
</h2>
<p>After you get your Shiny application to a state where it works, it’s
often useful to have an automated system that checks that it continues
to work as expected. There are many possible reasons for an application
to stop working. These reasons include:</p>
<ul>
<li><p>An upgraded R package has different behavior. (This could include
Shiny itself!)</p></li>
<li><p>You make modifications to your application.</p></li>
<li><p>An external data source stops working, or returns data in a
changed format.</p></li>
</ul>
<p>One way to detect these problems is with manual testing – in other
words, by having a person interact with the app in a browser – but this
can be time-intensive, inconsistent, and imprecise. Having automated
tests can alert you to these kinds of problems quickly and with almost
zero effort, after the tests have been created.</p>
</div>
<div class="section level2">
<h2 id="how-testing-works-with-shinytest2">How testing works with shinytest2<a class="anchor" aria-label="anchor" href="#how-testing-works-with-shinytest2"></a>
</h2>
<p>The <a href="https://rstudio.github.io/shinytest2/">shinytest2</a> package provides tools for creating and
running automated tests on Shiny applications.</p>
<p><a href="https://rstudio.github.io/shinytest2/">shinytest2</a> uses <a href="https://testthat.r-lib.org" class="external-link">testthat</a>’s
snapshot-based testing strategy. The first time it runs a set of tests
for an application, it performs some scripted interactions with the app
and takes one or more snapshots of the application’s state. These
snapshots are saved to disk so that future runs of the tests can compare
their results to them.</p>
<p>To create tests, the easiest method is to use the
<code><a href="../reference/record_test.html">record_test()</a></code> function. This launches the application in a
web browser and records your interactions with the application. These
interactions are saved in <code>tests/testthat/test-shinytest2.R</code>
and are run using the strategy described above.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>Begin by installing <a href="https://rstudio.github.io/shinytest2/">shinytest2</a> from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"shinytest2"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="recording-tests">Recording tests<a class="anchor" aria-label="anchor" href="#recording-tests"></a>
</h3>
<p>This is the general procedure for recording tests:</p>
<ul>
<li><p>Run <code><a href="../reference/record_test.html">record_test()</a></code> to launch the app in a test
recorder.</p></li>
<li><p>Create the tests by interacting with the application and telling
the recorder to make an expectation on the state at various
points.</p></li>
<li>
<p>Quit the test recorder. When you do this, three things will
happen:</p>
<ul>
<li><p>The test script will be saved in
<code>tests/testthat/test-shinytest2.R</code> in a subdirectory of the
application.</p></li>
<li><p>If you are running in the RStudio IDE, it will automatically open
this file in the editor.</p></li>
<li><p>The tests will execute</p></li>
</ul>
</li>
</ul>
<p>To record tests, we first need an app.</p>
<p>Here is a simple app that I’ve placed in
<code>simple-app/app.R</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"What is your name?"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="st">"greet"</span>, <span class="st">"Greet"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"greeting"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">greeting</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">greet</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hello "</span>, <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/isolate.html" class="external-link">isolate</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>, <span class="st">"!"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
<p>To test it, I now load {shinytest2}, and call
<code><a href="../reference/record_test.html">record_test()</a></code> with the path to my app:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/shinytest2/">shinytest2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/record_test.html">record_test</a></span><span class="op">(</span><span class="st">"simple-app/"</span><span class="op">)</span></span></code></pre></div>
<p>In a separate R process, this launches the Shiny application to be
tested. We’ll refer to this as the <strong>target app</strong>. This
also launches a special Shiny application in the current R process which
displays the target app in an iframe and has some controls outside the
iframe. We’ll refer to this as the <strong>recorder app</strong>. You
will see something like this:</p>
<p><img src="images%2Frecord-simple-app.png" width="100%" style="display: block; margin: auto;"></p>
<p>On the left is the target app (in this case, the “What is your name”
app), and on the right is the recorder app sidebar. Note that you may
need to make the browser window wider because the recorder sidebar
occupies some space.</p>
<p>The sidebar on the right displays some controls for the test
recorder, as well as a the set of <strong>Code</strong> for all
expectations and actions. As you interact with the target app – in other
words, when you set inputs on the app – you will see those actions
recorded in the Code output.</p>
<p>For testing a Shiny application, setting inputs is only one part.
It’s also necessary to check that the application produces the correct
<code>output</code>s. This is accomplished by taking expectations of the
application’s state.</p>
<p>There are two ways to record <code>output</code> values. One way is
to take an <strong>expectation</strong> of the application’s state. This
will record all <code>input</code> values, <code>output</code> values,
and <code>export</code>ed values (more on exported values later). To do
this, click the <code>Expect Shiny values</code> button on the recorder
app.</p>
<p>After modifying some <code>input</code>s and making an expectation,
it will look something like this:</p>
<p><img src="images%2Frecord-simple-app-2.png" width="100%" style="display: block; margin: auto;"></p>
<p>It is also possible to take a <em>targeted</em> value expectation.
This is a snapshot of one or more specified <code>output</code> (instead
of the default, which is to snapshot the entire application). To do
this, hold down the Control (or Command) button on your keyboard and
click on an <code>output</code>; it will snapshot just that one
<code>output</code>.</p>
<p>When you are done recording a sequence of events, click on the
<code>Save test and exit</code> button. If you are in the RStudio IDE,
it will open the test script
<code>tests/testthat/test-shinytest2.R</code> from a subdirectory of the
application.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># File: tests/testthat/test-shinytest2.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/shinytest2/">shinytest2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"{shinytest2} recording: simple-app"</span>, <span class="op">{</span></span>
<span>  <span class="va">app</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppDriver.html">AppDriver</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"simple-app"</span>, height <span class="op">=</span> <span class="fl">407</span>, width <span class="op">=</span> <span class="fl">348</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">set_inputs</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Barret"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span><span class="st">"greet"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_values</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-tests">Running tests<a class="anchor" aria-label="anchor" href="#running-tests"></a>
</h3>
<p>When you quit the test recorder, it will automatically run the test
script. There are three separate components involved in running the
tests:</p>
<ol style="list-style-type: decimal">
<li><p>First is the <strong>test driver</strong>. This is the R process
that coordinates the testing and controls the web browser. When working
on creating tests interactively, this is the R process that you
use.</p></li>
<li><p>Next is the <strong>Shiny process</strong>, also known as the
<strong>server</strong>. This is the R process that runs the target
Shiny application.</p></li>
<li><p>Finally, there is the <strong>web browser</strong>, also known as
the <strong>client</strong>, which connects to the server. This is a
headless web browser – one which renders the web page internally, but
doesn’t display the content to the screen (<a href="https://rstudio.github.io/chromote/" class="external-link"><code>{chromote}</code></a>).</p></li>
</ol>
<p>When you exit the test recorder, it will (by default) automatically
run the test script and will print something like this:</p>
<pre><code>• Saving test runner: tests/testthat.R
• Saving test file: tests/testthat/test-shinytest2.R
• Running recorded test: tests/testthat/test-shinytest2.R
✔ | F W S  OK | Context
✔ |   2     1 | shinytest2 [2.6s]
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Warning (test-shinytest2.R:7:3): {shinytest2} recording: simple-app
Adding new file snapshot: 'tests/testhat/_snaps/simple-app-001_.png'

Warning (test-shinytest2.R:7:3): {shinytest2} recording: simple-app
Adding new file snapshot: 'tests/testhat/_snaps/simple-app-001.json'
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

══ Results ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Duration: 2.6 s

[ FAIL 0 | WARN 2 | SKIP 0 | PASS 1 ]</code></pre>
<p>Behind the scenes, it runs <code><a href="../reference/test_app.html">test_app()</a></code>. You can manually
run the tests with this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/test_app.html">test_app</a></span><span class="op">(</span><span class="st">"simple-app"</span>, filter <span class="op">=</span> <span class="st">"shinytest2"</span><span class="op">)</span></span></code></pre></div>
<p>This will play back the interactions and record snapshots, as
specified in the test script. The very first time the tests are run,
they will be saved in a subdirectory of the app called
<code>tests/testthat/_snaps</code>. These are the expected results, and
future test runs will be compared against them.</p>
<p>The directory will contain two types of files for different
expectations. For example:</p>
<pre><code>001.json
001_.png
002.png</code></pre>
<ul>
<li>The <code>.json</code> file is a JSON representation of the state of
the application when <code>app$expect_values()</code> was called.</li>
<li>The <code>.png</code> file is a screenshot of the application from
<code>app$expect_screenshot()</code>, which you can use to insure that
the visual state of the application does not change.</li>
<li>The <code>_.png</code> file is a <em>debug</em> screenshot of the
application when <code>app$expect_values()</code> was called. This file
should be tracked using <code>git</code> to know how the application
visually changes over time. However, if there is a difference found in a
new screenshot, the difference will not throw an error.</li>
</ul>
<p>The JSON file stores the state of all the input, output, and export
values at the time of the snapshot:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="dt">"input"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="dt">"greet"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Barret"</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="dt">"output"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="dt">"greeting"</span><span class="fu">:</span> <span class="st">"Hello Barret!"</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="dt">"export"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>If you are using a source control system (like git), you should check
in the expected results. (And ignore <code>_.new.png</code> files.)</p>
</div>
<div class="section level3">
<h3 id="subsequent-test-runs">Subsequent test runs<a class="anchor" aria-label="anchor" href="#subsequent-test-runs"></a>
</h3>
<p>After the initial test run, you can run the tests again in the future
to check for changes in your application’s behavior. If there are no
changes to the snapshots, you will just see something like this, with no
additional output:</p>
<pre><code>&gt; test_app("path/to/app")
✔ | F W S  OK | Context
✔ |         1 | shinytest2 [2.2s]

══ Results ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Duration: 2.2 s

[ FAIL 0 | WARN 0 | SKIP 0 | PASS 1 ]</code></pre>
<p>If the results are exactly the same, then the test is considered
successful.</p>
<p>If there are any differences between the latest run and the expected
results, you’ll see output like this:</p>
<pre><code>✔ | F W S  OK | Context
✖ | 1       0 | shinytest2 [2.1s]
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Failure (test-shinytest2.R:7:3): {shinytest2} recording: simple-app
Snapshot of `file` to 'shinytest2/simple-app-001.json' has changed
Run `testthat::snapshot_review('shinytest2/')` to review changes
Backtrace:
1. app$expect_values()
      at test-shinytest2.R:7:2
2. shinytest2::app_expect_values(...)
      at shinytest2.nosync/R/app-driver.R:651:6
3. shinytest2::app__expect_snapshot_file(...)
      at shinytest2.nosync/R/app-driver-expect-values.R:211:2
4. testthat::expect_snapshot_file(...)
      at shinytest2.nosync/R/expect-snapshot.R:35:2
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

══ Results ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Duration: 2.2 s

[ FAIL 1 | WARN 0 | SKIP 0 | PASS 0 ]</code></pre>
<p>To view the differences, follow the prompted code
<code>testthat::snapshot_review('shinytest2/')</code> from within your
application directory. (You may need to run
<code>install.packages("diffviewer")</code> for
<code><a href="https://testthat.r-lib.org/reference/snapshot_accept.html" class="external-link">testthat::snapshot_review()</a></code> to successfully execute.)</p>
<p>It will look something like this:</p>
<p><img src="images%2Fdiffviewer-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>After inspecting the changes, you can choose to update the expected
results (that is, replace the old expected results with the new current
results), or to just quit without updating.</p>
<p>You should update the results if the changes are expected. You should
skip/quit without updating if the changes are unexpected.</p>
</div>
<div class="section level3">
<h3 id="multiple-test-scripts">Multiple test scripts<a class="anchor" aria-label="anchor" href="#multiple-test-scripts"></a>
</h3>
<p>In the example above, we had a single test script, named
<code>test-shinytest2.R</code>.</p>
<p>If you want to have more than one set of tests for an application,
you can record new tests, each with a unique name. You can enter the
name when recording your tests:</p>
<p><img src="images%2Frecord-name.png" width="100%" style="display: block; margin: auto;"></p>
<p>The saved test can be moved to a different testing file,
e.g. <code>tests/testthat/test-simple-app.R</code>. When you run
<code>test_app("path/to/app")</code>, it will run all the tests scripts
in the application’s <code>tests/testhat</code> directory.</p>
</div>
</div>
<div class="section level2">
<h2 id="interactive-r-markdown-documents">Interactive R Markdown documents<a class="anchor" aria-label="anchor" href="#interactive-r-markdown-documents"></a>
</h2>
<p><a href="https://rstudio.github.io/shinytest2/">shinytest2</a> can be used with <a href="https://bookdown.org/yihui/rmarkdown/shiny-documents.html" class="external-link">interactive
R Markdown documents</a> that use <code>runtime: shiny</code> or
<code>server: shiny</code> (sometimes also referred to as Shiny
documents). This includes those that use the <a href="https://pkgs.rstudio.com/flexdashboard/" class="external-link">flexdashboard</a>
package.</p>
<p>Shiny documents have some differences compared to regular Shiny
applications, and so the tests are slightly different. For an example of
an interactive Rmd with tests, please follow <a href="https://github.com/rstudio/shinytest2/tree/main/tests/testthat/apps/rmd-shiny" class="external-link">this
link</a>.</p>
<div class="section level3">
<h3 id="randomness">Randomness<a class="anchor" aria-label="anchor" href="#randomness"></a>
</h3>
<p>In a Shiny Rmd application, the UI of the application is created
dynamically, using some randomly generated IDs. To make the results
repeatable, you must set a random <code>seed</code>; otherwise the
output will have slight differences in each run. See the section on <a href="in-depth.html#controlling-random-values">controlling random
values</a> for more information.</p>
</div>
<div class="section level3">
<h3 id="one--rmd-file-per-directory">One .Rmd file per directory<a class="anchor" aria-label="anchor" href="#one--rmd-file-per-directory"></a>
</h3>
<p>For testing Shiny documents, only one <code>.Rmd</code> file is
allowed per directory. This is because of the way that the test
directory is structured. (Note that if you name your Shiny document
index.Rmd, then when deployed on Shiny Server, the URL can use the
directory name, like <code>"http://mydomain.com/dirname/"</code>,
instead of <code>"http://mydomain.com/dirname/index.Rmd"</code>. When
deployed on RStudio Connect or Shinyapps.io, the filename is
automatically not used in the URL.)</p>
</div>
<div class="section level3">
<h3 id="prerendered-shiny-documents">Prerendered Shiny documents<a class="anchor" aria-label="anchor" href="#prerendered-shiny-documents"></a>
</h3>
<p>Some Shiny documents use <a href="https://rmarkdown.rstudio.com/authoring_shiny_prerendered.html" class="external-link"><code>runtime: shiny_prerendered</code></a>,
which helps speed up page loading time. Normally, the first time these
applications are run, they will leave behind a generated .html file as
well as a cache directory named myfile_data/.</p>
<p>You can remove these files by adding this to the end of your test
script (assuming the name of your document is <code>doc.Rmd</code>):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/shiny_prerendered_clean.html" class="external-link">shiny_prerendered_clean</a></span><span class="op">(</span><span class="st">"../doc.Rmd"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can save the generated files, but then the tests
will be run with the generated files, so the prerendering step will not
be run for future tests.</p>
<p>For an example of a prerendered .Rmd and tests, please follow <a href="https://github.com/rstudio/shinytest2/tree/61d51d9e96640bfae3eeefa12c4b685099b584c8/tests/testthat/apps/rmd-pre" class="external-link">this
link</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="next">Next<a class="anchor" aria-label="anchor" href="#next"></a>
</h2>
<p>Learn more about shinytest with the <a href="./in-depth.html">testing
in depth</a> article.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="http://schloerke.com" class="external-link">Barret Schloerke</a>, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
