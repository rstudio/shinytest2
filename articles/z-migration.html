<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Migrating from shinytest • shinytest2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Migrating from shinytest">
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinytest2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/shinytest2.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/in-depth.html">Testing in depth</a></li>
    <li><a class="dropdown-item" href="../articles/robust.html">Robust testing</a></li>
    <li><a class="dropdown-item" href="../articles/use-application-audit.html">Auditing Shiny apps</a></li>
    <li><a class="dropdown-item" href="../articles/use-ci.html">Using shinytest2 with continuous integration</a></li>
    <li><a class="dropdown-item" href="../articles/use-package.html">Using shinytest2 with R packages</a></li>
    <li><a class="dropdown-item" href="../articles/using-monkey-testing.html">Monkey testing</a></li>
    <li><a class="dropdown-item" href="../articles/z-migration.html">Migrating from shinytest</a></li>
    <li><a class="dropdown-item" href="../articles/zzz-faq.html">Frequently Asked Questions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/shinytest2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Migrating from shinytest</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/shinytest2/blob/main/vignettes/z-migration.Rmd" class="external-link"><code>vignettes/z-migration.Rmd</code></a></small>
      <div class="d-none name"><code>z-migration.Rmd</code></div>
    </div>

    
    
<p><a href="https://rstudio.github.io/shinytest2/">shinytest2</a> is the successor to
<a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a>. <a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a> was implemented using
<a href="https://rstudio.github.io/webdriver/" class="external-link"><code>{webdriver}</code></a>
which uses <a href="https://phantomjs.org/api/" class="external-link">PhantomJS</a>. PhantomJS
has been unsupported since 2017 and does not support displaying
<a href="https://rstudio.github.io/bslib/" class="external-link">bslib</a>’s Bootstrap v5. <a href="https://rstudio.github.io/shinytest2/">shinytest2</a> uses
<a href="https://rstudio.github.io/chromote/" class="external-link">chromote</a> to connect to your locally installed Chrome or
Chromium application, allowing <a href="https://rstudio.github.io/shinytest2/">shinytest2</a> to display
<a href="https://rstudio.github.io/bslib/" class="external-link">bslib</a>’s Bootstrap v5.</p>
<p>To auto-migrate your existing <a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a> tests to
<a href="https://rstudio.github.io/shinytest2/">shinytest2</a>, call
<code>shinytest2::migrate_from_shinytest(PATH_TO_APP)</code>.</p>
<div class="section level2">
<h2 id="code-structure">Code structure<a class="anchor" aria-label="anchor" href="#code-structure"></a>
</h2>
<p>In the sub sections below, <code>ShinyDriver</code> is a reference to
the <code><a href="https://rdrr.io/pkg/shinytest/man/ShinyDriver.html" class="external-link">shinytest::ShinyDriver</a></code> R6 object. In each code block,
the <code>ShinyDriver</code> object will be referred to as
<code>old</code>. Similarly, <code>AppDriver</code> is a reference to
<code><a href="../reference/AppDriver.html">shinytest2::AppDriver</a></code> R6 object.
<code><a href="../reference/AppDriver.html">shinytest2::AppDriver</a></code> has replaced
<a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a>’s <code>ShinyDriver</code> object and will be
referred to as <code>new</code> in each code block.</p>
<div class="section level3">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h3>
<div class="section level4">
<h4 id="shinydriverclick">
<code>ShinyDriver$click()</code><a class="anchor" aria-label="anchor" href="#shinydriverclick"></a>
</h4>
<p>Signature:
<code>ShinyDriver$click(name, iotype = c("auto", "input", "output"))</code></p>
<p>The parameters have been separated to be clearer in their intended
use to <code>AppDriver$click(input, output, ..., selector)</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span><span class="st">"mybutton"</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span><span class="st">"clickcount"</span>, iotype <span class="op">=</span> <span class="st">"output"</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span><span class="st">"my_id"</span>, iotype <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span><span class="st">"mybutton"</span><span class="op">)</span>; <span class="va">new</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span>input <span class="op">=</span> <span class="st">"mybutton"</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span>output <span class="op">=</span> <span class="st">"clickcount"</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span>selector <span class="op">=</span> <span class="st">"#my_id"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriverexecutescript">
<code>ShinyDriver$executeScript()</code><a class="anchor" aria-label="anchor" href="#shinydriverexecutescript"></a>
</h4>
<p>Signature: <code>ShinyDriver$executeScript(script, ...)</code></p>
<p>The <code>...</code> must now be inserted into the script. You can do
this with commands like <code><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue::glue()</a></code> or
<code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste()</a></code>. Extra parameters include <code>file</code>, which
can contain your <code>script</code> content, and <code>timeout</code>,
which will throw an error if the <code>timeout</code> (in milliseconds)
is reached before the script returns. If a promise is the last value in
the <code>script</code> then the <code>resolve</code>d value will be
sent back to the R session.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">life</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">executeScript</span><span class="op">(</span><span class="st">"1 + 1;"</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">executeScript</span><span class="op">(</span><span class="st">"var life = arguments[0]; life;"</span>, <span class="va">life</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">life</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_js</span><span class="op">(</span><span class="st">"1 + 1;"</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_js</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"let life = "</span>, <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">life</span>, auto_unbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"; life;"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># If a promise is returned, the resolved value will be sent back to the R session</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_js</span><span class="op">(</span></span>
<span>  <span class="fu">paset0</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  let life = "</span>, <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">life</span>, auto_unbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">";</span></span>
<span><span class="st">  new Promise((resolve, reject) =&gt; resolve(life));</span></span>
<span><span class="st">  "</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriverexecutescriptasync">
<code>ShinyDriver$executeScriptAsync()</code><a class="anchor" aria-label="anchor" href="#shinydriverexecutescriptasync"></a>
</h4>
<p>Signature:
<code>ShinyDriver$executeScriptAsync(script, ...)</code></p>
<p><code>ShinyDriver$executeScriptAsync()</code> magically made a
<code>callback</code> argument available in the JavaScript code and
would block the R session until <code>callback</code> was called within
<code>script</code>. In <code>shinytest2</code> your script will need to
be updated to use a JavaScript <code>Promise.</code> The
<code>Promise</code>’s <code>resolve</code> method should be the
callback that you used previously. You should also provide a maximum
<code>timeout</code> (in milliseconds) that you are willing to wait
before an error is thrown. For example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="co"># Wait until a button is clicked</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">executeScriptAsync</span><span class="op">(</span></span>
<span>  <span class="st">'</span></span>
<span><span class="st">  var selector = arguments[0];</span></span>
<span><span class="st">  var callback = arguments[1];</span></span>
<span><span class="st">  $( selector ).one( "click", function() {</span></span>
<span><span class="st">    callback();</span></span>
<span><span class="st">  });</span></span>
<span><span class="st">  '</span>,</span>
<span>  <span class="st">"#mybutton"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="co"># Wait until a button is clicked</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_js</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  let selector = "</span>, <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="st">"#mybutton"</span>, auto_unbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">";</span></span>
<span><span class="st">  new Promise((resolve, reject) =&gt; {</span></span>
<span><span class="st">    $( selector ).one( \"click\", function() {</span></span>
<span><span class="st">      resolve();</span></span>
<span><span class="st">    });</span></span>
<span><span class="st">  });</span></span>
<span><span class="st">  "</span><span class="op">)</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">15</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydrivergetallvalues">
<code>ShinyDriver$getAllValues()</code><a class="anchor" aria-label="anchor" href="#shinydrivergetallvalues"></a>
</h4>
<p>Signature:
<code>ShinyDriver$getAllValues(input = TRUE, output = TRUE, export = TRUE)</code></p>
<p>This method has been renamed to
<code>AppDriver$get_values(..., input, output, export, hash_images = TRUE)</code>.
The new method has a slightly different behavior if only some of the
<code>input</code>, <code>output</code> or <code>export</code> arguments
are provided. If <code>input</code>, <code>output</code> or
<code>export</code> are provided, then the method will return the values
for the provided <code>input</code>, <code>output</code> or
<code>export</code> names only. If no <code>input</code>,
<code>output</code> or <code>export</code> are provided, then the method
will return all values, similar to setting
<code>ShinyDriver$getAllValues(input = TRUE, output = TRUE, export = TRUE)</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getAllValues</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># All input values</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getAllValues</span><span class="op">(</span>input <span class="op">=</span> <span class="cn">TRUE</span>, output <span class="op">=</span> <span class="cn">FALSE</span>, export <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Only `clickcount` output value</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getAllValues</span><span class="op">(</span>input <span class="op">=</span> <span class="cn">FALSE</span>, output <span class="op">=</span> <span class="st">"clickcount"</span>, export <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># All input values</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span>input <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Only `clickcount` output value</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span>output <span class="op">=</span> <span class="st">"clickcount"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydrivergetvalue">
<code>ShinyDriver$getValue()</code><a class="anchor" aria-label="anchor" href="#shinydrivergetvalue"></a>
</h4>
<p>Signature:
<code>ShinyDriver$getValue(name, iotype = c("auto", "input", "output"))</code></p>
<p>This method has been renamed to
<code>AppDriver$get_value(..., input, output, export)</code> and its
parameters have been spread out into <code>input</code> and
<code>output</code>, while adding support for <code>export</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getValue</span><span class="op">(</span><span class="st">"myinput"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span>input <span class="op">=</span> <span class="st">"myinput"</span><span class="op">)</span></span>
<span><span class="co"># Equivalent to</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span>input <span class="op">=</span> <span class="st">"myinput"</span><span class="op">)</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">myinput</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydrivergeturl">
<code>ShinyDriver$getUrl()</code><a class="anchor" aria-label="anchor" href="#shinydrivergeturl"></a>
</h4>
<p>Signature: <code>ShinyDriver$getUrl()</code></p>
<p>This method has been renamed to <code>AppDriver$get_url()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getUrl</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_url</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriversetinputs">
<code>ShinyDriver$setInputs()</code><a class="anchor" aria-label="anchor" href="#shinydriversetinputs"></a>
</h4>
<p>Signature:
<code>ShinyDriver$setInputs(..., wait_ = TRUE, values_ = TRUE, timeout_ = 3 * 1000, allowInputNoBinding_ = FALSE, priority_ = c("input", "event"))</code></p>
<p>The method name has been renamed to
<code>AppDriver$get_values()</code> and the parameters have been
converted to <code>snake_case</code>. <code>value_</code> support has
been removed, but the same functionality can be achieved via a call to
<code>AppDriver$get_values()</code> <em>after</em> a call to
<code>AppDriver$set_inputs()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">getValuesResult</span> <span class="op">&lt;-</span> <span class="va">old</span><span class="op">$</span><span class="fu">setInputs</span><span class="op">(</span>life <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">set_inputs</span><span class="op">(</span>life <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">get_values_result</span> <span class="op">&lt;-</span> <span class="va">new</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydrivergetwindowsize-shinydriversetwindowsize">
<code>ShinyDriver$getWindowSize()</code>,
<code>ShinyDriver$setWindowSize()</code><a class="anchor" aria-label="anchor" href="#shinydrivergetwindowsize-shinydriversetwindowsize"></a>
</h4>
<p>Signatures: * <code>ShinyDriver$getWindowSize()</code> *
<code>ShinyDriver$setWindowSize(width, height)</code></p>
<p>These methods have been renamed to
<code>AppDriver$get_window_size()</code> and
<code>AppDriver$set_window_size(width, height)</code> respectively.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getWindowSize</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">setWindowSize</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1024</span>, height <span class="op">=</span> <span class="fl">768</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_window_size</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">set_window_size</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1024</span>, height <span class="op">=</span> <span class="fl">768</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydrivercheckuniquewidgetnames">
<code>ShinyDriver$checkUniqueWidgetNames()</code><a class="anchor" aria-label="anchor" href="#shinydrivercheckuniquewidgetnames"></a>
</h4>
<p>Signature: <code>ShinyDriver$checkUniqueWidgetNames()</code></p>
<p>This method checks to make sure all input and output names are
unique. It is still run at initialization via
<code>AppDriver$new(check_names = TRUE)</code>, and if any issues are
found during startup, only warnings will be displayed. The exported
method has been upgraded to an expectation version and renamed to
<code>AppDriver$expect_unique_names()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">checkUniqueWidgetNames</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">expect_unique_names</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="snapshots">Snapshots<a class="anchor" aria-label="anchor" href="#snapshots"></a>
</h3>
<p>Snapshots are now handled by <a href="https://testthat.r-lib.org" class="external-link">testthat</a>. To leverage
this capability, use the <code>AppDriver$expect_*()</code> methods to
assert that the value is consistent over many testing executions.</p>
<div class="section level4">
<h4 id="shinydriversnapshotinit">
<code>ShinyDriver$snapshotInit()</code><a class="anchor" aria-label="anchor" href="#shinydriversnapshotinit"></a>
</h4>
<p>Signature:
<code>ShinyDriver$snapshotInit(path, screenshot = TRUE)</code></p>
<p>This method has been moved to the parameters:
<code>AppDriver$new(name = path)</code>. Screenshots via
<a href="https://testthat.r-lib.org" class="external-link">testthat</a> snapshots are not allowed until an
<code>AppDriver$new(variant=)</code> value is provided.
<code>variant</code> is similar to the <code>suffix</code> value in
<code>shinytest::testApp(suffix=)</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">snapshotInit</span><span class="op">(</span><span class="st">"mytest"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppDriver.html">AppDriver</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"mytest"</span>, variant <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co"># Suggested</span></span>
<span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppDriver.html">AppDriver</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"mytest"</span>, variant <span class="op">=</span> <span class="fu"><a href="../reference/platform_variant.html">platform_variant</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriversnapshot">
<code>ShinyDriver$snapshot()</code><a class="anchor" aria-label="anchor" href="#shinydriversnapshot"></a>
</h4>
<p>Signature:
<code>ShinyDriver$snapshot(items = NULL, filename = NULL, screenshot = NULL)</code></p>
<p>In <a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a> this method would expect a screenshot and
expect all values to be consistent. This method no longer exists in
<a href="https://rstudio.github.io/shinytest2/">shinytest2</a>, and has been broken up into two methods that
must be called independently: <code>AppDriver$expect_screenshot()</code>
and <code>AppDriver$expect_values()</code>.
<code>AppDriver$expect_values()</code> will (by default) take a
<em>debug</em> screenshot that will never fail in an expectation. This
allows for a historical record (version control) of what the app looked
like while not having to constantly battle with false-positive
screenshot failures. If a single <code>output</code> value is supplied
to <code>AppDriver$expect_values()</code>, then the <em>debug</em>
screenshot is zoomed in on the output value.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">snapshot</span><span class="op">(</span>items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"clickcount"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="co"># Must supply `variant=` to be able to call `AppDriver$expect_screenshot()`, even if it is `NULL`</span></span>
<span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppDriver.html">AppDriver</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">path_to_app</span>, variant <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">expect_screenshot</span><span class="op">(</span><span class="op">)</span>; <span class="va">new</span><span class="op">$</span><span class="fu">expect_values</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">expect_screenshot</span><span class="op">(</span><span class="op">)</span>; <span class="va">new</span><span class="op">$</span><span class="fu">expect_values</span><span class="op">(</span>output <span class="op">=</span> <span class="st">"clickcount"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Suggested;</span></span>
<span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppDriver.html">AppDriver</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">path_to_app</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">expect_values</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydrivertakescreenshot">
<code>ShinyDriver$takeScreenshot()</code><a class="anchor" aria-label="anchor" href="#shinydrivertakescreenshot"></a>
</h4>
<p>Signature:
<code>ShinyDriver$takeScreenshot(file = NULL, id = NULL, parent = FALSE)</code></p>
<p>This method has been renamed to
<code>AppDriver$get_screenshot(file)</code>, and the <code>id</code> and
<code>parent</code> parameters have been removed. To use a selector, set
<code>AppDriver$get_screenshot(myfile, selector = ".custom-selector")</code>
or <code>screenshot_args</code> directly.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">takeScreenshot</span><span class="op">(</span><span class="st">"myfile1.png"</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">takeScreenshot</span><span class="op">(</span><span class="st">"myfile2.png"</span>, id <span class="op">=</span> <span class="st">"myid"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_screenshot</span><span class="op">(</span><span class="st">"myfile1.png"</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_screenshot</span><span class="op">(</span><span class="st">"myfile2.png"</span>, selector <span class="op">=</span> <span class="st">"#myid"</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_screenshot</span><span class="op">(</span><span class="st">"myfile2.png"</span>, screenshot_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>selector <span class="op">=</span> <span class="st">"#myid"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriversnapshotdownload">
<code>ShinyDriver$snapshotDownload()</code><a class="anchor" aria-label="anchor" href="#shinydriversnapshotdownload"></a>
</h4>
<p>Signature:
<code>ShinyDriver$snapshotDownload(id, filename)</code></p>
<p>This method has been renamed to
<code>AppDriver$expect_download(id, filename)</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">snapshotDownload</span><span class="op">(</span><span class="st">"mylinkid"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">expect_download</span><span class="op">(</span><span class="st">"mylinkid"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriverstop">
<code>ShinyDriver$stop()</code><a class="anchor" aria-label="anchor" href="#shinydriverstop"></a>
</h4>
<p>Signature: <code>ShinyDriver$stop()</code></p>
<p>This method stayed the same! 🥳 In <a href="https://rstudio.github.io/shinytest2/">shinytest2</a>, this
will also stop your [<code>ChromeSession</code>] instance and clean up
any temporary Shiny log files.</p>
</div>
<div class="section level4">
<h4 id="shinydriveruploadfile">
<code>ShinyDriver$uploadFile()</code><a class="anchor" aria-label="anchor" href="#shinydriveruploadfile"></a>
</h4>
<p>Signature:
<code>ShinyDriver$uploadFile(..., wait_ = TRUE, values_ = TRUE, timeout_ = 3 * 1000)</code></p>
<p>This method has been renamed to
<code>AppDriver$upload_file(...)</code>, and similar to
<code>AppDriver$set_inputs()</code>, support for
<code>ShinyDriver$uploadFile(values_ =)</code> has been removed.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">uploadFile</span><span class="op">(</span>myFileInput <span class="op">=</span> <span class="st">"myfile.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">upload_file</span><span class="op">(</span>myFileInput <span class="op">=</span> <span class="st">"myfile.txt"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriverwaitfor">
<code>ShinyDriver$waitFor()</code><a class="anchor" aria-label="anchor" href="#shinydriverwaitfor"></a>
</h4>
<p>Signature:
<code>ShinyDriver$waitFor(expr, checkInterval = 100, timeout = 3000)</code></p>
<p>This method has been renamed and had its parameters reordered to
<code>AppDriver$wait_for_js(script, timeout, interval)</code>. Like
other JavaScript methods in <a href="https://rstudio.github.io/shinytest2/">shinytest2</a>,
<code>script</code> needs to explicitly return a value.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">waitFor</span><span class="op">(</span><span class="st">"$('#myid').length &gt; 0"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">wait_for_js</span><span class="op">(</span><span class="st">"$('#myid').length &gt; 0"</span><span class="op">)</span>;</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriverwaitforshiny">
<code>ShinyDriver$waitForShiny()</code><a class="anchor" aria-label="anchor" href="#shinydriverwaitforshiny"></a>
</h4>
<p>Signature: <code>ShinyDriver$waitForShiny()</code></p>
<p>This method has been upgraded to
<code>AppDriver$wait_for_idle(duration = 500, timeout = 30 * 1000)</code>.
The <code>ShinyDriver$waitForShiny()</code> method only waited until a
single instance in time stated that Shiny was no longer busy. The new
method will wait until Shiny has been “idle” for a continuous stretch of
time. It is useful to wait until Shiny has been idle for a set duration
in order to avoid situations where dynamic UI needs to calculate new
outputs given new input information.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">waitForShiny</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="co"># Equivalent</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">wait_for_idle</span><span class="op">(</span>duration <span class="op">=</span> <span class="fl">0</span>, timeout <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co"># Suggested (Shiny must become continuously idle for at least 500ms within 30s</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">wait_for_idle</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydriverwaitforvalue">
<code>ShinyDriver$waitForValue()</code><a class="anchor" aria-label="anchor" href="#shinydriverwaitforvalue"></a>
</h4>
<p>Signature:
<code>ShinyDriver$waitForValue(name, ignore = list(NULL, ""), iotype = c("input", "output", "export"), timeout = 10000, checkInterval = 400)</code>:
This (underutilized) method has had the
<code>name</code>/<code>iotype</code> spread out into separate
<code>input</code>, <code>output</code>, <code>export</code> parameters.
Only one <code>input</code>/<code>output</code>/<code>export</code>
value may be supplied in an <code>AppDriver</code> object. The
<code>timeout</code> has been increased to 15 seconds. Both methods
still poll the Shiny application at a set <code>interval</code> for the
corresponding value to be something <em>not</em> in the
<code>ignore</code>d set of values.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">waitForValue</span><span class="op">(</span><span class="st">"myslider"</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">waitForValue</span><span class="op">(</span><span class="st">"mydynamicplot"</span>, iotype <span class="op">=</span> <span class="st">"output"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">wait_for_value</span><span class="op">(</span><span class="st">"myslider"</span><span class="op">)</span>; <span class="va">new</span><span class="op">$</span><span class="fu">wait_for_value</span><span class="op">(</span>input <span class="op">=</span> <span class="st">"myslider"</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">wait_for_value</span><span class="op">(</span>output <span class="op">=</span> <span class="st">"mydynamicplot"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="elements-widgets">Elements / Widgets<a class="anchor" aria-label="anchor" href="#elements-widgets"></a>
</h3>
<p>Direct element or Widget support for <a href="https://rstudio.github.io/shinytest2/">shinytest2</a> has
been drastically reduced. With the ability to execute any JavaScript
function via <code>$get_js(script)</code> and
<code>$run_js(script)</code>, it is now possible to reproduce many of
the methods that were provided in <a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a>.</p>
<div class="section level4">
<h4 id="shinydriverfindelement-shinydriverfindelements-shinydriverfindwidget">
<code>ShinyDriver$findElement()</code>,
<code>ShinyDriver$findElements()</code>,
<code>ShinyDriver$findWidget()</code><a class="anchor" aria-label="anchor" href="#shinydriverfindelement-shinydriverfindelements-shinydriverfindwidget"></a>
</h4>
<p>Signatures: *
<code>ShinyDriver$findElement(css = NULL, linkText = NULL, partialLinkText = NULL, xpath = NULL)</code>
*
<code>ShinyDriver$findElements(css = NULL, linkText = NULL, partialLinkText = NULL, xpath = NULL)</code>
*
<code>ShinyDriver$findWidget(name, iotype = c("auto", "input", "output"))</code></p>
<p>These methods have been removed. It is suggested to use JavaScript
code directly or use newer helper methods.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">findElement</span><span class="op">(</span><span class="st">"#mybutton"</span><span class="op">)</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">findElement</span><span class="op">(</span><span class="st">"#mybutton"</span><span class="op">)</span><span class="op">$</span><span class="fu">getText</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">findElement</span><span class="op">(</span><span class="st">"#mybutton"</span><span class="op">)</span><span class="op">$</span><span class="fu">getCssValue</span><span class="op">(</span><span class="st">"color"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_text</span><span class="op">(</span>selector <span class="op">=</span> <span class="st">"#mybutton"</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">click</span><span class="op">(</span>selector <span class="op">=</span> <span class="st">"#mybutton"</span><span class="op">)</span></span>
<span><span class="co"># No direct equivalent method. Using JavaScript instead</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_js</span><span class="op">(</span><span class="st">'$("#mybutton").css("color")'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shinydrivergetsource-shinydrivergettitle">
<code>ShinyDriver$getSource()</code>,
<code>ShinyDriver$getTitle()</code><a class="anchor" aria-label="anchor" href="#shinydrivergetsource-shinydrivergettitle"></a>
</h4>
<p>Signatures: * <code>ShinyDriver$getSource()</code> *
<code>ShinyDriver$getTitle()</code></p>
<p>These methods have been removed. It is suggested to use JavaScript
code directly, or to use newer helper methods.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getSource</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getTitle</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_html</span><span class="op">(</span><span class="st">"html"</span>, outer_html <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_js</span><span class="op">(</span><span class="st">"window.document.title;"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="testing-setup">Testing setup<a class="anchor" aria-label="anchor" href="#testing-setup"></a>
</h3>
<p><a href="https://rstudio.github.io/shinytest2/">shinytest2</a> is heavily integrated with the
<a href="https://testthat.r-lib.org" class="external-link">testthat</a> testing framework. Similar to
<a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a>, snapshots are recorded, but they are recorded
via <a href="https://testthat.r-lib.org" class="external-link">testthat</a> snapshots. For more information on the
robustness of different testing approaches, please see the <a href="./robust.html">Robust testing</a> vignette.</p>
<ul>
<li>
<code>ShinyDriver$new(suffix=)</code>: Please use
<code>AppDriver$new(variant=)</code>.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span> <span class="op">&lt;-</span> <span class="va">ShinyDriver</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">path_to_app</span>, suffix <span class="op">=</span> <span class="st">"macos-4.1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppDriver.html">AppDriver</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">path_to_app</span>, variant <span class="op">=</span> <span class="st">"macos-4.1"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="shinydrivergetrelativepathtoapp-shinydrivergettestsdir">
<code>ShinyDriver$getRelativePathToApp()</code>,
<code>ShinyDriver$getTestsDir()</code><a class="anchor" aria-label="anchor" href="#shinydrivergetrelativepathtoapp-shinydrivergettestsdir"></a>
</h4>
<p>Signatures: * <code>ShinyDriver$getRelativePathToApp()</code> *
<code>ShinyDriver$getTestsDir()</code></p>
<p>These methods have been removed as they are no longer needed given
execution <a href="https://rstudio.github.io/shinytest2/">shinytest2</a> testing is always done within the
<a href="https://testthat.r-lib.org" class="external-link">testthat</a> testing framework.</p>
</div>
<div class="section level4">
<h4 id="shinydrivergetsnapshotdir">
<code>ShinyDriver$getSnapshotDir()</code><a class="anchor" aria-label="anchor" href="#shinydrivergetsnapshotdir"></a>
</h4>
<p>Signature: <code>ShinyDriver$getSnapshotDir()</code></p>
<p>This method has been removed as <a href="https://testthat.r-lib.org" class="external-link">testthat</a> uses the
<code>./_snaps</code> directory to store snapshot outputs.</p>
</div>
<div class="section level4">
<h4 id="shinydriverexpectupdate">
<code>ShinyDriver$expectUpdate()</code><a class="anchor" aria-label="anchor" href="#shinydriverexpectupdate"></a>
</h4>
<p>Signature:
<code>ShinyDriver$expectUpdate(output, ..., timeout = 3000, iotype = c("auto", "input", "output"))</code></p>
<p>This method is no longer supported. While knowing that an output
value has been updated, it is very uncertain as to what the new value
is. While possibly useful, it is not robust and therefore not
recommended. Other testing methods should be explored.</p>
<p>Equivalent code has been provided below for legacy support.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">expectUpdate</span><span class="op">(</span><span class="st">"myoutput"</span>, myinput <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2} (equivalent code)</span></span>
<span><span class="va">myoutput_prior</span> <span class="op">&lt;-</span> <span class="va">new</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span>output <span class="op">=</span> <span class="st">"myoutput"</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">set_inputs</span><span class="op">(</span>myinput <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/expect_success.html" class="external-link">expect_failure</a></span><span class="op">(</span></span>
<span>  <span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span></span>
<span>    <span class="va">new</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span>output <span class="op">=</span> <span class="st">"myoutput"</span><span class="op">)</span>,</span>
<span>    <span class="va">myoutput_prior</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="debugging">Debugging<a class="anchor" aria-label="anchor" href="#debugging"></a>
</h3>
<p>Debugging in <a href="https://rstudio.github.io/shinytest2/">shinytest2</a> has been unified and is
enabled at all times. The <a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a> debugging methods
have been removed in favor of <code>AppDriver$get_logs()</code>, which
returns a similarly shaped <code>tibble</code> as
<code>ShinyDriver$getDebugLog()</code>’s <code>data.frame</code>. The
columns have been altered to be more generic, where <code>type</code>
has been broken into two columns: <code>location</code> and
<code>level</code>.</p>
<ul>
<li>
<code>ShinyDriver$getDebugLog()</code>,
<code>ShinyDriver$getEventLog()</code>: Now use
<code>AppDriver$get_logs()</code>.</li>
<li>
<code>ShinyDriver$logEvent(event, ...)</code>: Messages can still be
recorded using <code>AppDriver$log_message(text)</code>, but
<code>...</code> values are no longer supported.</li>
<li>
<code>ShinyDriver$enableDebugLogMessages(enable = TRUE)</code>: No
longer used. <em>All</em> messages are always recorded.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getDebugLog</span><span class="op">(</span><span class="op">)</span>; <span class="va">old</span><span class="op">$</span><span class="fu">getEventLog</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">logEvent</span><span class="op">(</span><span class="st">"Creating report"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_logs</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">log_message</span><span class="op">(</span><span class="st">"Creating report"</span><span class="op">)</span></span></code></pre></div>
<p>If <code>options = list(shiny.trace = TRUE)</code> is set when
initializing an <code>AppDriver</code> object, then all WebSocket
traffic will be recorded.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest2}</span></span>
<span><span class="co"># Record all websocket traffic. Caution!! This is very verbose!!</span></span>
<span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppDriver.html">AppDriver</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">path_to_app</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shiny.trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">get_logs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-removed-methods">Other removed methods<a class="anchor" aria-label="anchor" href="#other-removed-methods"></a>
</h3>
<ul>
<li>
<code>ShinyDriver$setValue(name, value, iotype)</code>: To set an
output value, it must be performed by setting an input value and having
your render methods set the output value. To set an input value, use
<code>AppDriver$set_inputs()</code>.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">setValue</span><span class="op">(</span><span class="st">"myinput"</span>, <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">set_inputs</span><span class="op">(</span>myinput <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>ShinyDriver$listWidgets()</code>: This method has been removed
and can be achieved by getting the names of the existing values:
<code>AppDriver$get_values()</code>.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">listWidgets</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">new</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span><span class="op">)</span>, <span class="va">names</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p><code>ShinyDriver$clone()</code>: <code>AppDriver</code> does not
support cloning. (The underlying <code>ChromoteSession</code> does not
support cloning, so <code>AppDriver</code> cannot support
cloning.)</p></li>
<li><p><code>ShinyDriver$goBack()</code>,
<code>ShinyDriver$refresh()</code>: These methods have been removed, but
can be achieved with <code>AppDriver$run_js(script)</code>.</p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">goBack</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">refresh</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="co"># Go back</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">run_js</span><span class="op">(</span><span class="st">"window.history.back();"</span><span class="op">)</span></span>
<span><span class="co"># Refresh page</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">run_js</span><span class="op">(</span><span class="st">"window.location.reload();"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>ShinyDriver$getAppDir()</code>,
<code>ShinyDriver$getAppFilename()</code>,
<code>ShinyDriver$isRmd()</code>: <code>AppDriver$get_dir()</code> is
the only method still supported given
<code>AppDriver$new(app_dir=)</code> is a single directory path. The
other methods have been removed as their functionality does not make
sense within <a href="https://rstudio.github.io/shinytest2/">shinytest2</a>.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">isRmd</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getAppDir</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">getAppFilename</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">app_dir</span> <span class="op">&lt;-</span> <span class="va">new</span><span class="op">$</span><span class="fu">get_dir</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rmd_files</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="va">new</span><span class="op">$</span><span class="fu">get_dir</span><span class="op">(</span><span class="op">)</span>, regexp <span class="op">=</span> <span class="st">"\\.[Rr]md$"</span><span class="op">)</span></span>
<span><span class="va">is_rmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rmd_files</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span></span>
<span><span class="va">app_filename</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">has_rmd</span><span class="op">)</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path_file.html" class="external-link">path_file</a></span><span class="op">(</span><span class="va">rmd_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="kw">else</span> <span class="cn">NULL</span></span></code></pre></div>
<ul>
<li>
<code>ShinyDriver$sendKeys(name, keys)</code>: This method has been
removed and there is currently no easy alternative. If you are familiar
with the <a href="https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode#value_of_keycode" class="external-link">key
code values</a>, you can trigger them with <code>jQuery</code> and
<code>AppDriver$run_js(script)</code>.</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## {shinytest}</span></span>
<span><span class="va">old</span><span class="op">$</span><span class="fu">sendKeys</span><span class="op">(</span><span class="st">"myinput"</span>, <span class="fu">webdriver</span><span class="fu">::</span><span class="va">keys</span><span class="op">$</span><span class="va">enter</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {shinytest2}</span></span>
<span><span class="va">new</span><span class="op">$</span><span class="fu">run_js</span><span class="op">(</span><span class="st">"$('#myinput').trigger({type: 'keypress', which: 13, keyCode: 13});"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="http://schloerke.com" class="external-link">Barret Schloerke</a>, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
